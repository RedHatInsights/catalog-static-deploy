{"version":3,"file":"js/platform-templates.1642540868212.6d74b2a4ac1267335331.js","mappings":"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","sources":["webpack:///./src/smart-components/platform/platform-templates.js","webpack:///./src/messages/platforms.messages.ts"],"sourcesContent":["import React, { Fragment, useEffect, useReducer } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { SearchIcon } from '@patternfly/react-icons';\nimport { scrollToTop } from '../../helpers/shared/helpers';\nimport ToolbarRenderer from '../../toolbar/toolbar-renderer';\nimport { defaultSettings } from '../../helpers/shared/pagination';\nimport { fetchPlatformItems } from '../../redux/actions/platform-actions';\nimport { fetchPlatformItems as fetchPlatformItemsS } from '../../redux/actions/platform-actions-s';\nimport PlatformItem from '../../presentational-components/platform/platform-item';\nimport { createPlatformsFilterToolbarSchema } from '../../toolbar/schemas/platforms-toolbar.schema';\nimport ContentGalleryEmptyState from '../../presentational-components/shared/content-gallery-empty-state';\nimport asyncFormValidator from '../../utilities/async-form-validator';\nimport ContentGallery from '../content-gallery/content-gallery';\nimport { Button } from '@patternfly/react-core';\nimport AsyncPagination from '../common/async-pagination';\nimport BottomPaginationContainer from '../../presentational-components/shared/bottom-pagination-container';\nimport useQuery from '../../utilities/use-query';\nimport { PLATFORM_SERVICE_OFFERINGS_ROUTE } from '../../constants/routes';\nimport filteringMessages from '../../messages/filtering.messages';\nimport platformsMessages from '../../messages/platforms.messages';\nimport useFormatMessage from '../../utilities/use-format-message';\n\nconst initialState = {\n  filterValue: '',\n  isOpen: false,\n  isFetching: true,\n  isFiltering: false\n};\n\nconst platformItemsState = (state, action) => {\n  switch (action.type) {\n    case 'setFetching':\n      return { ...state, isFetching: action.payload };\n    case 'setFilterValue':\n      return { ...state, filterValue: action.payload };\n    case 'setFilteringFlag':\n      return { ...state, isFiltering: action.payload };\n    default:\n      return state;\n  }\n};\n\nconst debouncedFilter = asyncFormValidator(\n  (id, value, dispatch, filteringCallback, meta = defaultSettings) => {\n    filteringCallback(true);\n    dispatch(\n      localStorage.getItem('catalog_standalone')\n        ? fetchPlatformItemsS(id, value, meta)\n        : fetchPlatformItems(id, value, meta)\n    ).then(() => filteringCallback(false));\n  },\n  1000\n);\n\nconst PlatformTemplates = () => {\n  const formatMessage = useFormatMessage();\n  const [{ platform: id }] = useQuery(['platform']);\n  const [{ filterValue, isFetching, isFiltering }, stateDispatch] = useReducer(\n    platformItemsState,\n    initialState\n  );\n  const {\n    data,\n    results,\n    count,\n    meta\n  } = useSelector(({ platformReducer: { platformItems } }) =>\n    platformItems[id]\n      ? platformItems[id]\n      : { data: [], results: [], meta: defaultSettings, count: 0 }\n  );\n\n  const { platform, platformIconMapping } = useSelector(\n    ({ platformReducer: { selectedPlatform, platformIconMapping } }) => ({\n      platform: selectedPlatform,\n      platformIconMapping\n    })\n  );\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(\n      localStorage.getItem('catalog_standalone')\n        ? fetchPlatformItemsS(id, filterValue, defaultSettings)\n        : fetchPlatformItems(id, filterValue, defaultSettings)\n    ).then(() => stateDispatch({ type: 'setFetching', payload: false }));\n    scrollToTop();\n  }, [id]);\n\n  const dataSet = data ? data : results;\n  const metaInfo = meta ? meta : { count };\n\n  const handleFilterChange = (value) => {\n    stateDispatch({ type: 'setFilterValue', payload: value });\n    debouncedFilter(\n      id,\n      value,\n      dispatch,\n      (isFiltering) =>\n        stateDispatch({ type: 'setFilteringFlag', payload: isFiltering }),\n      {\n        ...metaInfo,\n        offset: 0\n      }\n    );\n  };\n\n  const filteredItems = {\n    items: dataSet\n      ? dataSet.map((item) => (\n          <PlatformItem\n            key={item.id}\n            pathname={PLATFORM_SERVICE_OFFERINGS_ROUTE}\n            searchParams={{\n              service: item.id\n            }}\n            preserveSearch\n            src={platformIconMapping[id]}\n            {...item}\n          />\n        ))\n      : []\n  };\n\n  const title = platform ? platform.name : '';\n  return (\n    <Fragment>\n      <ToolbarRenderer\n        schema={createPlatformsFilterToolbarSchema({\n          onFilterChange: handleFilterChange,\n          searchValue: filterValue,\n          filterPlaceholder: formatMessage(platformsMessages.templatesFilter),\n          meta: metaInfo,\n          apiRequest: (_, options) =>\n            dispatch(\n              localStorage.getItem('catalog_standalone')\n                ? fetchPlatformItemsS(id, filterValue, options)\n                : fetchPlatformItems(id, filterValue, options)\n            )\n        })}\n      />\n      <ContentGallery\n        title={title}\n        isLoading={isFetching || isFiltering}\n        renderEmptyState={() => (\n          <ContentGalleryEmptyState\n            title={\n              filterValue === ''\n                ? formatMessage(platformsMessages.noTemplatesTitle)\n                : formatMessage(filteringMessages.noResults)\n            }\n            Icon={SearchIcon}\n            PrimaryAction={() =>\n              filterValue !== '' ? (\n                <Button\n                  ouiaId={'clear-filters'}\n                  onClick={() => handleFilterChange('')}\n                  variant=\"link\"\n                >\n                  {formatMessage(filteringMessages.clearFilters)}\n                </Button>\n              ) : null\n            }\n            description={\n              filterValue === ''\n                ? formatMessage(platformsMessages.noTemplatesDescription)\n                : formatMessage(filteringMessages.noResultsDescription)\n            }\n          />\n        )}\n        {...filteredItems}\n      />\n      {metaInfo.count > 0 && (\n        <BottomPaginationContainer>\n          <AsyncPagination\n            dropDirection=\"up\"\n            meta={metaInfo}\n            apiRequest={(_, options) =>\n              dispatch(\n                localStorage.getItem('catalog_standalone')\n                  ? fetchPlatformItemsS(id, filterValue, options)\n                  : fetchPlatformItems(id, filterValue, options)\n              )\n            }\n          />\n        </BottomPaginationContainer>\n      )}\n    </Fragment>\n  );\n};\n\nexport default PlatformTemplates;\n","import { defineMessages } from 'react-intl';\n\nconst platformsMessages = defineMessages({\n  workflowColumn: {\n    id: 'platform.inventories.columns.workflow',\n    defaultMessage: 'Workflow'\n  },\n  noInventoriesDescription: {\n    id: 'platform.inventories.empty.no-inventories',\n    defaultMessage: 'No inventories found.'\n  },\n  noInventoriesFilterDescription: {\n    id: 'platform.inventories.empty.no-results',\n    defaultMessage: 'No inventories match your filter criteria.'\n  },\n  inventoriesFilter: {\n    id: 'platform.inventories.filter.placeholder',\n    defaultMessage: 'Filter by inventory'\n  },\n  templatesFilter: {\n    id: 'platform.templates.filter.placeholder',\n    defaultMessage: 'Filter by template'\n  },\n  noTemplatesTitle: {\n    id: 'platform.templates.no-templates',\n    defaultMessage: 'No templates'\n  },\n  noTemplatesDescription: {\n    id: 'platform.templates.empty.no-templates',\n    defaultMessage: 'This platform has no templates.'\n  },\n  platformsNoDataDescription: {\n    id: 'platforms.list.configure-source',\n    defaultMessage:\n      'Ansible Automation Services Catalog can be added by following the'\n  },\n  platformsDocTitle: {\n    id: 'platforms.doc.title',\n    defaultMessage: 'Ansible Automation Platform 2.0 BETA documentation'\n  },\n  connectSource: {\n    id: 'platforms.list.connect-source',\n    defaultMessage: 'Go to Sources'\n  },\n  contactAdmin: {\n    id: 'platforms.list.contact-admin',\n    defaultMessage:\n      'Contact your organization administrator to setup sources for Catalog.'\n  },\n  title: {\n    id: 'platforms.title',\n    defaultMessage: 'Platforms'\n  },\n  noPlatforms: {\n    id: 'platforms.list.empty.title',\n    defaultMessage: 'No platforms yet'\n  },\n  offeringTitle: {\n    id: 'platforms.offerings.detail.title',\n    defaultMessage: 'Service offering'\n  },\n  offeringParameters: {\n    id: 'platforms.offerings.detail.extra-params',\n    defaultMessage: 'Extra parameters'\n  },\n  platformVersion: {\n    id: 'platforms.version',\n    defaultMessage: 'Platform version'\n  },\n  ansibleVersion: {\n    id: 'platforms.ansible.version',\n    defaultMessage: 'Ansible version'\n  },\n  platformSummary: {\n    id: 'platforms.summary',\n    defaultMessage: 'Summary'\n  },\n  platformDetails: {\n    id: 'platforms.details',\n    defaultMessage: 'Details'\n  },\n  platformActivity: {\n    id: 'platforms.activity',\n    defaultMessage: 'Activity'\n  },\n  cloudConnectorId: {\n    id: 'platform.cloudConnectorId',\n    defaultMessage: 'RedHat Connect Client Id'\n  },\n  refreshState: {\n    id: 'platforms.refreshState',\n    defaultMessage: 'Refresh state'\n  },\n  refreshStarted: {\n    id: 'platforms.refreshStarted',\n    defaultMessage: 'Refresh started'\n  },\n  refreshFinished: {\n    id: 'platforms.refreshFinished',\n    defaultMessage: 'Refresh finished'\n  },\n  lastSuccessfulRefresh: {\n    id: 'platforms.lastSuccessfulRefresh',\n    defaultMessage: 'Last successful refresh'\n  },\n  lastChecked: {\n    id: 'platforms.lastChecked',\n    defaultMessage: 'Last checked'\n  },\n  lastAvailable: {\n    id: 'platforms.lastAvailable',\n    defaultMessage: 'Last available'\n  },\n  enabled: {\n    id: 'platforms.enabled',\n    defaultMessage: 'Enabled'\n  },\n  availabilityStatus: {\n    id: 'platforms.availabilityStatus',\n    defaultMessage: 'Availability status'\n  },\n  dateAdded: {\n    id: 'platforms.dateAdded',\n    defaultMessage: 'Date added'\n  },\n  refreshTooltip: {\n    id: 'platforms.refreshTooltip',\n    defaultMessage: 'Refresh platform'\n  },\n  lastRefreshMessage: {\n    id: 'platforms.lastRefreshMessage',\n    defaultMessage: 'Last refresh message'\n  },\n  availabilityMessage: {\n    id: 'platforms.availabilityMessage',\n    defaultMessage: 'Availability message'\n  }\n});\n\nexport default platformsMessages;\n"],"names":["initialState","filterValue","isOpen","isFetching","isFiltering","platformItemsState","state","action","type","payload","debouncedFilter","asyncFormValidator","id","value","dispatch","filteringCallback","meta","defaultSettings","localStorage","getItem","fetchPlatformItemsS","fetchPlatformItems","then","formatMessage","useFormatMessage","useQuery","platform","useReducer","stateDispatch","useSelector","platformItems","platformReducer","data","results","count","selectedPlatform","platformIconMapping","useDispatch","useEffect","scrollToTop","dataSet","metaInfo","handleFilterChange","offset","filteredItems","items","map","item","key","pathname","PLATFORM_SERVICE_OFFERINGS_ROUTE","searchParams","service","preserveSearch","src","title","name","Fragment","schema","createPlatformsFilterToolbarSchema","onFilterChange","searchValue","filterPlaceholder","platformsMessages","apiRequest","_","options","isLoading","renderEmptyState","filteringMessages","Icon","SearchIcon","PrimaryAction","Button","ouiaId","onClick","variant","description","dropDirection","workflowColumn","defaultMessage","noInventoriesDescription","noInventoriesFilterDescription","inventoriesFilter","templatesFilter","noTemplatesTitle","noTemplatesDescription","platformsNoDataDescription","platformsDocTitle","connectSource","contactAdmin","noPlatforms","offeringTitle","offeringParameters","platformVersion","ansibleVersion","platformSummary","platformDetails","platformActivity","cloudConnectorId","refreshState","refreshStarted","refreshFinished","lastSuccessfulRefresh","lastChecked","lastAvailable","enabled","availabilityStatus","dateAdded","refreshTooltip","lastRefreshMessage","availabilityMessage"],"sourceRoot":""}