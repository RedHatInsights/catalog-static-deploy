{"version":3,"file":"js/platform-templates.2d88f1f178096f03aed2.js","mappings":"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","sources":["webpack:///./src/smart-components/platform/platform-templates.js"],"sourcesContent":["import React, { Fragment, useEffect, useReducer } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { SearchIcon } from '@patternfly/react-icons';\nimport { scrollToTop } from '../../helpers/shared/helpers';\nimport ToolbarRenderer from '../../toolbar/toolbar-renderer';\nimport { defaultSettings } from '../../helpers/shared/pagination';\nimport { fetchPlatformItems } from '../../redux/actions/platform-actions';\nimport { fetchPlatformItems as fetchPlatformItemsS } from '../../redux/actions/platform-actions-s';\nimport PlatformItem from '../../presentational-components/platform/platform-item';\nimport { createPlatformsFilterToolbarSchema } from '../../toolbar/schemas/platforms-toolbar.schema';\nimport ContentGalleryEmptyState from '../../presentational-components/shared/content-gallery-empty-state';\nimport asyncFormValidator from '../../utilities/async-form-validator';\nimport ContentGallery from '../content-gallery/content-gallery';\nimport { Button } from '@patternfly/react-core';\nimport AsyncPagination from '../common/async-pagination';\nimport BottomPaginationContainer from '../../presentational-components/shared/bottom-pagination-container';\nimport useQuery from '../../utilities/use-query';\nimport { PLATFORM_SERVICE_OFFERINGS_ROUTE } from '../../constants/routes';\nimport filteringMessages from '../../messages/filtering.messages';\nimport platformsMessages from '../../messages/platforms.messages';\nimport useFormatMessage from '../../utilities/use-format-message';\n\nconst initialState = {\n  filterValue: '',\n  isOpen: false,\n  isFetching: true,\n  isFiltering: false\n};\n\nconst platformItemsState = (state, action) => {\n  switch (action.type) {\n    case 'setFetching':\n      return { ...state, isFetching: action.payload };\n    case 'setFilterValue':\n      return { ...state, filterValue: action.payload };\n    case 'setFilteringFlag':\n      return { ...state, isFiltering: action.payload };\n    default:\n      return state;\n  }\n};\n\nconst debouncedFilter = asyncFormValidator(\n  (id, value, dispatch, filteringCallback, meta = defaultSettings) => {\n    filteringCallback(true);\n    dispatch(\n      window.catalog?.standalone\n        ? fetchPlatformItemsS(id, value, meta)\n        : fetchPlatformItems(id, value, meta)\n    ).then(() => filteringCallback(false));\n  },\n  1000\n);\n\nconst PlatformTemplates = () => {\n  const formatMessage = useFormatMessage();\n  const [{ platform: id }] = useQuery(['platform']);\n  const [{ filterValue, isFetching, isFiltering }, stateDispatch] = useReducer(\n    platformItemsState,\n    initialState\n  );\n  const {\n    data,\n    results,\n    count,\n    meta\n  } = useSelector(({ platformReducer: { platformItems } }) =>\n    platformItems[id]\n      ? platformItems[id]\n      : { data: [], results: [], meta: defaultSettings, count: 0 }\n  );\n\n  const { platform, platformIconMapping } = useSelector(\n    ({ platformReducer: { selectedPlatform, platformIconMapping } }) => ({\n      platform: selectedPlatform,\n      platformIconMapping\n    })\n  );\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(\n      window.catalog?.standalone\n        ? fetchPlatformItemsS(id, filterValue, defaultSettings)\n        : fetchPlatformItems(id, filterValue, defaultSettings)\n    ).then(() => stateDispatch({ type: 'setFetching', payload: false }));\n    scrollToTop();\n  }, [id]);\n\n  const dataSet = data ? data : results;\n  const metaInfo = meta ? meta : { count };\n\n  const handleFilterChange = (value) => {\n    stateDispatch({ type: 'setFilterValue', payload: value });\n    debouncedFilter(\n      id,\n      value,\n      dispatch,\n      (isFiltering) =>\n        stateDispatch({ type: 'setFilteringFlag', payload: isFiltering }),\n      {\n        ...metaInfo,\n        offset: 0\n      }\n    );\n  };\n\n  const filteredItems = {\n    items: dataSet\n      ? dataSet.map((item) => (\n          <PlatformItem\n            key={item.id}\n            pathname={PLATFORM_SERVICE_OFFERINGS_ROUTE}\n            searchParams={{\n              service: item.id\n            }}\n            preserveSearch\n            src={platformIconMapping[id]}\n            {...item}\n          />\n        ))\n      : []\n  };\n\n  const title = platform ? platform.name : '';\n  return (\n    <Fragment>\n      <ToolbarRenderer\n        schema={createPlatformsFilterToolbarSchema({\n          onFilterChange: handleFilterChange,\n          searchValue: filterValue,\n          filterPlaceholder: formatMessage(platformsMessages.templatesFilter),\n          meta: metaInfo,\n          apiRequest: (_, options) =>\n            dispatch(\n              window.catalog?.standalone\n                ? fetchPlatformItemsS(id, filterValue, options)\n                : fetchPlatformItems(id, filterValue, options)\n            )\n        })}\n      />\n      <ContentGallery\n        title={title}\n        isLoading={isFetching || isFiltering}\n        renderEmptyState={() => (\n          <ContentGalleryEmptyState\n            title={\n              filterValue === ''\n                ? formatMessage(platformsMessages.noTemplatesTitle)\n                : formatMessage(filteringMessages.noResults)\n            }\n            Icon={SearchIcon}\n            PrimaryAction={() =>\n              filterValue !== '' ? (\n                <Button\n                  ouiaId={'clear-filters'}\n                  onClick={() => handleFilterChange('')}\n                  variant=\"link\"\n                >\n                  {formatMessage(filteringMessages.clearFilters)}\n                </Button>\n              ) : null\n            }\n            description={\n              filterValue === ''\n                ? formatMessage(platformsMessages.noTemplatesDescription)\n                : formatMessage(filteringMessages.noResultsDescription)\n            }\n          />\n        )}\n        {...filteredItems}\n      />\n      {metaInfo.count > 0 && (\n        <BottomPaginationContainer>\n          <AsyncPagination\n            dropDirection=\"up\"\n            meta={metaInfo}\n            apiRequest={(_, options) =>\n              dispatch(\n                window.catalog?.standalone\n                  ? fetchPlatformItemsS(id, filterValue, options)\n                  : fetchPlatformItems(id, filterValue, options)\n              )\n            }\n          />\n        </BottomPaginationContainer>\n      )}\n    </Fragment>\n  );\n};\n\nexport default PlatformTemplates;\n"],"names":["initialState","filterValue","isOpen","isFetching","isFiltering","platformItemsState","state","action","type","payload","debouncedFilter","asyncFormValidator","id","value","dispatch","filteringCallback","meta","defaultSettings","window","catalog","standalone","fetchPlatformItemsS","fetchPlatformItems","then","formatMessage","useFormatMessage","useQuery","platform","useReducer","stateDispatch","useSelector","platformItems","platformReducer","data","results","count","selectedPlatform","platformIconMapping","useDispatch","useEffect","scrollToTop","dataSet","metaInfo","handleFilterChange","offset","filteredItems","items","map","item","key","pathname","PLATFORM_SERVICE_OFFERINGS_ROUTE","searchParams","service","preserveSearch","src","title","name","Fragment","schema","createPlatformsFilterToolbarSchema","onFilterChange","searchValue","filterPlaceholder","platformsMessages","apiRequest","_","options","isLoading","renderEmptyState","filteringMessages","Icon","SearchIcon","PrimaryAction","Button","ouiaId","onClick","variant","description","dropDirection"],"sourceRoot":""}