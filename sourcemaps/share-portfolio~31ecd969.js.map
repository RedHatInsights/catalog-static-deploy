{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/extends.js","webpack:///./node_modules/awesome-imperative-promise/dist/index.es.js","webpack:///./node_modules/awesome-debounce-promise/dist/index.es.js","webpack:///./node_modules/awesome-only-resolves-last-promise/dist/index.es.js","webpack:///./src/utilities/async-form-validator.js","webpack:///./node_modules/debounce-promise/dist/index.js","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///./src/utilities/use-enhanced-history.js","webpack:///./src/forms/portfolio-share-form.schema.js","webpack:///./src/helpers/share/share-helper.js","webpack:///./src/redux/actions/share-actions.js","webpack:///./src/helpers/rbac/rbac-helper.js","webpack:///./src/smart-components/portfolio/share-portfolio-modal.js"],"names":["_extends","module","exports","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","createImperativePromise","promiseArg","resolve","reject","wrappedPromise","Promise","_resolve","_reject","then","val","error","promise","value","reason","cancel","__assign","t","s","n","p","DefaultOptions","_args","_i","onlyResolvesLast","DebounceCache","config","debounceSingleton","debounceCache","_createDebouncedFunction","asyncFunction","cancelPrevious","debouncedFunc","func","wait","options","args","initialPromise","_a","getDebouncedFunction","finalOptions","debouncedFn","debounceTime","awesomeDebouncePromise","getWait","defer","deferred","fn","undefined","lastCallAt","timer","pendingArgs","currentWait","currentTime","Date","getTime","isCold","_len","Array","_key","leading","accumulate","result","concat","clearTimeout","push","setTimeout","flush","bind","argsIndex","results","thisDeferred","_typeof","obj","Symbol","iterator","constructor","removeSearchQuery","split","search","useEnhancedHistory","removeSearch","keepHash","history","useHistory","internalTarget","location","hash","createPortfolioShareSchema","shareInfo","loadGroupOptions","permissionVerbs","canShare","canUnshare","validate","formSchema","component","description","name","fields","inputName","selectName","loadOptions","isSearchable","permissions","newShareSchema","groupInfoFields","map","group","groupShareInfo","group_name","label","isClearable","groupShareSchema","shareListSchema","axiosInstance","getAxiosInstance","userApi","getPortfolioApi","getShareInfo","portfolioId","a","get","CATALOG_API_BASE","sharePortfolio","portfolioData","type","ActionTypes","payload","data","policy","group_uuids","group_uuid","id","meta","notifications","fulfilled","variant","title","unsharePortfolio","getRbacGroupApi","SharePortfolioModal","closeUrl","removeQuery","viewState","portfolioName","dispatch","useDispatch","useQuery","portfolio","useState","isFetching","setFetching","initialValues","useSelector","portfolioReducer","selectedPortfolio","shareReducer","useEffect","ShareHelper","onCancel","pathname","metadata","user_capabilities","share","unshare","Modal","isOpen","onClose","Stack","hasGutter","StackItem","TextContent","Text","schema","inputValue","filterValue","RBAC_API_BASE","uuid","fetchFilterGroups","permissionOptions","schemaType","onSubmit","sharePromises","forEach","initialPerm","sort","join","sharePermissions","filter","permission","permissionValues","indexOf","all","fetchPortfolios","values","errors","groupPermissions","groupName","find","perm","reduce","acc","curr","formContainer","buttonsLabels","submitLabel","propTypes","PropTypes","string","isRequired","bool","shape","count","number","limit","offset"],"mappings":"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","file":"js/share-portfolio~31ecd969.f075965358ee8842aa67.js","sourcesContent":["function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","function createImperativePromise(promiseArg) {\r\n    var resolve = null;\r\n    var reject = null;\r\n    var wrappedPromise = new Promise(function (_resolve, _reject) {\r\n        resolve = _resolve;\r\n        reject = _reject;\r\n    });\r\n    promiseArg && promiseArg.then(function (val) {\r\n        resolve && resolve(val);\r\n    }, function (error) {\r\n        reject && reject(error);\r\n    });\r\n    return {\r\n        promise: wrappedPromise,\r\n        resolve: function (value) {\r\n            resolve && resolve(value);\r\n        },\r\n        reject: function (reason) {\r\n            reject && reject(reason);\r\n        },\r\n        cancel: function () {\r\n            resolve = null;\r\n            reject = null;\r\n        }\r\n    };\r\n}\n\nexport { createImperativePromise };\n//# sourceMappingURL=index.es.js.map\n","import DebouncePromise from 'debounce-promise';\nimport { onlyResolvesLast } from 'awesome-only-resolves-last-promise';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar DefaultOptions = {\r\n    // One distinct debounced function is created per key and added to an internal cache\r\n    // By default, the key is null, which means that all the calls\r\n    // will share the same debounced function\r\n    key: function () {\r\n        var _args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            _args[_i] = arguments[_i];\r\n        }\r\n        return null;\r\n    },\r\n    // By default, a debounced function will only resolve\r\n    // the last promise it returned\r\n    // Former calls will stay unresolved, so that you don't have\r\n    // to handle concurrency issues in your code\r\n    // Setting this to false means all returned promises will resolve to the last result\r\n    onlyResolvesLast: true,\r\n};\r\n// We create a debouncing function cache, because when wrapping the original function,\r\n// we may actually want to route the function call to different debounced functions depending function paameters\r\nvar DebounceCache = /** @class */ (function () {\r\n    function DebounceCache(config) {\r\n        this.config = config;\r\n        this.debounceSingleton = null;\r\n        this.debounceCache = {}; // when key feature is used\r\n    }\r\n    DebounceCache.prototype._createDebouncedFunction = function () {\r\n        var debouncedFunc = DebouncePromise(this.config.func, this.config.wait, this.config.options); // TODO TS\r\n        if (this.config.options.onlyResolvesLast) {\r\n            debouncedFunc = onlyResolvesLast(debouncedFunc);\r\n        }\r\n        return {\r\n            func: debouncedFunc,\r\n        };\r\n    };\r\n    DebounceCache.prototype.getDebouncedFunction = function (args) {\r\n        var _a;\r\n        var key = (_a = this.config.options).key.apply(_a, args);\r\n        if (key === null || typeof key === 'undefined') {\r\n            if (!this.debounceSingleton) {\r\n                this.debounceSingleton = this._createDebouncedFunction();\r\n            }\r\n            return this.debounceSingleton;\r\n        }\r\n        else {\r\n            if (!this.debounceCache[key]) {\r\n                this.debounceCache[key] = this._createDebouncedFunction();\r\n            }\r\n            return this.debounceCache[key];\r\n        }\r\n    };\r\n    return DebounceCache;\r\n}());\r\nfunction AwesomeDebouncePromise(func, wait, options) {\r\n    var finalOptions = __assign({}, DefaultOptions, options);\r\n    var debounceCache = new DebounceCache({\r\n        func: func,\r\n        wait: wait,\r\n        options: finalOptions,\r\n    });\r\n    var AwesomeDebouncePromiseWrapper = (function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var debouncedFn = debounceCache.getDebouncedFunction(args).func;\r\n        return debouncedFn.apply(void 0, args);\r\n    }); // TODO fix TS\r\n    /*\r\n    AwesomeDebouncePromiseWrapper.cancel = (key?: string) => {\r\n  \n    };\r\n    */\r\n    return AwesomeDebouncePromiseWrapper;\r\n}\n\nexport default AwesomeDebouncePromise;\n//# sourceMappingURL=index.es.js.map\n","import { createImperativePromise } from 'awesome-imperative-promise';\n\n// see https://stackoverflow.com/a/54825370/82609\r\nfunction onlyResolvesLast(asyncFunction) {\r\n    var cancelPrevious = null;\r\n    var wrappedFunction = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        cancelPrevious && cancelPrevious();\r\n        var initialPromise = asyncFunction.apply(void 0, args);\r\n        var _a = createImperativePromise(initialPromise), promise = _a.promise, cancel = _a.cancel;\r\n        cancelPrevious = cancel;\r\n        return promise;\r\n    };\r\n    return wrappedFunction; // TODO fix TS\r\n}\n\nexport { onlyResolvesLast };\n//# sourceMappingURL=index.es.js.map\n","import awesomeDebouncePromise from 'awesome-debounce-promise';\n\nexport default (\n  asyncFunction,\n  debounceTime = 250,\n  options = { onlyResolvesLast: false }\n) => awesomeDebouncePromise(asyncFunction, debounceTime, options);\n","'use strict';\n\n/* global setTimeout, clearTimeout */\n\nmodule.exports = function debounce(fn) {\n  var wait = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  var lastCallAt = void 0;\n  var deferred = void 0;\n  var timer = void 0;\n  var pendingArgs = [];\n  return function debounced() {\n    var currentWait = getWait(wait);\n    var currentTime = new Date().getTime();\n\n    var isCold = !lastCallAt || currentTime - lastCallAt > currentWait;\n\n    lastCallAt = currentTime;\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (isCold && options.leading) {\n      return options.accumulate ? Promise.resolve(fn.call(this, [args])).then(function (result) {\n        return result[0];\n      }) : Promise.resolve(fn.call.apply(fn, [this].concat(args)));\n    }\n\n    if (deferred) {\n      clearTimeout(timer);\n    } else {\n      deferred = defer();\n    }\n\n    pendingArgs.push(args);\n    timer = setTimeout(flush.bind(this), currentWait);\n\n    if (options.accumulate) {\n      var argsIndex = pendingArgs.length - 1;\n      return deferred.promise.then(function (results) {\n        return results[argsIndex];\n      });\n    }\n\n    return deferred.promise;\n  };\n\n  function flush() {\n    var thisDeferred = deferred;\n    clearTimeout(timer);\n\n    Promise.resolve(options.accumulate ? fn.call(this, pendingArgs) : fn.apply(this, pendingArgs[pendingArgs.length - 1])).then(thisDeferred.resolve, thisDeferred.reject);\n\n    pendingArgs = [];\n    deferred = null;\n  }\n};\n\nfunction getWait(wait) {\n  return typeof wait === 'function' ? wait() : wait;\n}\n\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function (resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n//# sourceMappingURL=index.js.map","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","import { useHistory } from 'react-router-dom';\n\nconst removeSearchQuery = (target) => {\n  if (typeof target === 'string') {\n    return target.split('?')[0];\n  }\n\n  if (typeof target === 'object') {\n    return {\n      ...target,\n      search: undefined\n    };\n  }\n\n  return target;\n};\n\n/**\n * Wrapper around useHistory hook which adds aditional settings to standard history methods\n * @param {Boolean} removeSearch if true, using history navigation methods will remove search string from path\n * @param {Boolean} keepHash if true, using history navigation methods will not remove hash from URL\n */\nconst useEnhancedHistory = ({ removeSearch, keepHash } = {}) => {\n  const history = useHistory();\n  return {\n    ...history,\n    push: (target) => {\n      let internalTarget = target;\n      if (keepHash && history.location.hash.length > 0) {\n        internalTarget =\n          typeof internalTarget === 'object'\n            ? { ...internalTarget, hash: history.location.hash }\n            : `${internalTarget}${history.location.hash}`;\n      }\n\n      if (removeSearch) {\n        return history.push(removeSearchQuery(internalTarget));\n      }\n\n      return history.push(internalTarget);\n    }\n  };\n};\n\nexport default useEnhancedHistory;\n","/**\n * Creates a data-driven-form schema for sharing/un-sharing portfolio\n */\nconst newShareSchema = (loadGroupOptions, permissionVerbs) => [\n  {\n    component: 'sub-form',\n    description: 'Invite group',\n    name: 'new_share',\n    key: '1',\n    fields: [\n      {\n        name: 'group-selection',\n        component: 'share-group-select',\n        inputName: 'group_uuid',\n        selectName: 'permissions',\n        loadOptions: loadGroupOptions,\n        isSearchable: true,\n        permissions: permissionVerbs\n      }\n    ]\n  }\n];\n\nconst groupListSchema = (groupFieldList) => [\n  {\n    component: 'sub-form',\n    description: 'Groups with access',\n    name: 'share_list',\n    key: 'share_list',\n    fields: groupFieldList\n  }\n];\n\nconst groupShareSchema = (groupShareInfo, permissionVerbs) => ({\n  component: 'sub-form',\n  name: `${groupShareInfo.group_name}`,\n  key: `${groupShareInfo.group_name}`,\n  fields: [\n    {\n      name: `${groupShareInfo.group_name}`,\n      label: `${groupShareInfo.group_name}`,\n      component: 'share-group-edit',\n      options: permissionVerbs,\n      isClearable: true\n    }\n  ]\n});\n\nexport const createPortfolioShareSchema = (\n  shareInfo,\n  loadGroupOptions,\n  permissionVerbs,\n  canShare,\n  canUnshare,\n  validate\n) => {\n  const formSchema = canShare\n    ? newShareSchema(loadGroupOptions, permissionVerbs, validate)\n    : [];\n  const groupInfoFields = shareInfo.map((group) =>\n    groupShareSchema(group, permissionVerbs)\n  );\n  const shareListSchema = canUnshare ? groupListSchema(groupInfoFields) : [];\n  const portfolioSchema = {\n    fields: [...formSchema, ...shareListSchema]\n  };\n  return portfolioSchema;\n};\n","import { getAxiosInstance, getPortfolioApi } from '../shared/user-login';\nimport { CATALOG_API_BASE } from '../../utilities/constants';\n\nconst axiosInstance = getAxiosInstance();\nconst userApi = getPortfolioApi();\n\nexport async function getShareInfo(portfolioId) {\n  return await axiosInstance.get(\n    `${CATALOG_API_BASE}/portfolios/${portfolioId}/share_info`\n  );\n}\n\nexport function sharePortfolio(data) {\n  let policy = {\n    permissions: data.permissions.split(','),\n    group_uuids: [data.group_uuid]\n  };\n  return userApi.sharePortfolio(data.id, policy);\n}\n\nexport function unsharePortfolio(data) {\n  let policy = {\n    permissions: data.permissions,\n    group_uuids: [data.group_uuid]\n  };\n  return userApi.unsharePortfolio(data.id, policy);\n}\n","import * as ShareHelper from '../../helpers/share/share-helper';\nimport * as ActionTypes from '../action-types';\n\nexport const fetchShareInfo = (portfolioId) => ({\n  type: ActionTypes.QUERY_PORTFOLIO,\n  payload: ShareHelper.getShareInfo(portfolioId)\n});\n\nexport const sharePortfolio = (portfolioData) => ({\n  type: ActionTypes.SHARE_PORTFOLIO,\n  payload: ShareHelper.sharePortfolio({\n    ...portfolioData\n  }),\n  meta: {\n    notifications: {\n      fulfilled: {\n        variant: 'success',\n        title: 'Success sharing portfolio',\n        description: 'The portfolio was shared successfully.'\n      }\n    }\n  }\n});\n\nexport const unsharePortfolio = (portfolioData) => ({\n  type: ActionTypes.UNSHARE_PORTFOLIO,\n  payload: ShareHelper.unsharePortfolio({\n    ...portfolioData\n  }),\n  meta: {\n    notifications: {\n      fulfilled: {\n        variant: 'success',\n        title: 'Success unsharing portfolio',\n        description: 'The portfolio was unshared successfully.'\n      }\n    }\n  }\n});\n","import { getAxiosInstance, getRbacGroupApi } from '../shared/user-login';\nimport { RBAC_API_BASE } from '../../utilities/constants';\n\nconst api = getRbacGroupApi();\n\nexport async function getRbacGroups() {\n  return await api.listGroups();\n}\n\nexport const fetchFilterGroups = (filterValue = '') =>\n  getAxiosInstance()\n    .get(\n      `${RBAC_API_BASE}/groups/${\n        filterValue.length > 0 ? `?name=${filterValue}` : ''\n      }`\n    )\n    .then(({ data }) =>\n      data.map(({ uuid, name }) => ({ label: name, value: uuid }))\n    );\n","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport FormRenderer from '../common/form-renderer';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  Modal,\n  TextContent,\n  Text,\n  Stack,\n  StackItem\n} from '@patternfly/react-core';\nimport { createPortfolioShareSchema } from '../../forms/portfolio-share-form.schema';\nimport { fetchPortfolios } from '../../redux/actions/portfolio-actions';\nimport {\n  fetchShareInfo,\n  sharePortfolio,\n  unsharePortfolio\n} from '../../redux/actions/share-actions';\nimport { ShareLoader } from '../../presentational-components/shared/loader-placeholders';\nimport { permissionOptions, permissionValues } from '../../utilities/constants';\nimport { fetchFilterGroups } from '../../helpers/rbac/rbac-helper';\nimport useQuery from '../../utilities/use-query';\nimport useEnhancedHistory from '../../utilities/use-enhanced-history';\nimport { UnauthorizedRedirect } from '../error-pages/error-redirects';\n\nconst SharePortfolioModal = ({\n  closeUrl,\n  removeQuery,\n  viewState,\n  portfolioName = () => ''\n}) => {\n  const dispatch = useDispatch();\n  const { push } = useEnhancedHistory({ removeQuery, keepHash: true });\n  const [{ portfolio }, search] = useQuery(['portfolio']);\n  const [isFetching, setFetching] = useState(true);\n  const initialValues = useSelector(\n    ({ portfolioReducer: { selectedPortfolio } }) => selectedPortfolio\n  );\n  const { shareInfo } = useSelector(({ shareReducer: { shareInfo } }) => ({\n    shareInfo\n  }));\n  useEffect(() => {\n    setFetching(true);\n    dispatch(fetchShareInfo(portfolio))\n      .then(() => setFetching(false))\n      .catch(() => setFetching(false));\n  }, []);\n\n  const initialShares = () => {\n    let initialGroupShareList = shareInfo.map((group) => {\n      const groupPermissions = group.permissions.filter(\n        (permission) => permissionValues.indexOf(permission) > -1\n      );\n      const groupName = group.group_name;\n      let options = permissionOptions.find(\n        (perm) => perm.value === groupPermissions.sort().join(',')\n      );\n      return {\n        [groupName]: options ? options.value : 'Unknown'\n      };\n    });\n    let initialShareList = initialGroupShareList.reduce(\n      (acc, curr) => ({ ...acc, ...curr }),\n      {}\n    );\n    return initialShareList;\n  };\n\n  const loadGroupOptions = (inputValue) => fetchFilterGroups(inputValue);\n\n  const onSubmit = (data) => {\n    let sharePromises = [];\n    if (data.group_uuid && data.permissions) {\n      sharePromises.push(dispatch(sharePortfolio({ id: portfolio, ...data })));\n    }\n\n    shareInfo.forEach((share) => {\n      let initialPerm = share.permissions.sort().join(',');\n      if (data[share.group_name] !== initialPerm) {\n        if (!data[share.group_name]) {\n          const sharePermissions = share.permissions.filter(\n            (permission) => permissionValues.indexOf(permission) > -1\n          );\n          sharePromises.push(\n            dispatch(\n              unsharePortfolio({\n                id: portfolio,\n                permissions: sharePermissions,\n                group_uuid: share.group_uuid\n              })\n            )\n          );\n        } else {\n          if (\n            share.permissions.length > data[share.group_name].split(',').length\n          ) {\n            sharePromises.push(\n              dispatch(\n                unsharePortfolio({\n                  id: portfolio,\n                  permissions: ['update'],\n                  group_uuid: share.group_uuid\n                })\n              )\n            );\n          } else {\n            sharePromises.push(\n              dispatch(\n                sharePortfolio({\n                  id: portfolio,\n                  permissions: data[share.group_name],\n                  group_uuid: share.group_uuid\n                })\n              )\n            );\n          }\n        }\n      }\n    });\n    push({ pathname: closeUrl, search });\n\n    return Promise.all(sharePromises).then(() =>\n      dispatch(fetchPortfolios(viewState))\n    );\n  };\n\n  const onCancel = () => push({ pathname: closeUrl, search });\n\n  if (\n    initialValues?.metadata?.user_capabilities?.share === false &&\n    initialValues?.metadata?.user_capabilities?.unshare === false\n  ) {\n    return <UnauthorizedRedirect />;\n  }\n\n  const validateShares = (values) => {\n    const errors = {};\n    if (values.group_uuid && !values.permissions) {\n      errors.permissions = 'Select the share permissions';\n    }\n\n    if (values.permissions && !values.group_uuid) {\n      errors.group_uuid = 'Select a group';\n    }\n\n    return errors;\n  };\n\n  return (\n    <Modal title=\"Share portfolio\" isOpen variant=\"small\" onClose={onCancel}>\n      {isFetching && <ShareLoader />}\n      {!isFetching && (\n        <Stack hasGutter>\n          <StackItem>\n            <TextContent>\n              <Text>\n                Share <strong>{portfolioName(portfolio)}</strong> portfolio\n              </Text>\n            </TextContent>\n          </StackItem>\n          <StackItem>\n            <FormRenderer\n              schema={createPortfolioShareSchema(\n                shareInfo,\n                loadGroupOptions,\n                permissionOptions,\n                initialValues?.metadata?.user_capabilities?.share !== false,\n                initialValues?.metadata?.user_capabilities?.unshare !== false\n              )}\n              schemaType=\"default\"\n              onSubmit={onSubmit}\n              onCancel={onCancel}\n              validate={validateShares}\n              initialValues={{ ...initialValues, ...initialShares() }}\n              formContainer=\"modal\"\n              buttonsLabels={{ submitLabel: 'Apply' }}\n            />\n          </StackItem>\n        </Stack>\n      )}\n    </Modal>\n  );\n};\n\nSharePortfolioModal.propTypes = {\n  closeUrl: PropTypes.string.isRequired,\n  removeQuery: PropTypes.bool,\n  portfolioName: PropTypes.func,\n  viewState: PropTypes.shape({\n    count: PropTypes.number,\n    limit: PropTypes.number,\n    offset: PropTypes.number,\n    filter: PropTypes.string\n  })\n};\n\nexport default SharePortfolioModal;\n"],"sourceRoot":""}