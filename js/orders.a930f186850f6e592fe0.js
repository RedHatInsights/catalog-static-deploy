"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[486],{72205:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(30624),a=r.n(n),l=r(80708),i=r(66678),o=r(91703);var s=r(45237),c=r(54213),u=r(66031),d=r(92223),p=r(32875),f=r(82398),m=r(75795),y=r(47962),v=r(11608),h=r(8666),g=r(62410),E=r(32642),F=r(35388),b=r(20697),Z=r(36722),T=r(31644),x=r(42413),B=function(){return(B=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var _=r(77172),I=r(81624),O=r(7247),D=r(44058),C=r(97881),S=r(40229),w=r(56682),P=r(23349),A=function(){return(A=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},k=(0,I.Z)((function(e,t,r,n){void 0===t&&(t=O.he),n(!0),r((0,y.AU)(e,t)).then((function(){return n(!1)}))}),1e3),N={isOpen:!1,isFetching:!0,isFiltering:!1,filterType:"state",filters:{state:[],owner:""},sortBy:{index:0,direction:m.SortByDirection.desc}},R=function(e,t){switch(t.type){case"setFetching":return A(A({},e),{isFetching:t.payload});case"setFilterValue":return A(A({},e),{filters:(r=t.payload,n=e.filterType,a=e.filters,A(A({},a),((l={})[n]=r,l)))});case"replaceFilterChip":return A(A({},e),{filters:t.payload});case"setFilteringFlag":return A(A({},e),{isFiltering:t.payload});case"setFilterType":return A(A({},e),{filterType:t.payload});case"setSortBy":return A(A({},e),{sortBy:t.payload,isFetching:!0})}var r,n,a,l;return e},j={0:"id",3:"owner",4:"created_at",6:"state"};const V=function(){var e,t,r,i=(0,P.Z)(),o=(0,s.useDispatch)(),I=(0,D.Z)(),O=(0,n.useReducer)(R,A(A({},N),{filters:(null===(e=null==I?void 0:I.orders)||void 0===e?void 0:e.filters)||{state:[],owner:""},sortBy:{direction:(null===(t=null==I?void 0:I.orders)||void 0===t?void 0:t.sortDirection)||m.SortByDirection.desc,index:(null===(r=null==I?void 0:I.orders)||void 0===r?void 0:r.sortIndex)||0}})),V=O[0],L=V.isFetching,U=V.isFiltering,G=V.filterType,H=V.filters,q=V.sortBy,z=O[1],W=(0,s.useSelector)((function(e){return e.orderReducer.orders})),J=W.data,K=W.meta,M=[{title:i(S.Z.orderID)},i(w.Z.product),"",{title:i(S.Z.orderedByLabel)},{title:i(S.Z.orderDate)},i(w.Z.updated),{title:i(w.Z.status)}].map((function(e){return"object"!=typeof e||L||U||0===J.length?e:A(A({},e),{transforms:[m.sortable]})})),Q=(0,s.useSelector)((function(e){return e.portfolioReducer.portfolioItems.data})),X=J.map((function(e){var t=function(e,t){var r=e.orderItems,n=r[0]&&t.find((function(e){var t=e.id;return r[0].portfolio_item_id===t}));return n?{orderPlatform:n.service_offering_source_ref,orderPortfolio:n.portfolio_id}:{}}(e,Q),r=t.orderPlatform,o=t.orderPortfolio,s=function(e,t){var r=e.orderItems,n=e.id,a=r[0]&&t.find((function(e){var t=e.id;return r[0].portfolio_item_id===t}));return a?a.name:"Order "+n}(e,Q);return function(e,t,r,i){var o,s,c=e.orderItems[0]&&e.orderItems[0]||{},u=B(B(B(B({order:e.id},c.id?{"order-item":c.id}:{}),c.portfolio_item_id?{"portfolio-item":c.portfolio_item_id}:{}),t?{platform:t}:{}),r?{portfolio:r}:{}),d=(0,T.C)(e.state);return[{title:a().createElement(m.TableText,null,a().createElement(b.Z,{pathname:Z.A5,searchParams:u},e.id))},{title:a().createElement(n.Fragment,null,a().createElement(E.Z,{height:60,src:(o=e,s=o.orderItems,s[0]&&F.Vs+"/portfolio_items/"+s[0].portfolio_item_id+"/icon"),sourceId:t}))},e.orderName,e.owner,{title:a().createElement(l.Text,{className:"pf-u-mb-0",component:l.TextVariants.small},a().createElement(g.Z,{date:e.created_at,variant:"relative"}))},{title:a().createElement(l.Text,{className:"pf-u-mb-0",component:l.TextVariants.small},a().createElement(g.Z,{date:e.orderItems[0]&&e.orderItems[0].updated_at,variant:"relative"}))},{title:a().createElement(m.TableText,null,a().createElement(l.Label,B({},x.Z[e.state],{variant:"outline"}),i(T.Z[d])))}]}(A(A({},e),{orderName:s}),r,o,i)}));(0,n.useEffect)((function(){z({type:"setFetching",payload:!0}),Promise.all([o((0,y.AU)(H,null==I?void 0:I.orders)),o((0,v.dw)())]).then((function(){return z({type:"setFetching",payload:!1})}))}),[]);var Y=function(e,t){return z({type:"setFetching",payload:!0}),o((0,y.AU)(H,A(A({},t),{sortBy:j[q.index],sortDirection:q.direction,sortIndex:q.index}))).then((function(){return z({type:"setFetching",payload:!1})})).catch((function(){return z({type:"setFetching",payload:!1})}))},$=function(e){var t;void 0===e&&(e=""),z({type:"setFilterValue",payload:e}),k(A(A({},H),((t={})[G]=e,t)),A(A({},K),{sortBy:j[q.index],sortDirection:q.direction,sortIndex:q.index,offset:0}),o,(function(e){return z({type:"setFilteringFlag",payload:e})}))},ee=function(){return z({type:"replaceFilterChip",payload:N.filters}),k(N.filters,A(A({},K),{sortBy:j[q.index],sortDirection:q.direction,sortIndex:q.index}),o,(function(e){return z({type:"setFilteringFlag",payload:e})}))};return a().createElement(l.Grid,{hasGutter:!0},a().createElement(l.GridItem,null,a().createElement(c.Z,{type:"content"},!K.noData&&a().createElement(u.Z,{activeFiltersConfig:{filters:Object.entries(H).filter((function(e){var t=e[1];return t&&t.length>0})).map((function(e){var t=e[0],r=e[1];return{category:t,type:t,chips:Array.isArray(r)?r.map((function(e){return{name:e}})):[{name:r}]}})),onDelete:function(e,t,r){var n=t[0];if(r)return ee();var a=A({},H);"state"===n.type?a[n.type]=a[n.type].filter((function(e){var t;return e!==(null===(t=null==n?void 0:n.chips)||void 0===t?void 0:t[0].name)})):a[n.type]="",z({type:"replaceFilterChip",payload:a}),k(a,K,o,(function(e){return z({type:"setFilteringFlag",payload:e})}))}},filterConfig:{onChange:function(e,t){return z({type:"setFilterType",payload:t})},value:G,items:[{filterValues:{items:[{value:"Approval Pending",label:i(T.Z.approvalPending)},{value:"Canceled",label:i(T.Z.canceled)},{value:"Completed",label:i(T.Z.completed)},{value:"Created",label:i(w.Z.created)},{value:"Failed",label:i(T.Z.failed)},{value:"Ordered",label:i(T.Z.ordered)}],value:H.state,onChange:function(e,t){return $(t)}},label:"State",value:"state",type:"checkbox"},{filterValues:{value:H.owner,onChange:function(e,t){return $(t)}},label:"Owner",value:"owner"}]},pagination:a().createElement(_.Z,{isDisabled:L||U,apiRequest:Y,meta:K,isCompact:!0})}),a().createElement(m.Table,A({"aria-label":"orders"},L||U||0!==J.length?{sortBy:q,onSort:function(e,t,r){return z({type:"setSortBy",payload:{index:t,direction:r}}),o((0,y.AU)(H,A(A({},K),{sortBy:j[t],sortDirection:r,sortIndex:t}))).then((function(){return z({type:"setFetching",payload:!1})}))}}:{},{cells:M,rows:L||U?[]:X,className:"orders-table"}),a().createElement(m.TableHeader,null),a().createElement(m.TableBody,null)),!(L||U)&&0===J.length&&a().createElement(d.Z,null,a().createElement(l.Bullseye,null,a().createElement(l.EmptyState,null,a().createElement(l.Bullseye,null,a().createElement(l.EmptyStateIcon,{icon:f.SearchIcon})),a().createElement(l.Title,{headingLevel:"h1",size:"lg"},K.noData?i(S.Z.noOrdersTitle):i(C.Z.noResults)),a().createElement(l.EmptyStateBody,null,K.noData?i(S.Z.noOrdersDescription):i(C.Z.noResultsDescription)),!K.noData&&a().createElement(l.EmptyStateSecondaryActions,null,a().createElement(l.Button,{ouiaId:"clear-filter",variant:"link",onClick:ee},i(C.Z.clearFilters)))))),(L||U)&&a().createElement(h.Wi,null),a().createElement(p.Z,{className:"pf-u-mr-0"},a().createElement("div",{className:"bottom-pagination-container"},a().createElement(l.Flex,{justifyContent:{default:"justifyContentFlexEnd"}},K&&K.count>0&&a().createElement(_.Z,{className:"pf-u-mt-0",isDisabled:L||U,apiRequest:Y,meta:K})))))))},L=function(){return a().createElement(l.Stack,null,a().createElement(i.Z,{schema:{fields:[{component:o.H.TOP_TOOLBAR,className:"orders pf-u-p-lg",key:"orders-toolbar",fields:[{component:o.H.TOP_TOOLBAR_TITLE,key:"orders-toolbar-title",title:"Orders",className:""}]}]}}),a().createElement(V,null))}}}]);