(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{427:function(e,t,n){"use strict";var r=n(448),o=n.n(r);function i(e){var t=null,n=null,r=new Promise((function(e,r){t=e,n=r}));return e&&e.then((function(e){t&&t(e)}),(function(e){n&&n(e)})),{promise:r,resolve:function(e){t&&t(e)},reject:function(e){n&&n(e)},cancel:function(){t=null,n=null}}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u={key:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},onlyResolvesLast:!0},s=function(){function e(e){this.config=e,this.debounceSingleton=null,this.debounceCache={}}return e.prototype._createDebouncedFunction=function(){var e,t,n=o()(this.config.func,this.config.wait,this.config.options);return this.config.options.onlyResolvesLast&&(e=n,t=null,n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t&&t();var o=e.apply(void 0,n),a=i(o),u=a.promise,s=a.cancel;return t=s,u}),{func:n}},e.prototype.getDebouncedFunction=function(e){var t,n=(t=this.config.options).key.apply(t,e);return null==n?(this.debounceSingleton||(this.debounceSingleton=this._createDebouncedFunction()),this.debounceSingleton):(this.debounceCache[n]||(this.debounceCache[n]=this._createDebouncedFunction()),this.debounceCache[n])},e}();t.a=function(e,t,n){var r=a({},u,n),o=new s({func:e,wait:t,options:r});return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.getDebouncedFunction(e).func;return n.apply(void 0,e)}}},428:function(e,t,n){"use strict";var r=n(427);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onlyResolvesLast:!1};return Object(r.a)(e,t,n)}},437:function(e,t,n){"use strict";t.__esModule=!0,n(464),t.default={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-l-stack",stackItem:"pf-l-stack__item"}},439:function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},441:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=r.__importStar(n(0)),i=r.__importDefault(n(437)),a=n(4);t.Stack=e=>{var{hasGutter:t=!1,className:n="",children:u=null,component:s="div"}=e,c=r.__rest(e,["hasGutter","className","children","component"]);const l=s;return o.createElement(l,Object.assign({},c,{className:a.css(i.default.stack,t&&i.default.modifiers.gutter,n)}),u)},t.Stack.displayName="Stack"},447:function(e,t,n){"use strict";var r=n(1),o=n.n(r),i=n(439),a=n.n(i),u=n(53);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return"string"==typeof e?e.split("?")[0]:"object"===a()(e)?c(c({},e),{},{search:void 0}):e};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.removeSearch,n=e.keepHash,r=Object(u.g)();return c(c({},r),{},{push:function(e){var o=e;return n&&r.location.hash.length>0&&(o="object"===a()(o)?c(c({},o),{},{hash:r.location.hash}):"".concat(o).concat(r.location.hash)),t?r.push(l(o)):r.push(o)}})}},448:function(e,t,n){"use strict";function r(e){return"function"==typeof e?e():e}function o(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=void 0,a=void 0,u=void 0,s=[];return function(){var l=r(t),p=(new Date).getTime(),f=!i||p-i>l;i=p;for(var d=arguments.length,h=Array(d),m=0;m<d;m++)h[m]=arguments[m];if(f&&n.leading)return n.accumulate?Promise.resolve(e.call(this,[h])).then((function(e){return e[0]})):Promise.resolve(e.call.apply(e,[this].concat(h)));if(a?clearTimeout(u):a=o(),s.push(h),u=setTimeout(c.bind(this),l),n.accumulate){var v=s.length-1;return a.promise.then((function(e){return e[v]}))}return a.promise};function c(){var t=a;clearTimeout(u),Promise.resolve(n.accumulate?e.call(this,s):e.apply(this,s[s.length-1])).then(t.resolve,t.reject),s=[],a=null}}},452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=r.__importStar(n(0)),i=r.__importDefault(n(207)),a=n(4),u=n(45);var s;!function(e){e.text="text",e.date="date",e.datetimeLocal="datetime-local",e.email="email",e.month="month",e.number="number",e.password="password",e.search="search",e.tel="tel",e.time="time",e.url="url"}(s=t.TextInputTypes||(t.TextInputTypes={}));class c extends o.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange&&this.props.onChange(e.currentTarget.value,e)},e.id||e["aria-label"]||e["aria-labelledby"]||console.error("Text input:","Text input requires either an id or aria-label to be specified")}render(){const e=this.props,{innerRef:t,className:n,type:s,value:c,onChange:l,validated:p,isReadOnly:f,isRequired:d,isDisabled:h}=e,m=r.__rest(e,["innerRef","className","type","value","onChange","validated","isReadOnly","isRequired","isDisabled"]);return o.createElement("input",Object.assign({},m,{className:a.css(i.default.formControl,p===u.ValidatedOptions.success&&i.default.modifiers.success,p===u.ValidatedOptions.warning&&i.default.modifiers.warning,n),onChange:this.handleChange,type:s,value:c,"aria-invalid":p===u.ValidatedOptions.error,required:d,disabled:h,readOnly:f,ref:t}))}}t.TextInputBase=c,c.displayName="TextInputBase",c.defaultProps={"aria-label":null,className:"",isRequired:!1,validated:"default",isDisabled:!1,isReadOnly:!1,type:s.text,onChange:()=>{}},t.TextInput=o.forwardRef((e,t)=>o.createElement(c,Object.assign({},e,{innerRef:t})))},458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=r.__importStar(n(0)),i=r.__importDefault(n(437)),a=n(4);t.StackItem=e=>{var{isFilled:t=!1,className:n="",children:u=null}=e,s=r.__rest(e,["isFilled","className","children"]);return o.createElement("div",Object.assign({},s,{className:a.css(i.default.stackItem,t&&i.default.modifiers.fill,n)}),u)},t.StackItem.displayName="StackItem"},464:function(e,t,n){var r=n(6),o=n(465);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};r(o,i);e.exports=o.locals||{}},465:function(e,t,n){(t=n(7)(!1)).push([e.i,".pf-l-stack {\n  --pf-l-stack--m-gutter--MarginBottom: var(--pf-global--gutter);\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n\n.pf-l-stack__item.pf-m-fill {\n  flex-grow: 1; }\n\n.pf-l-stack.pf-m-gutter > *:not(:last-child) {\n  margin-bottom: var(--pf-l-stack--m-gutter--MarginBottom); }\n",""]),e.exports=t},467:function(e,t,n){var r=n(592);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},586:function(e,t,n){var r=n(587);e.exports=function(e,t){return r(e,t)}},587:function(e,t,n){var r=n(588),o=n(608);e.exports=function e(t,n,i,a,u){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,i,a,e,u))}},588:function(e,t,n){var r=n(589),o=n(596),i=n(601),a=n(602),u=n(605),s=n(128),c=n(606),l=n(607),p="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,d,h,m){var v=s(e),g=s(t),b=v?"[object Array]":u(e),y=g?"[object Array]":u(t),O=(b="[object Arguments]"==b?p:b)==p,_=(y="[object Arguments]"==y?p:y)==p,j=b==y;if(j&&c(e)){if(!c(t))return!1;v=!0,O=!1}if(j&&!O)return m||(m=new r),v||l(e)?o(e,t,n,d,h,m):i(e,t,b,n,d,h,m);if(!(1&n)){var w=O&&f.call(e,"__wrapped__"),x=_&&f.call(t,"__wrapped__");if(w||x){var S=w?e.value():e,P=x?t.value():t;return m||(m=new r),h(S,P,n,d,m)}}return!!j&&(m||(m=new r),a(e,t,n,d,h,m))}},589:function(e,t,n){var r=n(590),o=n(591),i=n(593),a=n(594),u=n(595);function s(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,e.exports=s},590:function(e,t){e.exports=function(){this.__data__=[],this.size=0}},591:function(e,t,n){var r=n(467),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},592:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},593:function(e,t,n){var r=n(467);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},594:function(e,t,n){var r=n(467);e.exports=function(e){return r(this.__data__,e)>-1}},595:function(e,t,n){var r=n(467);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},596:function(e,t,n){var r=n(597),o=n(598),i=n(599);e.exports=function(e,t,n,a,u,s){var c=1&n,l=e.length,p=t.length;if(l!=p&&!(c&&p>l))return!1;var f=s.get(e);if(f&&s.get(t))return f==t;var d=-1,h=!0,m=2&n?new r:void 0;for(s.set(e,t),s.set(t,e);++d<l;){var v=e[d],g=t[d];if(a)var b=c?a(g,v,d,t,e,s):a(v,g,d,e,t,s);if(void 0!==b){if(b)continue;h=!1;break}if(m){if(!o(t,(function(e,t){if(!i(m,t)&&(v===e||u(v,e,n,a,s)))return m.push(t)}))){h=!1;break}}else if(v!==g&&!u(v,g,n,a,s)){h=!1;break}}return s.delete(e),s.delete(t),h}},597:function(e,t,n){var r=n(128);e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return r(e)?e:[e]}},598:function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},599:function(e,t,n){var r=n(600);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},600:function(e,t){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},601:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},602:function(e,t,n){var r=n(603),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,a,u){var s=1&n,c=r(e),l=c.length;if(l!=r(t).length&&!s)return!1;for(var p=l;p--;){var f=c[p];if(!(s?f in t:o.call(t,f)))return!1}var d=u.get(e);if(d&&u.get(t))return d==t;var h=!0;u.set(e,t),u.set(t,e);for(var m=s;++p<l;){var v=e[f=c[p]],g=t[f];if(i)var b=s?i(g,v,f,t,e,u):i(v,g,f,e,t,u);if(!(void 0===b?v===g||a(v,g,n,i,u):b)){h=!1;break}m||(m="constructor"==f)}if(h&&!m){var y=e.constructor,O=t.constructor;y==O||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof O&&O instanceof O||(h=!1)}return u.delete(e),u.delete(t),h}},603:function(e,t,n){var r=n(604)(Object.keys,Object);e.exports=r},604:function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},605:function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},606:function(e,t){e.exports=function(){return!1}},607:function(e,t){e.exports=function(){return!1}},608:function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},858:function(e,t,n){"use strict";n.r(t);var r=n(17),o=n.n(r),i=n(1),a=n.n(i),u=n(49),s=n.n(u),c=n(33),l=n.n(c),p=n(0),f=n.n(p),d=n(11),h=n.n(d),m=n(475),v=n(26),g=n(586),b=n.n(g),y=n(474),O=n(65),_=n(43),j=n(441),w=n(458),x=function(e,t){return[{component:"sub-form",description:"share.new.description",name:"new_share",key:"1",fields:[{name:"group-selection",component:"share-group-select",loadOptions:e,isSearchable:!0,permissions:t}]}]},S=function(e){return[{component:"sub-form",name:"current-groups-sub-form",fields:[{name:"shared-groups",permissionVerbs:e,component:"share-group-edit"}]}]},P=function(e,t,n,r,i){return{fields:[].concat(o()(n?x(e,t):[]),o()(r?S(t):[]))}},k=n(445),D=n(56),T=n.n(D),E=n(87),C=n.n(E),I=n(84),N=n(13),R=Object(I.a)(),A=Object(I.e)();function M(e){return F.apply(this,arguments)}function F(){return(F=C()(T.a.mark((function e(t){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.get("".concat(N.c,"/portfolios/").concat(t,"/share_info"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=n(3);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(e){return{type:V.T,payload:(t=L({},e),n={permissions:t.permissions.split(","),group_uuids:[t.group_uuid]},A.sharePortfolio(t.id,n))};var t,n},G=function(e){return{type:V.V,payload:(t=L({},e),n={permissions:t.permissions,group_uuids:[t.group_uuid]},A.unsharePortfolio(t.id,n))};var t,n},z=n(69);Object(I.g)();var Q=n(68),U=n(447),H=n(130),J=n(82),K=n(431),W=n(72);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e){var t,n,r,i,a,u,c,d,h=e.closeUrl,g=e.removeQuery,x=e.viewState,S=e.portfolioName,D=void 0===S?function(){return""}:S,T=Object(J.a)().formatMessage,E=Object(v.useDispatch)(),C=Object(U.a)({removeQuery:g,keepHash:!0}).push,R=Object(Q.a)(["portfolio"]),A=l()(R,2),F=A[0].portfolio,q=A[1],L=Object(p.useState)(!0),X=l()(L,2),Z=X[0],$=X[1],ee=Object(v.useSelector)((function(e){return e.portfolioReducer.selectedPortfolio})),te=Object(v.useSelector)((function(e){return{shareInfo:e.shareReducer.shareInfo}})).shareInfo;Object(p.useEffect)((function(){var e;$(!0),E((e=F,{type:V.D,payload:M(e)})).then((function(){return $(!1)})).catch((function(){return $(!1)}))}),[]);var ne=function(){return C({pathname:h,search:q})};if(!1===(null==ee||null===(t=ee.metadata)||void 0===t||null===(n=t.user_capabilities)||void 0===n?void 0:n.share)&&!1===(null==ee||null===(r=ee.metadata)||void 0===r||null===(i=r.user_capabilities)||void 0===i?void 0:i.unshare))return f.a.createElement(H.a,null);return f.a.createElement(y.Modal,{title:T(K.a.portfolioShareTitle),isOpen:!0,variant:"small",onClose:ne},Z&&f.a.createElement(z.h,null),!Z&&f.a.createElement(j.Stack,{hasGutter:!0},f.a.createElement(w.StackItem,null,f.a.createElement(O.TextContent,null,f.a.createElement(_.Text,null,T(K.a.portfolioShareDescription,{name:D(F),strong:function(e){return f.a.createElement("strong",{key:"strong"},e)}})))),f.a.createElement(w.StackItem,null,f.a.createElement(m.c,{schema:P((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(I.a)().get("".concat(N.h,"/groups/").concat(e.length>0?"?name=".concat(e):"")).then((function(e){return e.data.map((function(e){var t=e.uuid;return{label:e.name,value:t}}))}))}(e)}),N.k,!1!==(null==ee||null===(a=ee.metadata)||void 0===a||null===(u=a.user_capabilities)||void 0===u?void 0:u.share),!1!==(null==ee||null===(c=ee.metadata)||void 0===c||null===(d=c.user_capabilities)||void 0===d?void 0:d.unshare)),schemaType:"default",onSubmit:function(e,t){var n=e["shared-groups"],r=[],i=t.getState().initialValues["shared-groups"],a=i.filter((function(e){return!n.find((function(t){return t.group_uuid===e.group_uuid}))})).map((function(e){var t=e.permissions;return Y(Y({},s()(e,["permissions"])),{},{permissions:t.split(",")})}));n.forEach((function(e){var t=i.find((function(t){return t.group_uuid===e.group_uuid}));t&&!b()(t,e)&&(t.permissions.length>e.permissions.length?a.push({id:F,permissions:["update"],group_uuid:e.group_uuid}):r.push(e)),t||r.push(e)}));var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?G:B;return E(n({id:F,permissions:e.permissions,group_uuid:e.group_uuid}))},c=[].concat(o()(r.map((function(e){return u(e)}))),o()(a.map((function(e){return u(e,!0)}))));return C({pathname:h,search:q}),Promise.all(c).then((function(){return E({type:W.ADD_NOTIFICATION,payload:{dismissable:!0,variant:"success",title:T(K.a.shareSuccessTitle)}}),E(Object(k.g)(x))}))},onCancel:ne,validate:function(e){var t={};return e.group_uuid&&!e.permissions&&(t.permissions=T(K.a.portfolioSharePermissions)),e.permissions&&!e.group_uuid&&(t.group_uuid=T(K.a.portfolioShareGroups)),t},initialValues:Y(Y({},ee),{},{"shared-groups":te.map((function(e){var t=e.permissions.filter((function(e){return N.l.indexOf(e)>-1})),n=e.group_name,r=N.k.find((function(e){return e.value===t.sort().join(",")}));return{groupName:n,group_uuid:e.group_uuid,permissions:r?r.value:T(K.a.portfolioShareUnknown)}}))}),formContainer:"modal",templateProps:{disableSubmit:["pristine","validating"],submitLabel:T(K.a.portfolioShareApply)}}))))};Z.propTypes={closeUrl:h.a.string.isRequired,removeQuery:h.a.bool,portfolioName:h.a.func,viewState:h.a.shape({count:h.a.number,limit:h.a.number,offset:h.a.number,filter:h.a.string})};t.default=Z}}]);
//# sourceMappingURL=../sourcemaps/share-portfolio~31ecd969.js.map