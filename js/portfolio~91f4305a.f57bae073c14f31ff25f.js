(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{762:function(e,t,r){"use strict";var o,n,a=r(0),c=r(97),i=r(21),u=r(3),l=r(9),s=(l.u,{"portfolio-item":["source"]}),f=((o={})[l.y]=function(e){return e().portfolioReducer.selectedPortfolio.name},o[l.w]=function(e){return e().portfolioReducer.portfolioItem.portfolioItem.name},o[l.g]=function(){return"Edit survey"},o[l.c]=function(){return"Add products"},o[l.r]=function(e){return e().platformReducer.selectedPlatform.name},o[l.s]=function(e){return e().platformReducer.serviceOffering.service.name},o[l.o]=function(e){var t=e().orderReducer.orderDetail,r=t.portfolioItem,o=t.order;return r.name+" # "+o.id},o[l.x]=function(){return"Edit product"},o),p=((n={})[l.y]={pathname:l.u,title:"Portfolios",searchParams:{}},n[l.r]={pathname:l.p,title:"Platforms",searchParams:{}},n[l.o]={pathname:l.m,title:"Orders",searchParams:{}},n),d=function(){return(d=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},m=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],c=0,i=a.length;c<i;c++,n++)o[n]=a[c];return o},h=function(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),function(r,o){if(0===e.length)return r({type:u.D,payload:[]});var n=e.replace(/^\//,"").split("/").reduce((function(e,r,n){var a,c=(n>0&&e[n-1]?e[n-1].pathname:"")+"/"+r,i=f[c];if(!i)return e;var u=d(d({},n>0&&e[n-1].searchParams),t[r]?((a={})[r]=t[r],a):{});return s[r]&&s[r].forEach((function(e){u[e]=t[e]})),m(e,[{pathname:c,searchParams:u,title:i(o)}])}),[]);return n.length>0&&p[n[0].pathname]&&(n=m([p[n[0].pathname]],n)),r({type:u.D,payload:n})}},b=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],c=0,i=a.length;c<i;c++,n++)o[n]=a[c];return o};t.a=function(e){void 0===e&&(e=[]);var t=Object(i.useDispatch)(),r=Object(c.h)(),o=r.pathname,n=r.search;if(0===e.length)return t(h("",{}));var u=new URLSearchParams(n),l={};return u.forEach((function(e,t){l[t]=e})),Object(a.useEffect)((function(){t(h(o,l))}),b([o],e)),function(){return t(h("",{}))}}},769:function(e,t,r){"use strict";var o=r(0),n=r.n(o),a=r(160),c=r(360),i=r.n(c),u=r(54),l=r(624),s=r(20);t.a=function(){var e=Object(s.a)();return n.a.createElement("div",{className:"pf-u-mb-md"},n.a.createElement(i.a,{className:"pf-u-mr-sm"}),n.a.createElement(a.a,{variant:"link",component:function(){return n.a.createElement(l.a,{pathname:"/products"},e(u.a.backToProducts))}}))}},780:function(e,t,r){"use strict";var o=r(0);t.a=function(){var e=Object(o.useRef)(!1);return Object(o.useEffect)((function(){return e.current=!0,function(){return e.current=!1}}),[]),e}},920:function(e,t,r){"use strict";r.r(t);var o=r(117),n=r.n(o),a=r(165),c=r.n(a),i=r(0),u=r.n(i),l=r(21),s=r(97),f=r(16),p=r.n(f),d=r(119),m=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],c=0,i=a.length;c<i;c++,n++)o[n]=a[c];return o},h=r(643),b=r(167),y=r(132),v=r(98),O=r(762),P=r(9),g=r(226),j=r(50),I=r(780),E=r(223),R=r(638),w=r(628),F=r(769);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=function(e){var t=e.fromProducts,r=e.title,o=e.description;return u.a.createElement(R.a,{schema:{fields:[{component:w.b.TOP_TOOLBAR,breadcrumbs:!t,key:"portfolio-top-toolbar",fields:[{component:F.a,key:"back-to-products",hidden:!t},{component:w.b.TOP_TOOLBAR_TITLE,key:"portfolio-toolbar-title",title:r,description:o}]}]}})};D.propTypes={title:p.a.node,description:p.a.node,fromProducts:p.a.bool};var C=Object(i.lazy)((function(){return Promise.all([r.e(0),r.e(2),r.e(3),r.e(63)]).then(r.bind(null,914))})),T=Object(i.lazy)((function(){return Promise.all([r.e(0),r.e(7),r.e(52)]).then(r.bind(null,909))})),A=Object(i.lazy)((function(){return Promise.all([r.e(0),r.e(2),r.e(3),r.e(13)]).then(r.bind(null,913))})),L={selectedItems:[],firstSelectedProduct:void 0,removeInProgress:!1,filterValue:"",copyInProgress:!1,isFetching:!0,isFiltering:!1},V=Object(y.a)((function(e,t,r,o){r(!0),t(Object(b.f)(e,o)).then((function(){return r(!1)}))}),1e3),_=function(e,t){var r,o,n=t.type,a=t.payload,c=void 0===a?{}:a;return{selectItem:S(S({},e),{},{selectedItems:(r=e.selectedItems,o=c.selectedItem,r.includes(o)?m(r.slice(0,r.indexOf(o)),r.slice(r.indexOf(o)+1)):m(r,[o])),firstSelectedProduct:c.product||e.firstSelectedProduct}),setRemoveInProgress:S(S({},e),{},{removeInProgress:c}),removeSucessfull:S(S({},e),{},{selectedItems:[],removeInProgress:!1}),setFilterValue:S(S({},e),{},{filterValue:c,isFiltering:!0}),setCopyInProgress:S(S({},e),{},{copyInProgress:c}),setIsFetching:S(S({},e),{},{isFetching:c}),setFilteringFlag:S(S({},e),{},{isFiltering:c})}[n]};t.default=function(){var e,t=Object(E.a)(),r=Object(i.useReducer)(_,S(S({},L),{},{filterValue:(null==t||null===(e=t.portfolioItems)||void 0===e?void 0:e.filter)||""})),o=n()(r,2),a=o[0],c=o[1],f=Object(v.a)(["portfolio","from-products"]),p=n()(f,1)[0],m=p.portfolio,y=p["from-products"],R=Object(s.i)(P.y).url,w=Object(s.g)(),F=Object(l.useDispatch)(),k=Object(I.a)(),N=Object(l.useSelector)((function(e){var t=e.portfolioReducer;return{portfolio:t.selectedPortfolio,portfolioItem:t.portfolioItem,meta:t.portfolioItems.meta}})),x=N.portfolio,z=N.portfolioItem,B=N.meta,J=Object(O.a)([x,z]),q=function(e){return c({type:"setIsFetching",payload:!0}),Promise.all([F(Object(h.c)()),F(Object(b.i)(e)),F(Object(b.f)(e,null==t?void 0:t.portfolioItems))]).then((function(e){return k.current&&c({type:"setIsFetching",payload:!1}),e})).catch((function(){return c({type:"setIsFetching",payload:!1})}))};Object(i.useEffect)((function(){return insights.chrome.appNavClick({id:"true"===y?"products":"portfolios",secondaryNav:!0}),q(m),Object(d.d)(),function(){J(),F(Object(b.m)())}}),[]),Object(i.useEffect)((function(){!0!==k.current||a.isFetching||w.location.pathname!==P.y||(q(m),Object(d.d)())}),[m,w.location.pathname]);var U={portfolioRoute:R,addProductsRoute:"".concat(R,"/add-products"),editPortfolioRoute:"".concat(R,"/edit-portfolio"),removePortfolioRoute:"".concat(R,"/remove-portfolio"),sharePortfolioRoute:"".concat(R,"/share-portfolio"),workflowPortfolioRoute:"".concat(R,"/edit-workflow"),portfolioItemRoute:"".concat(R,"/portfolio-item")};return!1===x.metadata.user_capabilities.show?u.a.createElement(g.a,null):u.a.createElement(i.Suspense,{fallback:u.a.createElement(D,{fromProducts:"true"===y,title:x.name,description:x.description})},u.a.createElement(s.d,null,u.a.createElement(j.a,{path:U.addProductsRoute,userCapabilities:x.metadata.user_capabilities,requiredCapabilities:"update"},u.a.createElement(A,{portfolioRoute:U.portfolioRoute})),u.a.createElement(s.b,{path:U.portfolioItemRoute},u.a.createElement(T,{portfolioLoaded:!a.isFetching})),u.a.createElement(s.b,{path:U.portfolioRoute},u.a.createElement(C,{routes:U,fromProducts:"true"===y,handleFilterChange:function(e){c({type:"setFilterValue",payload:e}),V(m,F,(function(e){return c({type:"setFilteringFlag",payload:e})}),S(S({},B),{},{offset:0,filter:e}))},removeProducts:function(e){c({type:"setRemoveInProgress",payload:!0}),F(Object(b.l)(e,x.name,a.firstSelectedProduct)).then((function(){return c({type:"removeSucessfull"})})).catch((function(){return c({type:"setRemoveInProgress",payload:!1})}))},copyPortfolio:function(){return c({type:"setCopyInProgress",payload:!0}),F(Object(b.c)(m)).then((function(e){var t=e.id;return w.push({pathname:P.y,search:"?portfolio=".concat(t)})})).then((function(){return c({type:"setCopyInProgress",payload:!1})})).then((function(){return F(Object(b.g)())})).catch((function(){return c({type:"setCopyInProgress",payload:!1})}))},state:a,stateDispatch:c}))))}}}]);
//# sourceMappingURL=../sourcemaps/portfolio~91f4305a.js.map