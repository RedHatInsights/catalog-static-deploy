"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[5824],{7002:(e,t,o)=>{o.r(t),o.d(t,{default:()=>L});var r=o(29439),n=o(4942),l=o(30624),i=o.n(l),a=o(45237),c=o(334),s=o(45697),u=o.n(s),d=o(63035),p=function(e,t){for(var o=0,r=t.length,n=e.length;o<r;o++,n++)e[n]=t[o];return e},f=o(11608),m=o(89231),v=o(77503),h=o(81624),y=o(47786),P=o(52579),g=o(36722),b=o(9456),I=o(94002),w=o(20240),O=o(44058),R=o(66678),E=o(91703),F=o(21976);function k(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function Z(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?k(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):k(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var S=function(e){var t=e.fromProducts,o=e.title,r=e.description;return i().createElement(R.Z,{schema:{fields:[{component:E.H.TOP_TOOLBAR,breadcrumbs:!t,key:"portfolio-top-toolbar",fields:[{component:F.Z,key:"back-to-products",hidden:!t},{component:E.H.TOP_TOOLBAR_TITLE,key:"portfolio-toolbar-title",title:o,description:r}]}]}})};S.propTypes={title:u().node,description:u().node,fromProducts:u().bool};var j=(0,l.lazy)((function(){return Promise.all([o.e(6410),o.e(4736),o.e(7881),o.e(2642),o.e(7172),o.e(3188),o.e(5167),o.e(2183),o.e(4351),o.e(9797),o.e(6824),o.e(3452)]).then(o.bind(o,3452))})),T=(0,l.lazy)((function(){return Promise.all([o.e(6410),o.e(4736),o.e(2642),o.e(7742),o.e(8212),o.e(3814)]).then(o.bind(o,81166))})),C=(0,l.lazy)((function(){return Promise.all([o.e(6410),o.e(4736),o.e(7881),o.e(2642),o.e(7172),o.e(3188),o.e(5167),o.e(9827),o.e(2183),o.e(4351),o.e(8212),o.e(6824),o.e(4056),o.e(7781)]).then(o.bind(o,55251))})),V={selectedItems:[],firstSelectedProduct:void 0,removeInProgress:!1,filterValue:"",copyInProgress:!1,isFetching:!0,isFiltering:!1},D=(0,h.Z)((function(e,t,o,r){var n;o(!0),t(null!==(n=window.catalog)&&void 0!==n&&n.standalone?(0,v.cP)(e,r):(0,m.cP)(e,r)).then((function(){return o(!1)}))}),1e3),_=function(e,t){var o,r,n=t.type,l=t.payload,i=void 0===l?{}:l;return{selectItem:Z(Z({},e),{},{selectedItems:(o=e.selectedItems,r=i.selectedItem,o.includes(r)?p(p([],o.slice(0,o.indexOf(r))),o.slice(o.indexOf(r)+1)):p(p([],o),[r])),firstSelectedProduct:i.product||e.firstSelectedProduct}),setRemoveInProgress:Z(Z({},e),{},{removeInProgress:i}),removeSuccessful:Z(Z({},e),{},{selectedItems:[],removeInProgress:!1}),setFilterValue:Z(Z({},e),{},{filterValue:i,isFiltering:!0}),setCopyInProgress:Z(Z({},e),{},{copyInProgress:i}),setIsFetching:Z(Z({},e),{},{isFetching:i}),setFilteringFlag:Z(Z({},e),{},{isFiltering:i})}[n]};const L=function(){var e,t,o,n,s=(0,O.Z)(),u=(0,l.useReducer)(_,Z(Z({},V),{},{filterValue:(null==s||null===(e=s.portfolioItems)||void 0===e?void 0:e.filter)||""})),p=(0,r.Z)(u,2),h=p[0],R=p[1],E=(0,y.Z)(["portfolio","from-products"]),F=(0,r.Z)(E,1)[0],k=F.portfolio,L=F["from-products"],q=(0,c.useRouteMatch)(g.hT).url,z=(0,c.useHistory)(),B=(0,a.useDispatch)(),H=(0,w.Z)(),x=(0,a.useSelector)((function(e){var t=e.portfolioReducer;return{portfolio:t.selectedPortfolio,portfolioItem:t.portfolioItem,meta:t.portfolioItems.meta}})),A=x.portfolio,M=x.portfolioItem,N=x.meta,Y=(0,P.Z)([A,M]),G=function(e){var t,o,r,n,l;return R({type:"setIsFetching",payload:!0}),Promise.all([B((null!==(t=window.catalog)&&void 0!==t&&t.standalone,(0,f.dw)())),B(null!==(o=window)&&void 0!==o&&null!==(r=o.catalog)&&void 0!==r&&r.standalone?(0,v.al)(e):(0,m.al)(e)),B(null!==(n=window)&&void 0!==n&&null!==(l=n.catalog)&&void 0!==l&&l.standalone?(0,v.cP)(e,null==s?void 0:s.portfolioItems):(0,m.cP)(e,null==s?void 0:s.portfolioItems))]).then((function(e){return H.current&&R({type:"setIsFetching",payload:!1}),e})).catch((function(){return R({type:"setIsFetching",payload:!1})}))};(0,l.useEffect)((function(){return G(k),(0,d.k3)(),function(){var e;Y(),B(null!==(e=window.catalog)&&void 0!==e&&e.standalone?(0,v.So)():(0,m.So)())}}),[]),(0,l.useEffect)((function(){!0!==H.current||h.isFetching||z.location.pathname!==g.hT||(G(k),(0,d.k3)())}),[k,z.location.pathname]);var J={portfolioRoute:q,addProductsRoute:"".concat(q,"/add-products"),editPortfolioRoute:"".concat(q,"/edit-portfolio"),removePortfolioRoute:"".concat(q,"/remove-portfolio"),sharePortfolioRoute:"".concat(q,"/share-portfolio"),workflowPortfolioRoute:"".concat(q,"/edit-workflow"),portfolioItemRoute:"".concat(q,"/portfolio-item")};return!1===(null===(t=A.metadata)||void 0===t||null===(o=t.user_capabilities)||void 0===o?void 0:o.show)?i().createElement(b.M,null):i().createElement(l.Suspense,{fallback:i().createElement(S,{fromProducts:"true"===L,title:A.name,description:A.description})},i().createElement(c.Switch,null,i().createElement(I.Z,{path:J.addProductsRoute,userCapabilities:null===(n=A.metadata)||void 0===n?void 0:n.user_capabilities,requiredCapabilities:"update"},i().createElement(C,{portfolioRoute:J.portfolioRoute})),i().createElement(c.Route,{path:J.portfolioItemRoute},i().createElement(T,{portfolioLoaded:!(null!=h&&h.isFetching)})),i().createElement(c.Route,{path:J.portfolioRoute},i().createElement(j,{routes:J,fromProducts:"true"===L,handleFilterChange:function(e){R({type:"setFilterValue",payload:e}),D(k,B,(function(e){return R({type:"setFilteringFlag",payload:e})}),Z(Z({},N),{},{offset:0,filter:e}))},removeProducts:function(e){return function(e){var t;R({type:"setRemoveInProgress",payload:!0}),B(null!==(t=window.catalog)&&void 0!==t&&t.standalone?(0,v.qy)(e,A.name,h.firstSelectedProduct):(0,m.qy)(e,A.name,h.firstSelectedProduct)).then((function(){return R({type:"removeSucessfull"})})).catch((function(){return R({type:"setRemoveInProgress",payload:!1})}))}(e)},copyPortfolio:function(){var e;return R({type:"setCopyInProgress",payload:!0}),B(null!==(e=window.catalog)&&void 0!==e&&e.standalone?(0,v.Yh)(k):(0,m.Yh)(k)).then((function(e){var t=e.id;return z.push({pathname:g.hT,search:"?portfolio=".concat(t)})})).then((function(){return R({type:"setCopyInProgress",payload:!1})})).then((function(){var e;return B(null!==(e=window.catalog)&&void 0!==e&&e.standalone?v.eV:m.eV)})).catch((function(){return R({type:"setCopyInProgress",payload:!1})}))},state:h,stateDispatch:R}))))}},21976:(e,t,o)=>{o.d(t,{Z:()=>u});var r=o(30624),n=o.n(r),l=o(57849),i=o(5866),a=o(64466),c=o(20697),s=o(23349);const u=function(){var e=(0,s.Z)();return n().createElement("div",{className:"pf-u-mb-md"},n().createElement(i.ZP,{className:"pf-u-mr-sm"}),n().createElement(l.Button,{variant:"link",ouiaId:"back-to-products",component:function(){return n().createElement(c.Z,{pathname:"/products"},e(a.Z.backToProducts))}}))}}}]);
//# sourceMappingURL=../sourcemaps/portfolio.86862393b5cc39066f097e6b69d1f8ae.js.map