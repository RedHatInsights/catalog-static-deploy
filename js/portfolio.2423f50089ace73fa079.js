"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[5824],{7002:(e,t,o)=>{o.r(t),o.d(t,{default:()=>_});var r=o(29439),n=o(4942),i=o(30624),c=o.n(i),l=o(45237),s=o(334),a=o(45697),u=o.n(a),p=o(63035),f=function(e,t){for(var o=0,r=t.length,n=e.length;o<r;o++,n++)e[n]=t[o];return e},d=o(11608),m=o(89231),h=o(81624),y=o(47786),P=o(52579),g=o(36722),v=o(9456),b=o(94002),I=o(20240),O=o(44058),R=o(66678),E=o(91703),F=o(21976);function k(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function Z(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?k(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):k(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var w=function(e){var t=e.fromProducts,o=e.title,r=e.description;return c().createElement(R.Z,{schema:{fields:[{component:E.H.TOP_TOOLBAR,breadcrumbs:!t,key:"portfolio-top-toolbar",fields:[{component:F.Z,key:"back-to-products",hidden:!t},{component:E.H.TOP_TOOLBAR_TITLE,key:"portfolio-toolbar-title",title:o,description:r}]}]}})};w.propTypes={title:u().node,description:u().node,fromProducts:u().bool};var S=(0,i.lazy)((function(){return Promise.all([o.e(6410),o.e(4736),o.e(7881),o.e(2642),o.e(7172),o.e(3188),o.e(5167),o.e(2183),o.e(4351),o.e(9797),o.e(6824),o.e(3452)]).then(o.bind(o,3452))})),j=(0,i.lazy)((function(){return Promise.all([o.e(6410),o.e(4736),o.e(2642),o.e(7742),o.e(8212),o.e(3814)]).then(o.bind(o,81166))})),T=(0,i.lazy)((function(){return Promise.all([o.e(6410),o.e(4736),o.e(7881),o.e(2642),o.e(7172),o.e(3188),o.e(5167),o.e(2183),o.e(4351),o.e(8212),o.e(6824),o.e(4056),o.e(7781)]).then(o.bind(o,55251))})),C={selectedItems:[],firstSelectedProduct:void 0,removeInProgress:!1,filterValue:"",copyInProgress:!1,isFetching:!0,isFiltering:!1},D=(0,h.Z)((function(e,t,o,r){o(!0),t((0,m.cP)(e,r)).then((function(){return o(!1)}))}),1e3),V=function(e,t){var o,r,n=t.type,i=t.payload,c=void 0===i?{}:i;return{selectItem:Z(Z({},e),{},{selectedItems:(o=e.selectedItems,r=c.selectedItem,o.includes(r)?f(f([],o.slice(0,o.indexOf(r))),o.slice(o.indexOf(r)+1)):f(f([],o),[r])),firstSelectedProduct:c.product||e.firstSelectedProduct}),setRemoveInProgress:Z(Z({},e),{},{removeInProgress:c}),removeSucessfull:Z(Z({},e),{},{selectedItems:[],removeInProgress:!1}),setFilterValue:Z(Z({},e),{},{filterValue:c,isFiltering:!0}),setCopyInProgress:Z(Z({},e),{},{copyInProgress:c}),setIsFetching:Z(Z({},e),{},{isFetching:c}),setFilteringFlag:Z(Z({},e),{},{isFiltering:c})}[n]};const _=function(){var e,t=(0,O.Z)(),o=(0,i.useReducer)(V,Z(Z({},C),{},{filterValue:(null==t||null===(e=t.portfolioItems)||void 0===e?void 0:e.filter)||""})),n=(0,r.Z)(o,2),a=n[0],u=n[1],f=(0,y.Z)(["portfolio","from-products"]),h=(0,r.Z)(f,1)[0],R=h.portfolio,E=h["from-products"],F=(0,s.useRouteMatch)(g.hT).url,k=(0,s.useHistory)(),_=(0,l.useDispatch)(),L=(0,I.Z)(),z=(0,l.useSelector)((function(e){var t=e.portfolioReducer;return{portfolio:t.selectedPortfolio,portfolioItem:t.portfolioItem,meta:t.portfolioItems.meta}})),B=z.portfolio,H=z.portfolioItem,q=z.meta,x=(0,P.Z)([B,H]),A=function(e){return u({type:"setIsFetching",payload:!0}),Promise.all([_((0,d.dw)()),_((0,m.al)(e)),_((0,m.cP)(e,null==t?void 0:t.portfolioItems))]).then((function(e){return L.current&&u({type:"setIsFetching",payload:!1}),e})).catch((function(){return u({type:"setIsFetching",payload:!1})}))};(0,i.useEffect)((function(){return A(R),(0,p.k3)(),function(){x(),_((0,m.So)())}}),[]),(0,i.useEffect)((function(){!0!==L.current||a.isFetching||k.location.pathname!==g.hT||(A(R),(0,p.k3)())}),[R,k.location.pathname]);var M={portfolioRoute:F,addProductsRoute:"".concat(F,"/add-products"),editPortfolioRoute:"".concat(F,"/edit-portfolio"),removePortfolioRoute:"".concat(F,"/remove-portfolio"),sharePortfolioRoute:"".concat(F,"/share-portfolio"),workflowPortfolioRoute:"".concat(F,"/edit-workflow"),portfolioItemRoute:"".concat(F,"/portfolio-item")};return!1===B.metadata.user_capabilities.show?c().createElement(v.M,null):c().createElement(i.Suspense,{fallback:c().createElement(w,{fromProducts:"true"===E,title:B.name,description:B.description})},c().createElement(s.Switch,null,c().createElement(b.Z,{path:M.addProductsRoute,userCapabilities:B.metadata.user_capabilities,requiredCapabilities:"update"},c().createElement(T,{portfolioRoute:M.portfolioRoute})),c().createElement(s.Route,{path:M.portfolioItemRoute},c().createElement(j,{portfolioLoaded:!a.isFetching})),c().createElement(s.Route,{path:M.portfolioRoute},c().createElement(S,{routes:M,fromProducts:"true"===E,handleFilterChange:function(e){u({type:"setFilterValue",payload:e}),D(R,_,(function(e){return u({type:"setFilteringFlag",payload:e})}),Z(Z({},q),{},{offset:0,filter:e}))},removeProducts:function(e){u({type:"setRemoveInProgress",payload:!0}),_((0,m.qy)(e,B.name,a.firstSelectedProduct)).then((function(){return u({type:"removeSucessfull"})})).catch((function(){return u({type:"setRemoveInProgress",payload:!1})}))},copyPortfolio:function(){return u({type:"setCopyInProgress",payload:!0}),_((0,m.Yh)(R)).then((function(e){var t=e.id;return k.push({pathname:g.hT,search:"?portfolio=".concat(t)})})).then((function(){return u({type:"setCopyInProgress",payload:!1})})).then((function(){return _((0,m.eV)())})).catch((function(){return u({type:"setCopyInProgress",payload:!1})}))},state:a,stateDispatch:u}))))}},21976:(e,t,o)=>{o.d(t,{Z:()=>u});var r=o(30624),n=o.n(r),i=o(95995),c=o(5866),l=o(64466),s=o(20697),a=o(23349);const u=function(){var e=(0,a.Z)();return n().createElement("div",{className:"pf-u-mb-md"},n().createElement(c.ZP,{className:"pf-u-mr-sm"}),n().createElement(i.Button,{variant:"link",ouiaId:"back-to-products",component:function(){return n().createElement(s.Z,{pathname:"/products"},e(l.Z.backToProducts))}}))}}}]);
//# sourceMappingURL=../sourcemaps/portfolio.857016561d924ac48dec725389a56f3c.js.map