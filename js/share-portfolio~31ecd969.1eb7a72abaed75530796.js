(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{645:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},647:function(e,t,n){"use strict";var r=n(664),o=n.n(r);function i(e){var t=null,n=null,r=new Promise((function(e,r){t=e,n=r}));return e&&e.then((function(e){t&&t(e)}),(function(e){n&&n(e)})),{promise:r,resolve:function(e){t&&t(e)},reject:function(e){n&&n(e)},cancel:function(){t=null,n=null}}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c={key:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},onlyResolvesLast:!0},a=function(){function e(e){this.config=e,this.debounceSingleton=null,this.debounceCache={}}return e.prototype._createDebouncedFunction=function(){var e,t,n=o()(this.config.func,this.config.wait,this.config.options);return this.config.options.onlyResolvesLast&&(e=n,t=null,n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t&&t();var o=e.apply(void 0,n),u=i(o),c=u.promise,a=u.cancel;return t=a,c}),{func:n}},e.prototype.getDebouncedFunction=function(e){var t,n=(t=this.config.options).key.apply(t,e);return null==n?(this.debounceSingleton||(this.debounceSingleton=this._createDebouncedFunction()),this.debounceSingleton):(this.debounceCache[n]||(this.debounceCache[n]=this._createDebouncedFunction()),this.debounceCache[n])},e}();t.a=function(e,t,n){var r=u({},c,n),o=new a({func:e,wait:t,options:r});return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.getDebouncedFunction(e).func;return n.apply(void 0,e)}}},648:function(e,t,n){"use strict";var r=n(647);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onlyResolvesLast:!1};return Object(r.a)(e,t,n)}},664:function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){return"function"==typeof e?e():e}function i(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=void 0,c=void 0,a=void 0,s=[];return function(){var p,f=o(t),m=(new Date).getTime(),h=!u||m-u>f;u=m;for(var b=arguments.length,d=Array(b),v=0;v<b;v++)d[v]=arguments[v];if(h&&n.leading)return n.accumulate?Promise.resolve(e.call(this,[d])).then((function(e){return e[0]})):Promise.resolve(e.call.apply(e,[this].concat(d)));if(c?clearTimeout(a):c=i(),s.push(d),a=setTimeout(l.bind(this),f),n.accumulate){var y=(p=s.length-1,{v:c.promise.then((function(e){return e[p]}))});if("object"===(void 0===y?"undefined":r(y)))return y.v}return c.promise};function l(){var t=c;clearTimeout(a),Promise.resolve(n.accumulate?e.call(this,s):e.apply(this,s[s.length-1])).then(t.resolve,t.reject),s=[],c=null}}},667:function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},670:function(e,t,n){"use strict";var r=n(2),o=n.n(r),i=n(667),u=n.n(i),c=n(61);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return"string"==typeof e?e.split("?")[0]:"object"===u()(e)?s(s({},e),{},{search:void 0}):e};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.removeSearch,n=e.keepHash,r=Object(c.g)();return s(s({},r),{},{push:function(e){var o=e;return n&&r.location.hash.length>0&&(o="object"===u()(o)?s(s({},o),{},{hash:r.location.hash}):"".concat(o).concat(r.location.hash)),t?r.push(l(o)):r.push(o)}})}},773:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),i=n(38),u=n.n(i),c=n(0),a=n.n(c),s=n(1),l=n.n(s),p=n(674),f=n(33),m=n(585),h=n(74),b=n(44),d=n(590),v=n(591),y=n(21),g=n.n(y),O=function(e,t,n,r,o,i){var u=r?function(e,t){return[{component:"sub-form",description:"Invite group",name:"new_share",key:"1",fields:[{name:"group-selection",component:"share-group-select",inputName:"group_uuid",selectName:"permissions",loadOptions:e,isSearchable:!0,permissions:t}]}]}(t,n):[],c=e.map((function(e){return function(e,t){return{component:"sub-form",name:"".concat(e.group_name),key:"".concat(e.group_name),fields:[{name:"".concat(e.group_name),label:"".concat(e.group_name),component:"share-group-edit",options:t,isClearable:!0}]}}(e,n)})),a=o?[{component:"sub-form",description:"Groups with access",name:"share_list",key:"share_list",fields:c}]:[];return{fields:[].concat(g()(u),g()(a))}},j=n(659),S=n(62),w=n.n(S),P=n(112),_=n.n(P),k=n(111),D=n(12),E=Object(k.a)(),x=Object(k.e)();function C(e){return T.apply(this,arguments)}function T(){return(T=_()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("".concat(D.c,"/portfolios/").concat(t,"/share_info"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=n(4);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e){return{type:I.S,payload:(t=F({},e),n={permissions:t.permissions.split(","),group_uuids:[t.group_uuid]},x.sharePortfolio(t.id,n)),meta:{notifications:{fulfilled:{variant:"success",title:"Success sharing portfolio",description:"The portfolio was shared successfully."}}}};var t,n},N=function(e){return{type:I.U,payload:(t=F({},e),n={permissions:t.permissions,group_uuids:[t.group_uuid]},x.unsharePortfolio(t.id,n)),meta:{notifications:{fulfilled:{variant:"success",title:"Success unsharing portfolio",description:"The portfolio was unshared successfully."}}}};var t,n},U=n(77);Object(k.g)();var Q=n(78),A=n(670),H=n(160);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){var t,n,r,i,s,l,y,g,S=e.closeUrl,w=e.removeQuery,P=e.viewState,_=e.portfolioName,E=void 0===_?function(){return""}:_,x=Object(f.useDispatch)(),T=Object(A.a)({removeQuery:w,keepHash:!0}).push,R=Object(Q.a)(["portfolio"]),F=u()(R,2),J=F[0].portfolio,G=F[1],M=Object(c.useState)(!0),V=u()(M,2),z=V[0],B=V[1],K=Object(f.useSelector)((function(e){return e.portfolioReducer.selectedPortfolio})),W=Object(f.useSelector)((function(e){return{shareInfo:e.shareReducer.shareInfo}})).shareInfo;Object(c.useEffect)((function(){var e;B(!0),x((e=J,{type:I.C,payload:C(e)})).then((function(){return B(!1)})).catch((function(){return B(!1)}))}),[]);var X=function(){return T({pathname:S,search:G})};if(!1===(null==K||null===(t=K.metadata)||void 0===t||null===(n=t.user_capabilities)||void 0===n?void 0:n.share)&&!1===(null==K||null===(r=K.metadata)||void 0===r||null===(i=r.user_capabilities)||void 0===i?void 0:i.unshare))return a.a.createElement(H.a,null);return a.a.createElement(m.Modal,{title:"Share portfolio",isOpen:!0,isSmall:!0,onClose:X},z&&a.a.createElement(U.g,null),!z&&a.a.createElement(d.Stack,{gutter:"md"},a.a.createElement(v.StackItem,null,a.a.createElement(h.TextContent,null,a.a.createElement(b.Text,null,"Share ",a.a.createElement("strong",null,E(J))," portfolio"))),a.a.createElement(v.StackItem,null,a.a.createElement(p.b,{schema:O(W,(function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(k.a)().get("".concat(D.h,"/groups/").concat(e.length>0?"?name=".concat(e):"")).then((function(e){return e.data.map((function(e){var t=e.uuid;return{label:e.name,value:t}}))}))}(e)}),D.k,!1!==(null==K||null===(s=K.metadata)||void 0===s||null===(l=s.user_capabilities)||void 0===l?void 0:l.share),!1!==(null==K||null===(y=K.metadata)||void 0===y||null===(g=y.user_capabilities)||void 0===g?void 0:g.unshare)),schemaType:"default",onSubmit:function(e){var t=[];return e.group_uuid&&e.permissions&&t.push(x(L(q({id:J},e)))),W.forEach((function(n){var r=n.permissions.sort().join(",");if(e[n.group_name]!==r)if(e[n.group_name])n.permissions.length>e[n.group_name].split(",").length?t.push(x(N({id:J,permissions:["update"],group_uuid:n.group_uuid}))):t.push(x(L({id:J,permissions:e[n.group_name],group_uuid:n.group_uuid})));else{var o=n.permissions.filter((function(e){return D.l.indexOf(e)>-1}));t.push(x(N({id:J,permissions:o,group_uuid:n.group_uuid})))}})),T({pathname:S,search:G}),Promise.all(t).then((function(){return x(Object(j.g)(P))}))},onCancel:X,validate:function(e){var t={};return e.group_uuid&&!e.permissions&&(t.permissions="Select the share permissions"),e.permissions&&!e.group_uuid&&(t.group_uuid="Select a group"),t},initialValues:q(q({},K),W.map((function(e){var t=e.permissions.filter((function(e){return D.l.indexOf(e)>-1})),n=e.group_name,r=D.k.find((function(e){return e.value===t.sort().join(",")}));return o()({},n,r?r.value:"Unknown")})).reduce((function(e,t){return q(q({},e),t)}),{})),formContainer:"modal",buttonsLabels:{submitLabel:"Apply"}}))))};G.propTypes={closeUrl:l.a.string.isRequired,removeQuery:l.a.bool,portfolioName:l.a.func,viewState:l.a.shape({count:l.a.number,limit:l.a.number,offset:l.a.number,filter:l.a.string})};t.default=G}}]);
//# sourceMappingURL=../sourcemaps/share-portfolio~31ecd969.js.map