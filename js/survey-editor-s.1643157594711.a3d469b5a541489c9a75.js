(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[8],{90331:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Q});var n,a=r(71002),i=r(93433),u=r(29439),l=r(87462),o=r(45987),s=r(4942),c=r(30624),p=r.n(c),d=r(45697),f=r.n(d),v=r(334),m=r(96354),b=r(13969),h=r(14512),D=r(67463),y=r(22437),E=r(35388),Z=r(8896),g=r(23811),O=r(80887),S=r(77221),P=r(12282),T=r(42697),V=r(14494),R=r(83215),_=r(30137),C=r(64124),I=r(47126),A=["propertyValidation","children"],w=["label","initialValueOptions","value","fieldId","innerProps","onChange"],j=["validate"],U=["type"],G=["validate"],k=["type"],q=["getSchema","isValid"];function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=X(X({},h.uD.Pv),{},{propertyName:"isSubstitution",label:"Substitution"}),L=function(e){var t=e.propertyValidation.message,r=e.children,n=(0,o.Z)(e,A);return p().createElement(g.c,(0,l.Z)({helperTextInvalid:t,validated:t?"error":"default"},n),r)};L.propTypes={propertyValidation:f().shape({message:f().string}),children:f().oneOfType([f().node,f().arrayOf(f().node)])},L.defaultProps={propertyValidation:{}};var M=function(e){var t=e.label,r=e.initialValueOptions,n=e.value,s=e.fieldId,d=e.innerProps.propertyValidation,f=e.onChange,v=(0,o.Z)(e,w),m=(0,c.useState)((0,i.Z)(r)),b=(0,u.Z)(m,2),h=b[0],D=b[1],y=(0,c.useState)(!1),E=(0,u.Z)(y,2),Z=E[0],g=E[1];return h.length>0?p().createElement(L,{label:t,fieldId:s,propertyValidation:d},p().createElement(O.P,{variant:"typeahead",onToggle:g,isOpen:Z,typeAheadAriaLabel:"Select initial value",onSelect:function(e,t){f(t),g(!1)},placeholderText:"Select initial value",isCreatable:!0,onCreateOption:function(e){return D((function(t){return[].concat((0,i.Z)(t),[e])}))},selections:[n]},h.map((function(e){return p().createElement(S.SelectOption,{key:e,value:e})})))):p().createElement(c.Fragment,null,p().createElement(L,{label:t,fieldId:s,propertyValidation:d},p().createElement(P.oi,(0,l.Z)({id:s,value:void 0===(0,a.Z)(n)?"":n.toString(),onChange:f},v))))};M.propTypes={label:f().oneOfType([f().string]).isRequired,value:f().any,fieldId:f().string.isRequired,innerProps:f().shape({propertyValidation:f().shape({message:f().string})}).isRequired,onChange:f().func,initialValueOptions:f().arrayOf(f().string)},M.defaultProps={onChange:function(){},value:"",initialValueOptions:[]};var N=X(X({},h.oU),{},{input:M}),Y=(n={},(0,s.Z)(n,m.Z.TEXT_FIELD,{attributes:[h.uD.GP,h.uD.bw,h.uD.l7,h.uD.Pv,h.uD.l,h.uD.aO,F]}),(0,s.Z)(n,m.Z.CHECKBOX,{attributes:[h.uD.GP,h.uD.Pv,h.uD.JY,h.uD.aO]}),(0,s.Z)(n,m.Z.SELECT,{attributes:[h.uD.JY,h.uD.GP,h.uD.Pv,h.uD.l7,h.uD.bw,h.uD.aO,F]}),(0,s.Z)(n,m.Z.DATE_PICKER,{attributes:[h.uD.GP,h.uD.ol,h.uD.SI,h.uD.fe,h.uD.u5,h.uD.aO,F]}),(0,s.Z)(n,m.Z.PLAIN_TEXT,{attributes:[h.uD.m3,F]}),(0,s.Z)(n,m.Z.RADIO,{attributes:[h.uD.GP,h.uD.Pv,h.uD.JY,h.uD.aO]}),(0,s.Z)(n,m.Z.SWITCH,{attributes:[h.uD.GP,h.uD.l,h.uD.Pv,h.uD.aO]}),(0,s.Z)(n,m.Z.TEXTAREA,{attributes:[h.uD.GP,h.uD.bw,h.uD.l,h.uD.Pv,h.uD.aO,F]}),n);Y["select-field"]=Y[m.Z.SELECT],Y["textarea-field"]=Y[m.Z.TEXTAREA];var H={componentMapper:X({},_.De),builderMapper:X({},h.tm),pickerMapper:X(X({},h.ts),{},{"select-field":h.ts[m.Z.SELECT],"textarea-field":h.ts[m.Z.TEXTAREA]}),propertiesMapper:N,componentProperties:Y},J=function(e){var t=X({},e);return t.fields=t.fields.map((function(e){var t=e.validate,r=(0,o.Z)(e,j);return t?X(X({},r),{},{validate:t.map((function(e){var t=e.type;return X(X({},(0,o.Z)(e,U)),{},{type:_.NQ[t]||t})}))}):r})),t},B=function(e){return p().createElement(b.Z,e)},K=function(e){var t=e.closeUrl,r=e.search,n=e.portfolioItem,a=(0,c.useState)(),i=(0,u.Z)(a,2),s=i[0],d=i[1],f=(0,c.useState)(!1),m=(0,u.Z)(f,2),b=m[0],g=m[1],O=(0,c.useState)(),S=(0,u.Z)(O,2),P=S[0],_=S[1],A=(0,c.useState)(),w=(0,u.Z)(A,2),j=w[0],U=w[1],x=(0,c.useState)(0),F=(0,u.Z)(x,2),L=F[0],M=F[1],N=(0,V.I0)(),Y=(0,v.useHistory)().push,K=(0,V.v9)((function(e){return e.breadcrumbsReducer.fragments})),Q=function(){return(0,y.Hx)().get("".concat(E.Vs,"/portfolio_items/").concat(n.id,"/service_plans/?extra=true")).then((function(e){var t,r,n=e?e[0]:void 0;U(n);var a=null==n||null===(t=n.schema)||void 0===t?void 0:t.schema,i=null==n||null===(r=n.extra_data)||void 0===r?void 0:r.base_schema,u=J(null==i?void 0:i.schema);return _(u),J(a)})).then((function(e){d(e),g(!1)}))};(0,c.useEffect)((function(){Q()}),[]);var W=function(e){return g(!0),function(e){return I.iu("".concat(j.id),{modified:{schema:e}})}(function(e){var t=X({},e);return t.fields=t.fields.map((function(e){var t=e.validate,r=(0,o.Z)(e,G);return t?X(X({},r),{},{validate:t.map((function(e){var t=e.type;return X(X({},(0,o.Z)(e,k)),{},{type:t!==C.Z.MAX_NUMBER_VALUE&&t!==C.Z.MIN_NUMBER_VALUE?"".concat(t,"-validator"):t})}))}):r})),t}(function(e){var t=e.fields.map((function(e){var t=e;return t.isSubstitution&&(t.isDisabled=!0,t.placeholder=e.initialValue),t}));return X(X({},e),{},{fields:t})}(e))).then((function(){return g(!1),N((0,R.wN)({variant:"success",title:"Survey of ".concat(n.name," has been modified."),dismissable:!0})),Y({pathname:t,search:r})})).catch((function(e){g(!1),N({type:"EDIT_SURVEY_REJECTED",payload:e})}))};return p().createElement(c.Fragment,null,s?[p().createElement(B,(0,l.Z)({},H,{key:L,schema:s,disableDrag:!0,disableAdd:!0,schemaTemplate:P,mode:"subset",openEditor:!0}),(function(e){var a=e.getSchema,i=e.isValid,u=(0,o.Z)(e,q);return p().createElement(c.Fragment,null,p().createElement(T.X,{key:"survey-editor-toolbar",handleSaveSurvey:function(){return W(a())},isValid:i,closeUrl:t,search:r,isFetching:b||!s,modified:null==j?void 0:j.modified,breadcrumbfragments:K,handleResetSurvey:function(){return e=j.id,d(void 0),void I.GY(e).then(Q).then((function(){return M((function(e){return e+1})),N((0,R.wN)({variant:"success",title:"Survey of ".concat(n.name," has been restored."),dismissable:!0}))}));var e}}),p().createElement(h.vU,u),";")}))]:p().createElement(c.Fragment,null,p().createElement(T.X,{handleSaveSurvey:W,closeUrl:t,search:r,isFetching:!s||b}),p().createElement(Z.b,null,p().createElement(D.Spinner,null))))};K.propTypes={closeUrl:f().string.isRequired,search:f().string,portfolioItem:f().shape({id:f().string.isRequired,name:f().string.isRequired}).isRequired,portfolio:f().object.isRequired};const Q=K},47126:(e,t,r)=>{"use strict";r.d(t,{Gq:()=>u,iu:()=>l,F_:()=>o,GY:()=>s});var n=r(22437),a=r(35388),i=(0,n.Hx)(),u=function(e){return i.get(a.Vs+"/portfolio_items/"+e+"/service_plans/?extra=true")},l=function(e,t){return i.patch(a.Vs+"/service_plans/"+e+"/",t)},o=function(e,t){return void 0===t&&(t={}),i.post(a.Vs+"/service_plans/",e)},s=function(e,t){return i.post(a.Vs+"$/service_plans/"+e+"/reset/")}},11452:()=>{},93818:()=>{},94498:()=>{},28992:()=>{},36974:()=>{},56024:()=>{},43390:()=>{}}]);
//# sourceMappingURL=../sourcemaps/survey-editor-s.c656d8a19c71fc36333fded5371c34ac.js.map