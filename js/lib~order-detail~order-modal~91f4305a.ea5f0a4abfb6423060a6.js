(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{566:function(e,t,r){"use strict";var o=(0,r(33).defineMessages)({orderedBy:{id:"orders.common.orderedBy",defaultMessage:"Ordered by {owner}"},orderedByLabel:{id:"orders.approval.orderedBy",defaultMessage:"Ordered by"},lastUpdated:{id:"orders.common.lastUpdated",defaultMessage:"Last updated"},compositeTitle:{id:"orders.common.compositeTitle",defaultMessage:"{name} - Order # {id}"},detailTitle:{id:"orders.detail.title",defaultMessage:"Order ID {id}"},orderSuccess:{id:"orders.notification.success",defaultMessage:"You can track the progress of Order # {id} in your <link>Orders</link> page."},noOrdersTitle:{id:"orders.list.empty.title",defaultMessage:"No orders"},noOrdersDescription:{id:"orders.list.empty.description",defaultMessage:"No orders have been created."},noApprovalRequests:{id:"orders.approval.no-requests",defaultMessage:"We were unable to find any approval requests for this order."},creatingApprovalRequest:{id:"orders.approval.creating",defaultMessage:"Creating approval request"},approvalTitle:{id:"orders.approval.title",defaultMessage:"Summary"},approvalDetail:{id:"orders.approval.view-detail",defaultMessage:"View this order's approval request details"},approvalCreated:{id:"orders.approval.details.created",defaultMessage:"Request created"},approvalReason:{id:"orders.approval.details.reason",defaultMessage:"Approval reason"},approvalCompleted:{id:"orders.approval.details.completed",defaultMessage:"Completed at"},orderDetails:{id:"orders.common.details",defaultMessage:"Order details"},menuApproval:{id:"orders.menu.approval",defaultMessage:"Approval"},menuLifecycle:{id:"orders.menu.lifecycle",defaultMessage:"Lifecycle"},menuSteps:{id:"orders.menu.steps",defaultMessage:"Order steps"},objectsNotFound:{id:"order.detail.not-found",defaultMessage:"The {objects} for this order {count, plural, one {is} other {are}} not available"},orderID:{id:"orders.order.detail.ID",defaultMessage:"Order ID"},orderParameters:{id:"orders.order.detail.parameters",defaultMessage:"Order parameters"},orderProgressMessages:{id:"orders.order.detail.messages",defaultMessage:"Progress messages"},lifecycleLink:{id:"orders.order.lifecicle.link",defaultMessage:"Manage product"},cancelOrder:{id:"orders.actions.cancel",defaultMessage:"Cancel order"},keepOrder:{id:"orders.actions.keep",defaultMessage:"Keep order"},cancelDescription:{id:"orders.cancel.description",defaultMessage:"Are you sure you want to cancel {name}?"},backToOrders:{id:"orders.toolbar.backLink",defaultMessage:"Back to orders"},orderDate:{id:"orders.approval.order-date",defaultMessage:"Order date"},approvalParameters:{id:"orders.approval.parameters",defaultMessage:"Parameters"},activity:{id:"orders.approval.activity",defaultMessage:"Activity"}});t.a=o},619:function(e,t,r){"use strict";r.d(t,"e",(function(){return x})),r.d(t,"f",(function(){return G})),r.d(t,"a",(function(){return Y})),r.d(t,"d",(function(){return K})),r.d(t,"c",(function(){return z})),r.d(t,"b",(function(){return W}));var o=r(19),a=r.n(o),n=r(15),c=r.n(n),i=r(1),s=r.n(i),d=r(0),u=r.n(d),l=r(101),p=r(2),f=r(14),m=r.n(f),g=r(26),v=r.n(g),y=r(36),b=r(6),O=r(28);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _=Object(y.c)(),I=(Object(y.d)(),Object(y.g)()),M=Object(y.a)(),P=Object(y.b)();function w(e){return I.listServicePlans(e)}function D(e){return E.apply(this,arguments)}function E(){return(E=v()(m.a.mark((function e(t){var r,o,n,c,i,s,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.service_parameters,o=r.providerControlParameters,n=a()(r,["providerControlParameters"]),c=a()(t,["service_parameters"]),e.next=3,_.createOrder();case 3:return i=e.sent,(s={}).count=1,s=j(j(j({},s),c),{},{service_parameters:n,provider_control_parameters:o||{}}),e.next=9,_.addToOrder(i.id,s);case 9:return d=e.sent,e.abrupt("return",_.submitOrder(i.id).then((function(e){return j(j({},e),{},{orderItem:d})})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function(e){return M.get("".concat(b.c,"/order_items?").concat(e.map((function(e){return"filter[order_id][]=".concat(e)})).join("&")))},R=function(e){return M.get("".concat(b.c,"/portfolio_items?").concat(e.map((function(e){return"filter[id][]=".concat(e)})).join("&")))},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.a;return M.get("".concat(b.c,"/orders?").concat(e,"&limit=").concat(t.limit,"&offset=").concat(t.offset)).then((function(e){return q(e.data.map((function(e){return e.id}))).then((function(t){return R(t.data.map((function(e){return e.portfolio_item_id}))).then((function(r){return j(j({portfolioItems:r},e),{},{data:e.data.map((function(e){return j(j({},e),{},{orderItems:t.data.filter((function(t){return t.order_id===e.id}))})}))})}))}))}))};var L=function(e){return M.get("".concat(b.c,"/order_items/").concat(e,"/approval_requests")).then((function(e){var t=e.data.map((function(e){var t,r,o=e.approval_request_ref;return t=o,P.post("".concat(b.a,"/graphql"),{query:(r=t,'query {\n  requests(id: "'.concat(r,'") {\n    group_name\n    state\n    actions {\n      created_at\n    }\n  }\n}'))},{"x-rh-persona":"approval/requester"}).then((function(e){return e.data.requests}))}));return Promise.all(t).then((function(e){var t;return{data:(null==e||null===(t=e[0])||void 0===t?void 0:t.map((function(e){var t=e.actions;return j(j({},a()(e,["actions"])),{},{updated:(null==t?void 0:t.length)>0?t.pop().created_at:void 0})})))||[]}}))}))},F=r(4),N=r.n(F),C=r(65),T=r(11),S=r(566),A=r(23),B=function(e){var t=e.id,r=e.dispatch,o=e.portfolioItemId,a=e.portfolioId,n=e.platformId,c=e.orderItemId;return Object(A.a)()(S.a.orderSuccess,{id:t,link:function(e){return u.a.createElement(C.a,{onClick:function(){return r(Object(l.clearNotifications)())},to:{pathname:T.o,search:"?order=".concat(t,"&order-item=").concat(c,"&portfolio-item=").concat(o,"&platform=").concat(n,"&portfolio=").concat(a)}},e)}})};B.propTypes={id:N.a.string.isRequired,dispatch:N.a.func.isRequired,portfolioItemId:N.a.string.isRequired,portfolioId:N.a.string.isRequired,platformId:N.a.string.isRequired,orderItemId:N.a.string.isRequired};var J=B;function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=function(e){return{type:p.z,payload:w(e)}},G=function(e,t){return function(r){return r({type:p.cb,payload:D(e).then((function(e){var o=e.id,a=e.orderItem;return r(Object(l.addNotification)({variant:"success",title:"Your order has been accepted successfully",description:u.a.createElement(J,{id:o,dispatch:r,portfolioItemId:t.id,portfolioId:t.portfolio_id,platformId:t.service_offering_source_ref,orderItemId:a.id}),dismissable:!0}))}))})}},Y=function(e){return function(t,r){t({type:"".concat(p.e,"_PENDING")});var o=r().orderReducer.orderDetail;return function(e){return _.cancelOrder(e)}(e).then((function(){return o.order.state="Canceled",o.approvalRequest&&o.approvalRequest.length>0&&(o.approvalRequest[0].state="canceled"),t({type:p.V,payload:V({},o)}),o})).then((function(e){return t(Object(l.addNotification)({variant:"success",title:"Your order has been canceled successfully",description:"Order ".concat("Order #".concat(e.order.id)," was canceled."),dismissable:!0}))})).then((function(){return t({type:"".concat(p.e,"_FULFILLED")})})).catch((function(e){t({type:"".concat(p.e,"_REJECTED"),payload:e})}))}},K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.a;return function(r){var o=Object.entries(e).filter((function(e){var t=c()(e,2)[1];return t&&t.length>0})).map((function(e){var t=c()(e,2),r=t[0],o=t[1];return Array.isArray(o)?o.map((function(e){return"filter[".concat(r,"][]=").concat(e)})).join("&"):"filter[".concat(r,"][contains_i]=").concat(o)})).join("&");return t.sortBy&&(o="".concat(o,"&sort_by=").concat(t.sortBy,":").concat(t.sortDirection||"desc")),r({type:"".concat(p.i,"_PENDING")}),k(o,t).then((function(n){var c=n.portfolioItems,i=a()(n,["portfolioItems"]);return r({type:p.X,payload:c}),r({type:"".concat(p.i,"_FULFILLED"),meta:V(V({},t),{},{filter:o,filters:e,storeState:!0,stateKey:"orders"}),payload:i})})).catch((function(e){return r({type:"".concat(p.i,"_REJECTED"),payload:e})}))}},z=function(e){return function(t){return t({type:"".concat(p.V,"_PENDING")}),function(e){var t=[M.get("".concat(b.c,"/orders/").concat(e.order)),M.get("".concat(b.c,"/order_items/").concat(e["order-item"])).catch((function(e){if(404===e.status||400===e.status)return{object:"Order item",notFound:!0};throw e})),M.get("".concat(b.c,"/portfolio_items/").concat(e["portfolio-item"])).catch((function(e){if(404===e.status||400===e.status)return{object:"Product",notFound:!0};throw e}))];return t.push(e.platform&&"undefined"!==e.platform?M.get("".concat(b.i,"/sources/").concat(e.platform)).catch((function(e){if(404===e.status||400===e.status)return{object:"Platform",notFound:!0};throw e})):{object:"Platform",notFound:!0}),t.push(M.get("".concat(b.c,"/order_items/").concat(e["order-item"],"/progress_messages")).catch((function(e){if(404===e.status||400===e.status)return{};throw e}))),t.push(e.portfolio&&"undefined"!==e.portfolio?M.get("".concat(b.c,"/portfolios/").concat(e.portfolio)).catch((function(e){if(404===e.status||400===e.status)return{object:"Portfolio",notFound:!0};throw e})):{object:"Portfolio",notFound:!0}),Promise.all(t)}(e).then((function(e){var r=c()(e,7),o=r[0],a=r[1],n=r[2],i=r[3],s=r[4],d=r[5],u=r[6];return t({type:"".concat(p.V,"_FULFILLED"),payload:{order:o,orderItem:a,portfolioItem:n,platform:i,progressMessages:s,portfolio:d,approvalRequest:u}})})).catch((function(e){return t({type:"".concat(p.V,"_REJECTED"),payload:e})}))}},W=function(e){return function(t){return t({type:"".concat(p.g,"_PENDING")}),L(e).then((function(e){return t({type:"".concat(p.g,"_FULFILLED"),payload:e}),e})).catch((function(e){return t({type:"".concat(p.g,"_REJECTED"),payload:e})}))}}}}]);
//# sourceMappingURL=../sourcemaps/lib~order-detail~order-modal~91f4305a.js.map