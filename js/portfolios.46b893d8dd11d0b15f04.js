"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[2391],{92558:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ne});var o=r(22122),n=r(28481),a=r(96156),i=r(30624),l=r.n(i),c=r(45237),s=r(334),p=r(20777),u=r(48794),f=r(6202),d=r(63035),m=r(59837),y=r(7247),h=r(89231),g=r(90459),b=r(97066),v=r(62410),Z=r(95645);const E=function(e){var t=e.id,r=e.to,o=e.portfolioName,n=e.portfolio_items,a=e.headerActions,i=void 0===a?[]:a;return l().createElement(g.$h,null,l().createElement(g.Gh,null,l().createElement(b.TextContent,null,l().createElement(s.Link,{to:r,id:"portfolio-link-"+t},l().createElement(b.Text,{title:o,className:"pf-u-mb-0",component:b.TextVariants.h3},l().createElement(Z.Z,null,o))))),l().createElement(b.Badge,{isRead:!0},n),l().createElement("div",{onClick:function(e){return e.preventDefault()}},i))};var O=r(20697),P=r(36722),D=r(52587),w=r(92156),F=r(7579),C=r(56682),k=r(23349),j=r(29751),S=function(){return(S=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},_=["description"],T=function(e){var t=e.portfolioId,r=e.handleCopyPortfolio,o=e.canLinkOrderProcesses,n=e.userCapabilities,a=n.share,c=n.copy,s=n.unshare,p=n.update,u=n.destroy,f=n.set_approval,d=(0,k.Z)(),m=(0,i.useState)(!1),y=m[0],h=m[1],g=[];if((a||s)&&g.push(l().createElement(b.DropdownItem,{key:"share-portfolio-action",id:"share-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:P.Ak,preserveHash:!0},d(F.Z.share))})),c&&g.push(l().createElement(b.DropdownItem,{key:"copy-portfolio-action",id:"copy-portfolio-action",onClick:function(){return r(t)}},d(F.Z.copy))),f&&g.push(l().createElement(b.DropdownItem,{key:"workflow-portfolio-action",id:"workflow-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:P.sP,preserveHash:!0},d(F.Z.setApproval))})),p&&o){var v=d(j.Z.setOrderProcess);g.push(l().createElement(b.DropdownItem,{"aria-label":v,key:"attach-order-processes",id:"attach-order-processes",component:l().createElement(O.Z,{preserveSearch:!0,pathname:P.yI,searchParams:{portfolio:t}},v),role:"link"}))}return p&&g.push(l().createElement(b.DropdownItem,{key:"edit-portfolio-action",id:"edit-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:P.Po,preserveHash:!0},d(F.Z.edit))})),u&&g.push(l().createElement(b.DropdownItem,{key:"remove-portfolio-action",id:"remove-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:P.wN,preserveHash:!0},d(F.Z.delete))})),0===g.length?null:l().createElement(b.Dropdown,{key:"portfolio-dropdown",id:"portfolio-"+t+"-dropdown",isOpen:y,isPlain:!0,onSelect:function(){return h(!1)},position:b.DropdownPosition.right,toggle:l().createElement(b.KebabToggle,{id:"portfolio-"+t+"-toggle",onToggle:function(e){return h(e)}}),dropdownItems:g})};const R=function(e){var t=e.imageUrl,r=e.isDisabled,o=e.name,n=e.id,a=e.handleCopyPortfolio,i=e.metadata,c=i.user_capabilities,s=i.statistics,p=s.shared_groups,u=s.approval_processes,f=s.portfolio_items,d=e.canLinkOrderProcesses,m=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}(e,["imageUrl","isDisabled","name","id","handleCopyPortfolio","metadata","canLinkOrderProcesses"]),y=(0,k.Z)(),h={pathname:P.hT,search:"?portfolio="+n};return l().createElement(D.x,{isDisabled:r},l().createElement(D.r,{ouiaId:"portfolio-"+n},l().createElement(b.CardHeader,null,l().createElement(E,{id:n,to:h,portfolioName:o,portfolio_items:f||0,headerActions:l().createElement(T,{portfolioId:n,userCapabilities:c,handleCopyPortfolio:a,canLinkOrderProcesses:d})})),l().createElement(w.k,null,l().createElement(b.TextContent,{className:"pf-u-mb-md"},l().createElement(b.Text,{component:b.TextVariants.small,className:"pf-u-mb-0"},"Last updated ",l().createElement(v.Z,{date:m.updated_at||m.created_at,type:"relative"})),l().createElement(b.Text,{component:b.TextVariants.small},"by ",m.owner)),l().createElement(g.ZP,S({},S({name:o,imageUrl:t},m),{toDisplay:_}))),l().createElement(b.CardFooter,null,u&&u>0&&l().createElement(b.Label,{variant:"filled",color:"grey"},y(C.Z.approvalProcessSet))," ",p&&p>0&&l().createElement(b.Label,{variant:"filled",color:"grey"},y(C.Z.shared)))))};var I=r(33188),q=r(81624),x=r(77172),N=r(92183),B=r(72510),L=r(44058),A=r(97881),V=r(64466),H=r(6877),U=r(20240),W=r(45697),G=r.n(W),K=r(57277);function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var $={name:C.Z.name,owner:C.Z.owner,sort_by:C.Z.sortBy},z={name:C.Z.name,owner:C.Z.owner,updated_at:C.Z.updated,created_at:C.Z.created},J=function(e){var t=e.filters,r=e.stateDispatch,i=e.debouncedFilter,s=e.initialState,p=e.meta,u=e.filterType,d=e.handleFilterItems,m=e.sortDirection,y=e.handleSort,h=e.fetchPortfoliosWithState,g=e.isFetching,b=e.isFiltering,v=e.canCreate,Z=(0,c.useDispatch)(),E=(0,k.Z)();return p.noData?null:l().createElement(K.Z,(0,o.Z)({},v?{dedicatedAction:l().createElement(O.Z,{pathname:"/portfolios/add-portfolio"},l().createElement(f.Button,{variant:"primary",id:"create-portfolio",ouiaId:"create-portfolio",type:"button"},E(C.Z.create)))}:{},{activeFiltersConfig:{filters:Object.entries(t).filter((function(e){var t=(0,n.Z)(e,2)[1];return t&&t.length>0})).map((function(e){var t=(0,n.Z)(e,2),r=t[0],o=t[1];return{category:E($[r]),type:r,chips:Array.isArray(o)?o.map((function(e){return{name:e}})):[{name:"sort_by"===r?E(z[o]):o}]}})),onDelete:function(e,o,l){var c=(0,n.Z)(o,1)[0];if(l)return r({type:"replaceFilterChip",payload:s.filters}),i(s.filters,p,Z,(function(e){return r({type:"setFilteringFlag",payload:e})}));var u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);"state"===c.type?u[c.type]=u[c.type].filter((function(e){return e!==c.chips[0].name})):u[c.type]="",r({type:"replaceFilterChip",payload:u}),i(u,p,Z,(function(e){return r({type:"setFilteringFlag",payload:e})}))}},filterConfig:{onChange:function(e,t){return r({type:"setFilterType",payload:t})},value:u,items:[{filterValues:{value:t.name,onChange:function(e,t){return d(t)}},label:E(C.Z.name),value:"name"},{filterValues:{value:t.owner,onChange:function(e,t){return d(t)}},label:E(C.Z.owner),value:"owner"},{filterValues:{value:t.sort_by||"name",onChange:function(e,t){return d(t)},items:[{label:E(C.Z.name),value:"name"},{label:E(C.Z.owner),value:"owner"},{label:E(C.Z.created),value:"created_at"},{label:E(C.Z.updated),value:"updated_at"}]},placeholder:t.sort_by?E(z[t.sort_by]):E(C.Z.name),label:E(C.Z.sortBy),value:"sort_by",type:"radio"}]},sortByConfig:{direction:m,onSortChange:function(e,t){return y(t)}},pagination:p.count>0?l().createElement(x.Z,{isDisabled:g||b,meta:p,apiRequest:function(e,r){return Z(h(t,r))},isCompact:!0}):void 0}))};J.propTypes={filters:G().shape({name:G().string.isRequired,owner:G().string.isRequired,sort_by:G().string}).isRequired,stateDispatch:G().func.isRequired,debouncedFilter:G().func.isRequired,initialState:G().shape({filters:G().shape((0,a.Z)({},G().string,G().any)).isRequired}).isRequired,meta:G().object.isRequired,filterType:G().string.isRequired,handleFilterItems:G().func.isRequired,sortDirection:G().string.isRequired,handleSort:G().func.isRequired,fetchPortfoliosWithState:G().func.isRequired,isFetching:G().bool.isRequired,isFiltering:G().bool.isRequired,canCreate:G().bool};const M=J;var Q=r(15811);function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var te=(0,q.Z)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.he,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;o(!0),r((0,h.Ec)(e,t)).then((function(){return o(!1)}))}),1e3),re={isOpen:!1,isFetching:!0,isFiltering:!1,filterType:"name",filters:{name:"",owner:"",sort_by:void 0},sortDirection:H.SortByDirection.asc},oe=function(e,t){switch(t.type){case"setFetching":return ee(ee({},e),{},{isFetching:t.payload});case"setFilterValue":return ee(ee({},e),{},{filters:(r=t.payload,o=e.filterType,n=e.filters,ee(ee({},n),{},(0,a.Z)({},o,r)))});case"replaceFilterChip":return ee(ee({},e),{},{sortDirection:H.SortByDirection.asc,filters:t.payload});case"setFilteringFlag":return ee(ee({},e),{},{isFiltering:t.payload});case"setFilterType":return ee(ee({},e),{},{filterType:t.payload});case"setSortBy":return ee(ee({},e),{},{sortDirection:t.payload,filters:e.filters.sort_by?e.filters:ee(ee({},e.filters),{},{sort_by:"name"})})}var r,o,n;return e};const ne=function(){var e=(0,k.Z)(),t=(0,L.Z)(),r=(0,U.Z)(),y=(0,i.useReducer)(oe,ee(ee({},re),null==t?void 0:t.portfolio)),g=(0,n.Z)(y,2),b=g[0],v=b.isFetching,Z=b.isFiltering,E=b.filters,O=b.filterType,D=b.sortDirection,w=g[1],F=(0,c.useSelector)((function(e){return e.portfolioReducer.portfolios})),C=F.data,j=F.meta,S=(0,c.useDispatch)(),_=(0,i.useContext)(B.Z).permissions,T=(0,s.useHistory)();(0,i.useEffect)((function(){S((0,h.Ec)(E,ee(ee({},j),{},{sortDirection:D}))).then((function(){return w({type:"setFetching",payload:!1})})),(0,d.k3)(),insights.chrome.appNavClick({id:"portfolios",secondaryNav:!0})}),[]);var q=function(e){w({type:"setFilterValue",payload:e}),te(ee(ee({},E),{},(0,a.Z)({},O,e)),ee(ee({},j),{},{offset:0,sortDirection:D}),S,(function(e){return w({type:"setFilteringFlag",payload:e})}))};(0,i.useEffect)((function(){!r||Z&&v||q(E[O])}),[D]);var H=function(e){return S((0,h.Yh)(e)).then((function(e){var t=e.id;return T.push({pathname:P.hT,search:"?portfolio=".concat(t)})}))},W=(0,d.Fs)(_,["catalog:portfolios:create"]),G=(0,d.Fs)(_,["catalog:order_processes:link"]),K={PrimaryAction:j.noData?function(){return l().createElement(I._,{url:P.NP,id:"create-portfolio",label:"Create",hasPermission:W})}:function(){return l().createElement(f.Button,{ouiaId:"clear-filter",variant:"link",onClick:function(){return q("")}},e(A.Z.clearFilters))},title:j.noData?e(V.Z.portfoliosNoData):e(A.Z.noResults),description:j.noData?e(V.Z.portfoliosNoDataDescription):e(A.Z.noResultsDescription),Icon:j.noData?p.ZP:u.ZP},Y=C.map((function(e){return l().createElement(R,(0,o.Z)({key:e.id,ouiaId:"portfolio-".concat(e.id)},e,{canLinkOrderProcesses:G,handleCopyPortfolio:H}))}));return l().createElement(i.Fragment,null,l().createElement(Q.Z,null,l().createElement(Q.y,{title:e(V.Z.portfoliosTitle)}),l().createElement(M,{filters:E,stateDispatch:w,debouncedFilter:te,initialState:re,meta:j,filterType:O,handleFilterItems:q,sortDirection:D,handleSort:function(e){return w({type:"setSortBy",payload:e})},fetchPortfoliosWithState:h.Ec,isFetching:v,isFiltering:Z,canCreate:W})),l().createElement(m.Z,{items:Y,isLoading:v||Z,renderEmptyState:function(){return l().createElement(I.Z,K)}}),j.count>0&&l().createElement(N.Z,null,l().createElement(x.Z,{meta:j,apiRequest:function(e,t){return S((0,h.Ec)(E,t))},dropDirection:"up"})))}}}]);
//# sourceMappingURL=../sourcemaps/portfolios.93820d6d2a743e3aee84.js.map