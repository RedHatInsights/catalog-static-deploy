(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{638:function(e,r,t){"use strict";var o=t(22),n=Object(o.b)({orderedBy:{id:"orders.common.orderedBy",defaultMessage:"Ordered by {owner}"},orderedByLabel:{id:"orders.approval.orderedBy",defaultMessage:"Ordered by"},lastUpdated:{id:"orders.common.lastUpdated",defaultMessage:"Last updated"},compositeTitle:{id:"orders.common.compositeTitle",defaultMessage:"{name} - Order # {id}"},detailTitle:{id:"orders.detail.title",defaultMessage:"Order ID {id}"},orderSuccess:{id:"orders.notification.success",defaultMessage:"You can track the progress of Order # {id} in your <link>Orders</link> page."},noOrdersTitle:{id:"orders.list.empty.title",defaultMessage:"No orders"},noOrdersDescription:{id:"orders.list.empty.description",defaultMessage:"No orders have been created."},noApprovalRequests:{id:"orders.approval.no-requests",defaultMessage:"We were unable to find any approval requests for this order."},creatingApprovalRequest:{id:"orders.approval.creating",defaultMessage:"Creating approval request"},approvalTitle:{id:"orders.approval.title",defaultMessage:"Summary"},approvalDetail:{id:"orders.approval.view-detail",defaultMessage:"View this order's approval request details"},approvalCreated:{id:"orders.approval.details.created",defaultMessage:"Request created"},approvalReason:{id:"orders.approval.details.reason",defaultMessage:"Approval reason"},approvalCompleted:{id:"orders.approval.details.completed",defaultMessage:"Completed at"},orderDetails:{id:"orders.common.details",defaultMessage:"Order details"},menuApproval:{id:"orders.menu.approval",defaultMessage:"Approval"},menuProvision:{id:"orders.menu.provision",defaultMessage:"Provision"},menuLifecycle:{id:"orders.menu.lifecycle",defaultMessage:"Lifecycle"},menuSteps:{id:"orders.menu.steps",defaultMessage:"Order steps"},objectsNotFound:{id:"order.detail.not-found",defaultMessage:"The {objects} for this order {count, plural, one {is} other {are}} not available"},orderID:{id:"orders.order.detail.ID",defaultMessage:"Order ID"},orderParameters:{id:"orders.order.detail.parameters",defaultMessage:"Order parameters"},orderItemParameters:{id:"orders.order.provision.parameters",defaultMessage:"Parameters"},defaultOrderItemType:{id:"orders.order.default_type",defaultMessage:"Product"},orderProgressMessages:{id:"orders.order.detail.messages",defaultMessage:"Progress messages"},lifecycleLink:{id:"orders.order.lifecycle.link",defaultMessage:"Manage product"},cancelOrder:{id:"orders.actions.cancel",defaultMessage:"Cancel order"},keepOrder:{id:"orders.actions.keep",defaultMessage:"Keep order"},cancelDescription:{id:"orders.cancel.description",defaultMessage:"Are you sure you want to cancel {name}?"},backToOrders:{id:"orders.toolbar.backLink",defaultMessage:"Back to orders"},orderDate:{id:"orders.approval.order-date",defaultMessage:"Order date"},approvalParameters:{id:"orders.approval.parameters",defaultMessage:"Parameters"},activity:{id:"orders.approval.activity",defaultMessage:"Activity"},artifacts:{id:"orders.artifacts",defaultMessage:"Order artifacts"},noOrderProvision:{id:"orders.provision.no-items",defaultMessage:"We were unable to find provisioning data for this order."},fetchingOrderProvision:{id:"orders.provision.fetching-provision",defaultMessage:"Retrieving order provisioning data"}});r.a=n},709:function(e,r,t){"use strict";t.d(r,"f",(function(){return S})),t.d(r,"g",(function(){return C})),t.d(r,"a",(function(){return R})),t.d(r,"e",(function(){return A})),t.d(r,"c",(function(){return B})),t.d(r,"b",(function(){return G})),t.d(r,"d",(function(){return J}));var o=t(0),n=t.n(o),a=t(131),i=t(3),s=t(28),u=t(5),d=t(32),c=t(49),l=function(){return(l=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},f=function(e,r,t,o){return new(t||(t=Promise))((function(n,a){function i(e){try{u(o.next(e))}catch(e){a(e)}}function s(e){try{u(o.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,s)}u((o=o.apply(e,r||[])).next())}))},p=function(e,r){var t,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],o=0}finally{t=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},m=Object(s.a)(),v=function(e){return f(void 0,void 0,void 0,(function(){var r,t,o,n;return p(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,m.get(u.e+"/order_items/?order_id="+e)];case 1:return t=a.sent(),r=t.data,[3,3];case 2:if(o=a.sent(),r=[],404!==o.status&&400!==o.status)throw o;return c.a.replace({pathname:"/404",state:{from:c.a.location}}),[3,3];case 3:return n=r.map((function(e){return m.get(u.e+"/order_items/"+e.id+"/progress_messages")})),[2,Promise.all(n).then((function(e){var t=e.reduce((function(e,r){return l(l({},e),r.data)}),{});return{orderItems:r,progressMessages:t}}))]}}))}))},y=function(){return(y=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},h=function(e,r,t,o){return new(t||(t=Promise))((function(n,a){function i(e){try{u(o.next(e))}catch(e){a(e)}}function s(e){try{u(o.throw(e))}catch(e){a(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,s)}u((o=o.apply(e,r||[])).next())}))},g=function(e,r){var t,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],o=0}finally{t=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},b=function(e,r){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]])}return t},_=Object(s.c)(),O=(Object(s.d)(),Object(s.g)()),w=Object(s.a)(),M=Object(s.b)(),j=function(e){return O.listServicePlans(e)},I=function(e,r){return void 0===e&&(e=""),void 0===r&&(r=d.a),w.get(u.e+"/orders?"+e+"&limit="+r.limit+"&offset="+r.offset).then((function(e){return(r=e.data.map((function(e){return e.id})),w.get(u.e+"/order_items?"+r.map((function(e){return"filter[order_id][]="+e})).join("&"))).then((function(r){return(t=r.data.map((function(e){return e.portfolio_item_id})),w.get(u.e+"/portfolio_items?"+t.map((function(e){return"filter[id][]="+e})).join("&"))).then((function(t){return y(y({portfolioItems:t},e),{data:e.data.map((function(e){return y(y({},e),{orderItems:r.data.filter((function(r){return r.order_id===e.id}))})}))})}));var t}));var r}))},P=function(e){if(Object.values(e).some((function(e){return!e})))return r=e.order,f(void 0,void 0,void 0,(function(){var e,t,o,n,a,i;return p(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,m.get(u.e+"/orders/"+r)];case 1:return e=s.sent(),[3,3];case 2:if(t=s.sent(),e={},404!==t.status&&400!==t.status)throw t;return c.a.replace({pathname:"/404",state:{from:c.a.location}}),[3,3];case 3:o={object:"Order item",notFound:!0},s.label=4;case 4:return s.trys.push([4,6,,7]),[4,m.get(u.e+"/order_items?order_id="+e.id)];case 5:return n=s.sent(),o=n.data[0],[3,7];case 6:return s.sent(),[3,7];case 7:a={object:"Product",notFound:!0},s.label=8;case 8:return s.trys.push([8,10,,11]),[4,m.get(u.e+"/portfolio_items/"+o.portfolio_item_id)];case 9:return a=s.sent(),[3,11];case 10:return s.sent(),[3,11];case 11:return i=[m.get(u.k+"/sources/"+a.service_offering_source_ref).catch((function(){return{object:"Platform",notFound:!0}})),m.get(u.e+"/order_items/"+o.id+"/progress_messages").catch((function(){return{object:"Messages",notFound:!0}})),m.get(u.e+"/portfolios/"+a.portfolio_id).catch((function(){return{object:"Portfolio",notFound:!0}}))],[2,Promise.all(i).then((function(r){var t=r[0],n=r[1],i=r[2];return[e,o,a,t,n,i]}))]}}))}));var r,t=[w.get(u.e+"/orders/"+e.order).catch((function(e){if(404===e.status||400===e.status)return c.a.replace({pathname:"/404",state:{from:c.a.location}});throw e})),w.get(u.e+"/order_items/"+e["order-item"]).catch((function(e){if(404===e.status||400===e.status)return{object:"Order item",notFound:!0};throw e})),w.get(u.e+"/portfolio_items/"+e["portfolio-item"]).catch((function(e){if(404===e.status||400===e.status)return{object:"Product",notFound:!0};throw e})),w.get(u.k+"/sources/"+e.platform).catch((function(e){if(404===e.status||400===e.status)return{object:"Platform",notFound:!0};throw e})),w.get(u.e+"/order_items/"+e["order-item"]+"/progress_messages").catch((function(e){if(404===e.status||400===e.status)return{};throw e})),w.get(u.e+"/portfolios/"+e.portfolio).catch((function(e){if(404===e.status||400===e.status)return{object:"Portfolio",notFound:!0};throw e}))];return Promise.all(t)},E=function(e){return w.get(u.e+"/order_items/"+e+"/approval_requests").then((function(e){var r=e.data.map((function(e){var r,t,o=e.approval_request_ref;return r=o,M.post(u.b+"/graphql",{query:(t=r,'query {\n  requests(id: "'+t+'") {\n    id\n    number_of_children\n    decision\n    group_name\n    created_at\n    state\n    actions {\n      id\n      created_at\n    }\n    requests {\n      id\n      number_of_children\n      decision\n      group_name\n      state\n      parent_id\n      created_at\n      actions {\n        id\n        created_at\n      }\n    }\n  }\n}')},{"x-rh-persona":"approval/requester"}).then((function(e){var r=e.data.requests;return r&&r.length>0&&r[0].number_of_children>0?r[0].requests:r}))}));return Promise.all(r).then((function(e){var r;return{data:(null===(r=null==e?void 0:e[0])||void 0===r?void 0:r.map((function(e){var r,t=e.actions,o=b(e,["actions"]);return y(y({},o),{updated:(null==t?void 0:t.length)>0?null===(r=t.pop())||void 0===r?void 0:r.created_at:o.created_at})})))||[]}}))}))},D=t(78),k=t(9),L=t(638),q=t(20),F=function(e){var r=e.id,t=e.dispatch,o=e.portfolioItemId,i=e.portfolioId,s=e.platformId,u=e.orderItemId;return Object(q.a)()(L.a.orderSuccess,{id:r,link:function(e){return n.a.createElement(D.a,{onClick:function(){return t(Object(a.clearNotifications)())},to:{pathname:k.o,search:"?order="+r+"&order-item="+u+"&portfolio-item="+o+"&platform="+s+"&portfolio="+i}},e)}})},N=t(89),T=function(){return(T=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},x=function(e,r){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]])}return t},S=function(e){return{type:i.z,payload:j(e)}},C=function(e,r){return function(t){return t({type:i.db,payload:(o=e,h(void 0,void 0,void 0,(function(){var e,r,t;return g(this,(function(n){switch(n.label){case 0:return s=o.service_parameters,u=s.providerControlParameters,d=b(s,["providerControlParameters"]),c=b(o,["service_parameters"]),[4,_.createOrder()];case 1:return e=n.sent(),(r={}).count=1,r=y(y(y({},r),c),{service_parameters:d,provider_control_parameters:u||{}}),[4,_.addToOrder(e.id,r)];case 2:return t=n.sent(),[2,_.submitOrder(e.id).then((function(e){return y(y({},e),{orderItem:t})}))]}}))}))).then((function(e){var o=e.id,i=e.orderItem;return t(Object(a.addNotification)({variant:"success",title:"Your order has been accepted successfully",description:n.a.createElement(F,{id:o,dispatch:t,portfolioItemId:r.id,portfolioId:r.portfolio_id,platformId:r.service_offering_source_ref,orderItemId:i.id}),dismissable:!0}))}))});var o,s,u,d,c}},R=function(e){return function(r,t){r({type:i.e+"_PENDING"});var o=t().orderReducer.orderDetail;return function(e){return _.cancelOrder(e)}(e).then((function(){return o.order.state=N.OrderStateEnum.Canceled,o.approvalRequest&&o.approvalRequest.data.length>0&&(o.approvalRequest.data[0].state="canceled"),r({type:i.V,payload:T({},o)}),o})).then((function(e){return r(Object(a.addNotification)({variant:"success",title:"Your order has been canceled successfully",description:"Order Order #"+e.order.id+" was canceled.",dismissable:!0}))})).then((function(){return r({type:i.e+"_FULFILLED"})})).catch((function(e){r({type:i.e+"_REJECTED",payload:e})}))}},A=function(e,r){return void 0===r&&(r=d.a),function(t){var o=Object.entries(e).filter((function(e){var r=e[1];return r&&r.length>0})).map((function(e){var r=e[0],t=e[1];return Array.isArray(t)?t.map((function(e){return"filter["+r+"][]="+e})).join("&"):"filter["+r+"][contains_i]="+t})).join("&");return r.sortBy&&(o=o+"&sort_by="+r.sortBy+":"+(r.sortDirection||"desc")),t({type:i.i+"_PENDING"}),I(o,r).then((function(n){var a=n.portfolioItems,s=x(n,["portfolioItems"]);return t({type:i.Y,payload:a}),t({type:i.i+"_FULFILLED",meta:T(T({},r),{filter:o,filters:e,storeState:!0,stateKey:"orders"}),payload:s})})).catch((function(e){return t({type:i.i+"_REJECTED",payload:e})}))}},B=function(e){return function(r){return r({type:i.V+"_PENDING"}),P(e).then((function(e){var t=e[0],o=e[1],n=e[2],a=e[3],s=e[4],u=e[5];return r({type:i.V+"_FULFILLED",payload:{order:t,orderItem:o,portfolioItem:n,platform:a,progressMessages:s,portfolio:u}})})).catch((function(e){return r({type:i.V+"_REJECTED",payload:e})}))}},G=function(e){return function(r){return r({type:i.g+"_PENDING"}),E(e).then((function(e){return r({type:i.g+"_FULFILLED",payload:e}),e})).catch((function(e){return r({type:i.g+"_REJECTED",payload:e})}))}},J=function(e){return function(r){return r({type:i.X+"_PENDING"}),function(e){return h(void 0,void 0,void 0,(function(){return g(this,(function(r){switch(r.label){case 0:return[4,v(e)];case 1:return[2,r.sent()]}}))}))}(e).then((function(e){var t=e.orderItems,o=e.progressMessages;return r({type:i.X+"_FULFILLED",payload:{orderItems:t,progressMessages:o}})})).catch((function(e){return r({type:i.X+"_REJECTED",payload:e})}))}}}}]);
//# sourceMappingURL=../sourcemaps/lib~order-detail~order-modal~91f4305a.js.map