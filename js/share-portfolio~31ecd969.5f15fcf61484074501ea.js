(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{582:function(e,t,r){"use strict";var n=r(13),o=r.n(n),i=r(176),u=r.n(i),s=r(85);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(e){return"string"==typeof e?e.split("?")[0]:"object"===u()(e)?c(c({},e),{},{search:void 0}):e};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.removeSearch,r=e.keepHash,n=Object(s.g)();return c(c({},n),{},{push:function(e){var o=e;return r&&n.location.hash.length>0&&(o="object"===u()(o)?c(c({},o),{},{hash:n.location.hash}):"".concat(o).concat(n.location.hash)),t?n.push(l(o)):n.push(o)}})}},583:function(e,t,r){"use strict";var n=r(20),o=Object(n.b)({noItems:{id:"common.filtering.noItems",defaultMessage:"No items found"},filterByProduct:{id:"common.filtering.filterByProduct",defaultMessage:"Filter by product"},noResults:{id:"common.filtering.noResults",defaultMessage:"No results found"},noResultsDescription:{id:"common.filtering.noResultsDescription",defaultMessage:"No results match the filter criteria. Remove all filters or clear all filters to show results."},clearFilters:{id:"common.filtering.clear-filters",defaultMessage:"Clear all filters"},noProducts:{id:"common.filtering.no-products",defaultMessage:"No products yet"},noRecords:{id:"commonMessages.noRecords",defaultMessage:"No records"},filterByTitle:{id:"tableToolbar.filterByTitle",defaultMessage:"Filter by {title}"},noResultsFound:{id:"tableToolbar.noResultsFound",defaultMessage:"No results found"},noResult:{id:"tableToolbar.noResult",defaultMessage:"No {results}"},unknown:{id:"commonMessages.unknown",defaultMessage:"Unknown"}});t.a=o},613:function(e,t,r){var n=r(764);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},758:function(e,t,r){var n=r(759);e.exports=function(e,t){return n(e,t)}},759:function(e,t,r){var n=r(760),o=r(308);e.exports=function e(t,r,i,u,s){return t===r||(null==t||null==r||!o(t)&&!o(r)?t!=t&&r!=r:n(t,r,i,u,e,s))}},760:function(e,t,r){var n=r(761),o=r(768),i=r(770),u=r(771),s=r(774),a=r(111),c=r(775),l=r(776),p="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,d,g,h){var m=a(e),v=a(t),b=m?"[object Array]":s(e),O=v?"[object Array]":s(t),y=(b="[object Arguments]"==b?p:b)==p,j=(O="[object Arguments]"==O?p:O)==p,_=b==O;if(_&&c(e)){if(!c(t))return!1;m=!0,y=!1}if(_&&!y)return h||(h=new n),m||l(e)?o(e,t,r,d,g,h):i(e,t,b,r,d,g,h);if(!(1&r)){var w=y&&f.call(e,"__wrapped__"),P=j&&f.call(t,"__wrapped__");if(w||P){var S=w?e.value():e,x=P?t.value():t;return h||(h=new n),g(S,x,r,d,h)}}return!!_&&(h||(h=new n),u(e,t,r,d,g,h))}},761:function(e,t,r){var n=r(762),o=r(763),i=r(765),u=r(766),s=r(767);function a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}a.prototype.clear=n,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},762:function(e,t){e.exports=function(){this.__data__=[],this.size=0}},763:function(e,t,r){var n=r(613),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},764:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},765:function(e,t,r){var n=r(613);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},766:function(e,t,r){var n=r(613);e.exports=function(e){return n(this.__data__,e)>-1}},767:function(e,t,r){var n=r(613);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},768:function(e,t,r){var n=r(306),o=r(769),i=r(307);e.exports=function(e,t,r,u,s,a){var c=1&r,l=e.length,p=t.length;if(l!=p&&!(c&&p>l))return!1;var f=a.get(e);if(f&&a.get(t))return f==t;var d=-1,g=!0,h=2&r?new n:void 0;for(a.set(e,t),a.set(t,e);++d<l;){var m=e[d],v=t[d];if(u)var b=c?u(v,m,d,t,e,a):u(m,v,d,e,t,a);if(void 0!==b){if(b)continue;g=!1;break}if(h){if(!o(t,(function(e,t){if(!i(h,t)&&(m===e||s(m,e,r,u,a)))return h.push(t)}))){g=!1;break}}else if(m!==v&&!s(m,v,r,u,a)){g=!1;break}}return a.delete(e),a.delete(t),g}},769:function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},770:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},771:function(e,t,r){var n=r(772),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,u,s){var a=1&r,c=n(e),l=c.length;if(l!=n(t).length&&!a)return!1;for(var p=l;p--;){var f=c[p];if(!(a?f in t:o.call(t,f)))return!1}var d=s.get(e);if(d&&s.get(t))return d==t;var g=!0;s.set(e,t),s.set(t,e);for(var h=a;++p<l;){var m=e[f=c[p]],v=t[f];if(i)var b=a?i(v,m,f,t,e,s):i(m,v,f,e,t,s);if(!(void 0===b?m===v||u(m,v,r,i,s):b)){g=!1;break}h||(h="constructor"==f)}if(g&&!h){var O=e.constructor,y=t.constructor;O==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof O&&O instanceof O&&"function"==typeof y&&y instanceof y||(g=!1)}return s.delete(e),s.delete(t),g}},772:function(e,t,r){var n=r(773)(Object.keys,Object);e.exports=n},773:function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},774:function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},775:function(e,t){e.exports=function(){return!1}},776:function(e,t){e.exports=function(){return!1}},940:function(e,t,r){"use strict";r.r(t);var n=r(88),o=r.n(n),i=r(13),u=r.n(i),s=r(52),a=r.n(s),c=r(24),l=r.n(c),p=r(0),f=r.n(p),d=r(4),g=r.n(d),h=r(178),m=r(19),v=r(758),b=r.n(v),O=r(177),y=r(28),j=r(23),_=r(182),w=r(139),P=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],u=0,s=i.length;u<s;u++,o++)n[o]=i[u];return n},S=function(e,t){return[{component:"sub-form",description:"share.new.description",name:"new_share",key:"1",fields:[{name:"group-selection",component:"share-group-select",loadOptions:e,isSearchable:!0,permissions:t}]}]},x=function(e){return[{component:"sub-form",name:"current-groups-sub-form",fields:[{name:"shared-groups",permissionVerbs:e,component:"share-group-edit"}]}]},D=function(e,t,r,n){return{fields:P(r?S(e,t):[],n?x(t):[])}},k=r(136),E=r(22),M=r(5),N=Object(E.a)(),T=Object(E.f)(),R=function(e){return N.get(M.e+"/portfolios/"+e+"/share_info")},G=r(3);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=function(e){return{type:G.ab,payload:(t=A({},e),r={permissions:t.permissions.split(","),group_uuids:[t.group_uuid]},T.sharePortfolio(t.id,r))};var t,r},F=function(e){return{type:G.db,payload:(t=A({},e),r={permissions:t.permissions,group_uuids:[t.group_uuid]},T.unsharePortfolio(t.id,r))};var t,r},U=r(87),B=(Object(E.h)(),r(86)),L=r(582),z=r(188),V=r(48),H=r(31),J=r(583),q=r(18),K=r(195),Q=function(e,t){switch(e.length){case 1:return e[0];case 2:return t(V.a.shareSuccessTwoGroup,{group1:e[0],group2:e[1]});default:return t(V.a.shareSuccessMultipleGroups,{count:e.length})}},W=function(e){var t,r=e.shareData,n=e.initialGroups,o=e.removedGroups,i=e.newGroups,u=e.formatMessage,s=e.portfolioName,a=u(V.a.shareSuccessTitle),c=r.filter((function(e){var t,r=e.permissions,o=e.group_uuid,i=n.find((function(e){return e.group_uuid===o}));return i&&(null==r?void 0:r.split(",").length)!==(null===(t=i.permissions)||void 0===t?void 0:t.split(",").length)})),l=o.filter((function(e){var t=e.group_uuid;return!c.find((function(e){return e.group_uuid===t}))})).length>0,p=i.filter((function(e){var t=e.group_uuid;return!n.find((function(e){return e.group_uuid===t}))})).length>0;return l&&!p&&0===c.length&&(a=u(V.a.shareSuccessTitleOnlyUnsharing),t=u(V.a.shareSuccessDescriptionOnlyUnsharing,{name:s(),group:Q(o.map((function(e){return e.groupName})),u),b:K.a})),!l&&p&&0===c.length&&(a=u(V.a.shareSuccessTitleOnlySharing),t=u(V.a.shareSuccessDescriptionOnlySharing,{name:s(),group:Q(i.map((function(e){return e.groupName})),u),b:K.a})),!l&&!p&&c.length>0&&(a=u(V.a.shareSuccessTitleOnlyChaningPermissions),t=u(V.a.shareSuccessDescriptionOnlyChaningPermissions,{group:Q(c.map((function(e){return e.groupName})),u),b:K.a})),{title:a,description:t}};function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e){var t,r,n,i,u,s,c,d,g=e.closeUrl,v=e.removeSearch,P=e.viewState,S=e.portfolioName,x=void 0===S?function(){return""}:S,N=Object(q.a)(),T=Object(m.useDispatch)(),I=Object(L.a)({removeSearch:v,keepHash:!0}).push,A=Object(B.a)(["portfolio"]),K=l()(A,2),Q=K[0].portfolio,X=K[1],Z=Object(p.useState)(!0),$=l()(Z,2),ee=$[0],te=$[1],re=Object(m.useSelector)((function(e){var t=e.portfolioReducer;return{selectedPortfolio:t.selectedPortfolio,isLoading:t.isLoading}})),ne=re.selectedPortfolio,oe=re.isLoading,ie=Object(m.useSelector)((function(e){return{shareInfo:e.shareReducer.shareInfo}})).shareInfo;Object(p.useEffect)((function(){var e;te(!0),T((e=Q,{type:G.G,payload:R(e)})).then((function(){return te(!1)})).catch((function(){return te(!1)}))}),[]);var ue=function(){T(Object(k.m)()),I({pathname:g,search:X})};if(!1===(null==ne||null===(t=ne.metadata)||void 0===t||null===(r=t.user_capabilities)||void 0===r?void 0:r.share)&&!1===(null==ne||null===(n=ne.metadata)||void 0===n||null===(i=n.user_capabilities)||void 0===i?void 0:i.unshare))return f.a.createElement(z.a,null);var se=ee||oe;return f.a.createElement(O.Modal,{title:N(V.a.portfolioShareTitle),isOpen:!0,variant:"small",onClose:ue},se&&f.a.createElement(U.i,null),!se&&f.a.createElement(_.Stack,{hasGutter:!0},f.a.createElement(w.StackItem,null,f.a.createElement(y.TextContent,null,f.a.createElement(j.Text,null,N(V.a.portfolioShareDescription,{name:x(Q),strong:function(e){return f.a.createElement("strong",{key:"strong"},e)}})))),f.a.createElement(w.StackItem,null,f.a.createElement(h.c,{schema:D((function(e){return void 0===(t=e)&&(t=""),Object(E.a)().get(M.j+"/groups/"+(t.length>0?"?name="+t:"")).then((function(e){return e.data.map((function(e){var t=e.uuid;return{label:e.name,value:t}}))}));var t}),M.m,!1!==(null==ne||null===(u=ne.metadata)||void 0===u||null===(s=u.user_capabilities)||void 0===s?void 0:s.share),!1!==(null==ne||null===(c=ne.metadata)||void 0===c||null===(d=c.user_capabilities)||void 0===d?void 0:d.unshare)),schemaType:"default",onSubmit:function(e,t){var r=e["shared-groups"],n=[],i=t.getState().initialValues["shared-groups"],u=i.filter((function(e){return!r.find((function(t){return t.group_uuid===e.group_uuid}))})).map((function(e){var t=e.permissions;return Y(Y({},a()(e,["permissions"])),{},{permissions:t.split(",")})}));r.forEach((function(e){var t=i.find((function(t){return t.group_uuid===e.group_uuid}));t&&!b()(t,e)&&(t.permissions.length>e.permissions.length?u.push({id:Q,permissions:["update"],group_uuid:e.group_uuid}):n.push(e)),t||n.push(e)}));var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?F:C;return T(r({id:Q,permissions:e.permissions,group_uuid:e.group_uuid}))},c=[].concat(o()(n.map((function(e){return s(e)}))),o()(u.map((function(e){return s(e,!0)}))));ue();var l=W({shareData:r,initialGroups:i,removedGroups:u,newGroups:n,formatMessage:N,portfolioName:x}),p=l.title,f=l.description;return Promise.all(c).then((function(){return T({type:H.ADD_NOTIFICATION,payload:{dismissable:!0,variant:"success",title:p,description:f}}),T(Object(k.g)(P))}))},onCancel:ue,validate:function(e){var t={};return e.group_uuid&&!e.permissions&&(t.permissions=N(V.a.portfolioSharePermissions)),e.permissions&&!e.group_uuid&&(t.group_uuid=N(V.a.portfolioShareGroups)),t},initialValues:Y(Y({},ne),{},{"shared-groups":ie.map((function(e){var t=e.permissions.filter((function(e){return M.n.indexOf(e)>-1})),r=e.group_name,n=M.m.find((function(e){return e.value===t.sort().join(",")}));return{groupName:r,group_uuid:e.group_uuid,permissions:n?n.value:N(J.a.unknown)}}))}),templateProps:{disableSubmit:["pristine","validating"],submitLabel:N(V.a.portfolioShareApply)}}))))};Z.propTypes={closeUrl:g.a.string.isRequired,removeSearch:g.a.bool,portfolioName:g.a.func,viewState:g.a.shape({count:g.a.number,limit:g.a.number,offset:g.a.number,filter:g.a.string})};t.default=Z}}]);
//# sourceMappingURL=../sourcemaps/share-portfolio~31ecd969.js.map