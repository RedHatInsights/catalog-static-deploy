(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{625:function(e,t,r){"use strict";r.r(t);var i,n=r(22),o=r.n(n),s=r(41),a=r.n(s),c=r(1),p=r.n(c),d=r(0),l=r.n(d),u=r(2),f=r.n(u),E=r(25),P=r(371),L=r(620),m=r.n(L),I=r(621),_=r(90),S=r(62),D=r(12),T=r(56),b=r(503),h=r(36),O=r(45),A=(i={},p()(i,P.componentTypes.TEXT_FIELD,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.HELPER_TEXT,I.fieldProperties.PLACEHOLDER,I.fieldProperties.IS_DISABLED,I.fieldProperties.IS_READ_ONLY,I.fieldProperties.HIDE_FIELD]}),p()(i,P.componentTypes.CHECKBOX,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.IS_DISABLED,I.fieldProperties.OPTIONS,I.fieldProperties.HIDE_FIELD]}),p()(i,P.componentTypes.SELECT,{attributes:[I.fieldProperties.OPTIONS,I.fieldProperties.LABEL,I.fieldProperties.IS_DISABLED,I.fieldProperties.PLACEHOLDER,I.fieldProperties.HELPER_TEXT,I.fieldProperties.HIDE_FIELD]}),p()(i,P.componentTypes.DATE_PICKER,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.TODAY_BUTTON_LABEL,I.fieldProperties.IS_CLEARABLE,I.fieldProperties.CLOSE_ON_DAY_SELECT,I.fieldProperties.SHOW_TODAY_BUTTON,I.fieldProperties.HIDE_FIELD]}),p()(i,P.componentTypes.PLAIN_TEXT,{attributes:[I.fieldProperties.MULTI_LINE_LABEL]}),p()(i,P.componentTypes.RADIO,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.IS_DISABLED,I.fieldProperties.OPTIONS,I.fieldProperties.HIDE_FIELD]}),p()(i,P.componentTypes.SWITCH,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.IS_READ_ONLY,I.fieldProperties.IS_DISABLED,I.fieldProperties.HIDE_FIELD]}),p()(i,P.componentTypes.TEXTAREA,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.HELPER_TEXT,I.fieldProperties.IS_READ_ONLY,I.fieldProperties.IS_DISABLED,I.fieldProperties.HIDE_FIELD]}),i),v={componentMapper:I.builderMapper,pickerMapper:I.pickerMapper,propertiesMapper:I.propertiesMapper,componentProperties:A},R=function(e){return l.a.createElement(m.a,e)},B=function(e){var t=e.closeUrl,r=e.search,i=e.portfolioItem,n=e.uploadIcon,s=Object(d.useState)(),c=a()(s,2),p=c[0],u=c[1],f=Object(d.useState)(!1),P=a()(f,2),L=P[0],m=P[1],I=Object(d.useState)(),A=a()(I,2),B=A[0],y=A[1],j=Object(d.useState)(),H=a()(j,2),g=H[0],N=H[1],F=Object(h.useDispatch)(),C=Object(E.g)().push,M=function(){return Object(S.a)().get("".concat(D.c,"/portfolio_items/").concat(i.id,"/service_plans")).then((function(e){var t=a()(e,1)[0].create_json_schema.schema;return N(e[0]),e[0].imported?Object(S.a)().get("".concat(D.c,"/service_plans/").concat(e[0].id,"/base")).then((function(e){return y(e.create_json_schema.schema),t})):t})).then((function(e){u(e),m(!1)}))};Object(d.useEffect)((function(){M()}),[]);var U=function(e){return Object(S.i)().patchServicePlanModified("".concat(g.id),{modified:{schema:e}})},q=function(e){return Object(S.i)().createServicePlan({portfolio_item_id:i.id}).then((function(e){return a()(e,1)[0].id})).then((function(t){return Object(S.i)().patchServicePlanModified("".concat(t),{modified:{schema:e}})}))},X=function(e){return m(!0),(g.imported?U:q)(e).then((function(){return m(!1),F(Object(O.addNotification)({variant:"success",title:"Survey of ".concat(i.name," has been modified."),dismissable:!0})),C({pathname:t,search:r})})).catch((function(e){m(!1),F({type:"EDIT_SURVEY_REJECTED",payload:e})}))};return l.a.createElement(d.Fragment,null,p?l.a.createElement(R,o()({},v,{schema:p,disableDrag:!0,schemaTemplate:B,mode:"subset",controlPanel:function(e){var o=e.getSchema,s=e.isValid;return l.a.createElement(b.b,{key:"survey-editor-toolbar",uploadIcon:n,product:i,handleSaveSurvey:function(){return X(o())},isValid:s,closeUrl:t,search:r,isFetching:L||!p,modified:g.modified,handleResetSurvey:function(){return e=g.id,u(void 0),void Object(S.i)().resetServicePlanModified(e).then(M).then((function(){return F(Object(O.addNotification)({variant:"success",title:"Survey of ".concat(i.name," has been restored."),dismissable:!0}))}));var e}})}})):l.a.createElement(d.Fragment,null,l.a.createElement(b.b,{uploadIcon:n,product:i,handleSaveSurvey:X,closeUrl:t,search:r,isFetching:!p||L}),l.a.createElement(T.Bullseye,null,l.a.createElement(_.Spinner,null))))};B.propTypes={closeUrl:f.a.string.isRequired,search:f.a.string.isRequired,uploadIcon:f.a.func.isRequired,portfolioItem:f.a.shape({id:f.a.string.isRequired,name:f.a.string.isRequired}).isRequired,portfolio:f.a.object.isRequired},t.default=B}}]);
//# sourceMappingURL=../sourcemaps/survey-editor.js.map