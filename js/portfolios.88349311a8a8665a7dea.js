"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[2391],{92558:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ae});var o=r(87462),n=r(29439),a=r(4942),i=r(30624),l=r.n(i),c=r(45237),s=r(334),p=r(20777),u=r(48794),f=r(6202),d=r(63035),m=r(59837),y=r(7247),h=r(89231),g=r(90459),b=r(57849),v=r(62410),Z=r(95645);const E=function(e){var t=e.id,r=e.to,o=e.portfolioName,n=e.portfolio_items,a=e.headerActions,i=void 0===a?[]:a;return l().createElement(g.$h,null,l().createElement(g.Gh,null,l().createElement(b.TextContent,null,l().createElement(s.Link,{to:r,id:"portfolio-link-"+t},l().createElement(b.Text,{title:o,className:"pf-u-mb-0",component:b.TextVariants.h3},l().createElement(Z.Z,null,o))))),l().createElement(b.Badge,{isRead:!0},n),l().createElement("div",{onClick:function(e){return e.preventDefault()}},i))};var O=r(20697),D=r(36722),P=r(52587),w=r(92156),F=r(7579),C=r(56682),k=r(23349),j=r(29751),S=r(35388),_=function(){return(_=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},T=["description"],R=function(e){var t=e.portfolioId,r=e.handleCopyPortfolio,o=e.canLinkOrderProcesses,n=e.userCapabilities,a=n.share,c=n.copy,s=n.unshare,p=n.update,u=n.destroy,f=n.set_approval,d=(0,k.Z)(),m=(0,i.useState)(!1),y=m[0],h=m[1],g=[];if((a||s)&&g.push(l().createElement(b.DropdownItem,{key:"share-portfolio-action",id:"share-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.Ak,preserveHash:!0},d(F.Z.share))})),c&&g.push(l().createElement(b.DropdownItem,{key:"copy-portfolio-action",id:"copy-portfolio-action",onClick:function(){return r(t)}},d(F.Z.copy))),f&&g.push(l().createElement(b.DropdownItem,{key:"workflow-portfolio-action",id:"workflow-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.sP,preserveHash:!0},d(F.Z.setApproval))})),p&&o){var v=d(j.Z.setOrderProcess);g.push(l().createElement(b.DropdownItem,{"aria-label":v,key:"attach-order-processes",id:"attach-order-processes",component:l().createElement(O.Z,{preserveSearch:!0,pathname:D.yI,searchParams:{portfolio:t}},v),role:"link"}))}return p&&g.push(l().createElement(b.DropdownItem,{key:"edit-portfolio-action",id:"edit-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.Po,preserveHash:!0},d(F.Z.edit))})),u&&g.push(l().createElement(b.DropdownItem,{key:"remove-portfolio-action",id:"remove-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.wN,preserveHash:!0},d(F.Z.delete))})),0===g.length?null:l().createElement(b.Dropdown,{key:"portfolio-dropdown",id:"portfolio-"+t+"-dropdown",isOpen:y,isPlain:!0,onSelect:function(){return h(!1)},position:b.DropdownPosition.right,toggle:l().createElement(b.KebabToggle,{id:"portfolio-"+t+"-toggle",onToggle:function(e){return h(e)}}),dropdownItems:g})};const I=function(e){var t,r,o,n,a=e.imageUrl,i=e.isDisabled,c=e.name,s=e.id,p=e.handleCopyPortfolio,u=e.metadata,f=e.canLinkOrderProcesses,d=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}(e,["imageUrl","isDisabled","name","id","handleCopyPortfolio","metadata","canLinkOrderProcesses"]),m=(0,k.Z)(),y={pathname:D.hT,search:"?portfolio="+s},h=(null===(t=window.catalog)||void 0===t?void 0:t.standalone)?S.Do:(null==u?void 0:u.user_capabilities)||{},Z=(null==u?void 0:u.statistics)||{},O=null!==(r=null==Z?void 0:Z.portfolio_items)&&void 0!==r?r:0,F=null!==(o=null==Z?void 0:Z.approval_processes)&&void 0!==o?o:0,j=null!==(n=null==Z?void 0:Z.shared_groups)&&void 0!==n?n:0;return l().createElement(P.x,{isDisabled:i},l().createElement(P.r,{ouiaId:"portfolio-"+s},l().createElement(b.CardHeader,null,l().createElement(E,{id:s,to:y,portfolioName:c,portfolio_items:O,headerActions:l().createElement(R,{portfolioId:s,userCapabilities:h,handleCopyPortfolio:p,canLinkOrderProcesses:f})})),l().createElement(w.k,null,l().createElement(b.TextContent,{className:"pf-u-mb-md"},l().createElement(b.Text,{component:b.TextVariants.small,className:"pf-u-mb-0"},"Last updated ",l().createElement(v.Z,{date:d.updated_at||d.created_at,type:"relative"})),l().createElement(b.Text,{component:b.TextVariants.small},"by ",d.owner)),l().createElement(g.ZP,_({},_({name:c,imageUrl:a},d),{toDisplay:T}))),l().createElement(b.CardFooter,null,F>0&&l().createElement(b.Label,{variant:"filled",color:"grey"},m(C.Z.approvalProcessSet))," ",j>0&&l().createElement(b.Label,{variant:"filled",color:"grey"},m(C.Z.shared)))))};var q=r(33188),x=r(81624),B=r(77172),L=r(92183),N=r(72510),A=r(44058),V=r(97881),H=r(64466),U=r(30452),W=r(20240),G=r(45697),K=r.n(G),Y=r(66031);function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var z={name:C.Z.name,owner:C.Z.owner,sort_by:C.Z.sortBy},J={name:C.Z.name,owner:C.Z.owner,updated_at:C.Z.updated,created_at:C.Z.created},M=function(e){var t=e.filters,r=e.stateDispatch,i=e.debouncedFilter,s=e.initialState,p=e.meta,u=e.filterType,d=e.handleFilterItems,m=e.sortDirection,y=e.handleSort,h=e.fetchPortfoliosWithState,g=e.isFetching,b=e.isFiltering,v=e.canCreate,Z=(0,c.useDispatch)(),E=(0,k.Z)();return null!=p&&p.noData?null:l().createElement(Y.Z,(0,o.Z)({},v?{dedicatedAction:l().createElement(O.Z,{pathname:"/portfolios/add-portfolio"},l().createElement(f.Button,{variant:"primary",id:"create-portfolio",ouiaId:"create-portfolio",type:"button"},E(C.Z.create)))}:{},{activeFiltersConfig:{filters:Object.entries(t).filter((function(e){var t=(0,n.Z)(e,2)[1];return t&&t.length>0})).map((function(e){var t=(0,n.Z)(e,2),r=t[0],o=t[1];return{category:E(z[r]),type:r,chips:Array.isArray(o)?o.map((function(e){return{name:e}})):[{name:"sort_by"===r?E(J[o]):o}]}})),onDelete:function(e,o,l){var c=(0,n.Z)(o,1)[0];if(l)return r({type:"replaceFilterChip",payload:s.filters}),i(s.filters,p,Z,(function(e){return r({type:"setFilteringFlag",payload:e})}));var u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);"state"===c.type?u[c.type]=u[c.type].filter((function(e){return e!==c.chips[0].name})):u[c.type]="",r({type:"replaceFilterChip",payload:u}),i(u,p,Z,(function(e){return r({type:"setFilteringFlag",payload:e})}))}},filterConfig:{onChange:function(e,t){return r({type:"setFilterType",payload:t})},value:u,items:[{filterValues:{value:t.name,onChange:function(e,t){return d(t)}},label:E(C.Z.name),value:"name"},{filterValues:{value:t.owner,onChange:function(e,t){return d(t)}},label:E(C.Z.owner),value:"owner"},{filterValues:{value:t.sort_by||"name",onChange:function(e,t){return d(t)},items:[{label:E(C.Z.name),value:"name"},{label:E(C.Z.owner),value:"owner"},{label:E(C.Z.created),value:"created_at"},{label:E(C.Z.updated),value:"updated_at"}]},placeholder:t.sort_by?E(J[t.sort_by]):E(C.Z.name),label:E(C.Z.sortBy),value:"sort_by",type:"radio"}]},sortByConfig:{direction:m,onSortChange:function(e,t){return y(t)}},pagination:(null==p?void 0:p.count)>0?l().createElement(B.Z,{isDisabled:g||b,meta:p,apiRequest:function(e,r){return Z(h(t,r))},isCompact:!0}):void 0}))};M.propTypes={filters:K().shape({name:K().string.isRequired,owner:K().string.isRequired,sort_by:K().string}).isRequired,stateDispatch:K().func.isRequired,debouncedFilter:K().func.isRequired,initialState:K().shape({filters:K().shape((0,a.Z)({},K().string,K().any)).isRequired}).isRequired,meta:K().object,filterType:K().string.isRequired,handleFilterItems:K().func.isRequired,sortDirection:K().string.isRequired,handleSort:K().func.isRequired,fetchPortfoliosWithState:K().func.isRequired,isFetching:K().bool.isRequired,isFiltering:K().bool.isRequired,canCreate:K().bool};const Q=M;var X=r(15811);function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re=(0,x.Z)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.he,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;o(!0),r((0,h.Ec)(e,t)).then((function(){return o(!1)}))}),1e3),oe={isOpen:!1,isFetching:!0,isFiltering:!1,filterType:"name",filters:{name:"",owner:"",sort_by:void 0},sortDirection:U.SortByDirection.asc},ne=function(e,t){switch(t.type){case"setFetching":return te(te({},e),{},{isFetching:t.payload});case"setFilterValue":return te(te({},e),{},{filters:(r=t.payload,o=e.filterType,n=e.filters,te(te({},n),{},(0,a.Z)({},o,r)))});case"replaceFilterChip":return te(te({},e),{},{sortDirection:U.SortByDirection.asc,filters:t.payload});case"setFilteringFlag":return te(te({},e),{},{isFiltering:t.payload});case"setFilterType":return te(te({},e),{},{filterType:t.payload});case"setSortBy":return te(te({},e),{},{sortDirection:t.payload,filters:e.filters.sort_by?e.filters:te(te({},e.filters),{},{sort_by:"name"})})}var r,o,n;return e};const ae=function(){var e=(0,k.Z)(),t=(0,A.Z)(),r=(0,W.Z)(),y=(0,i.useReducer)(ne,te(te({},oe),null==t?void 0:t.portfolio)),g=(0,n.Z)(y,2),b=g[0],v=b.isFetching,Z=b.isFiltering,E=b.filters,O=b.filterType,P=b.sortDirection,w=g[1],F=(0,c.useSelector)((function(e){return e.portfolioReducer.portfolios})),C=F.data,j=F.meta,S=(0,c.useDispatch)(),_=(0,i.useContext)(N.Z).permissions,T=(0,s.useHistory)();(0,i.useEffect)((function(){S((0,h.Ec)(E,te(te({},j),{},{sortDirection:P}))).then((function(){return w({type:"setFetching",payload:!1})})),(0,d.k3)()}),[]);var R=function(e){w({type:"setFilterValue",payload:e}),re(te(te({},E),{},(0,a.Z)({},O,e)),te(te({},j),{},{offset:0,sortDirection:P}),S,(function(e){return w({type:"setFilteringFlag",payload:e})}))};(0,i.useEffect)((function(){!r||Z&&v||R(E[O])}),[P]);var x=function(e){return S((0,h.Yh)(e)).then((function(e){var t=e.id;return T.push({pathname:D.hT,search:"?portfolio=".concat(t)})}))},U=(0,d.Fs)(_,["catalog:portfolios:create"]),G=(0,d.Fs)(_,["catalog:order_processes:link"]),K={PrimaryAction:j.noData?function(){return l().createElement(q._,{url:D.NP,id:"create-portfolio",label:"Create",hasPermission:U})}:function(){return l().createElement(f.Button,{ouiaId:"clear-filter",variant:"link",onClick:function(){return R("")}},e(V.Z.clearFilters))},title:j.noData?e(H.Z.portfoliosNoData):e(V.Z.noResults),description:j.noData?e(H.Z.portfoliosNoDataDescription):e(V.Z.noResultsDescription),Icon:j.noData?p.ZP:u.ZP},Y=C.map((function(e){return l().createElement(I,(0,o.Z)({key:e.id,ouiaId:"portfolio-".concat(e.id)},e,{canLinkOrderProcesses:G,handleCopyPortfolio:x}))}));return l().createElement(i.Fragment,null,l().createElement(X.Z,null,l().createElement(X.y,{title:e(H.Z.portfoliosTitle)}),l().createElement(Q,{filters:E,stateDispatch:w,debouncedFilter:re,initialState:oe,meta:j,filterType:O,handleFilterItems:R,sortDirection:P,handleSort:function(e){return w({type:"setSortBy",payload:e})},fetchPortfoliosWithState:h.Ec,isFetching:v,isFiltering:Z,canCreate:U})),l().createElement(m.Z,{items:Y,isLoading:v||Z,renderEmptyState:function(){return l().createElement(q.Z,K)}}),j.count>0&&l().createElement(L.Z,null,l().createElement(B.Z,{meta:j,apiRequest:function(e,t){return S((0,h.Ec)(E,t))},dropDirection:"up"})))}}}]);
//# sourceMappingURL=../sourcemaps/portfolios.310d22aa8525f1aa2a1e2064daf11256.js.map