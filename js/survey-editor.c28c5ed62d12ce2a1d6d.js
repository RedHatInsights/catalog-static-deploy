(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{740:function(e,t,r){"use strict";r.r(t);var i,a=r(398),n=r.n(a),o=r(36),c=r.n(o),s=r(44),l=r.n(s),p=r(1),d=r.n(p),u=r(0),f=r.n(u),E=r(2),P=r.n(E),L=r(52),b=r(424),m=r.n(b),O=r(710),_=r.n(O),I=r(711),S=r(93),h=r(62),D=r(11),v=r(91),A=r(634),T=r(37),j=r(92),y=r(458),R=r(496),B=r.n(R);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=(i={},d()(i,m.a.TEXT_FIELD,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.HELPER_TEXT,I.fieldProperties.PLACEHOLDER,I.fieldProperties.IS_DISABLED,I.fieldProperties.IS_READ_ONLY,I.fieldProperties.HIDE_FIELD]}),d()(i,m.a.CHECKBOX,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.IS_DISABLED,I.fieldProperties.OPTIONS,I.fieldProperties.HIDE_FIELD]}),d()(i,m.a.SELECT,{attributes:[I.fieldProperties.OPTIONS,I.fieldProperties.LABEL,I.fieldProperties.IS_DISABLED,I.fieldProperties.PLACEHOLDER,I.fieldProperties.HELPER_TEXT,I.fieldProperties.HIDE_FIELD]}),d()(i,m.a.DATE_PICKER,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.TODAY_BUTTON_LABEL,I.fieldProperties.IS_CLEARABLE,I.fieldProperties.CLOSE_ON_DAY_SELECT,I.fieldProperties.SHOW_TODAY_BUTTON,I.fieldProperties.HIDE_FIELD]}),d()(i,m.a.PLAIN_TEXT,{attributes:[I.fieldProperties.MULTI_LINE_LABEL]}),d()(i,m.a.RADIO,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.IS_DISABLED,I.fieldProperties.OPTIONS,I.fieldProperties.HIDE_FIELD]}),d()(i,m.a.SWITCH,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.IS_READ_ONLY,I.fieldProperties.IS_DISABLED,I.fieldProperties.HIDE_FIELD]}),d()(i,m.a.TEXTAREA,{attributes:[I.fieldProperties.LABEL,I.fieldProperties.HELPER_TEXT,I.fieldProperties.IS_READ_ONLY,I.fieldProperties.IS_DISABLED,I.fieldProperties.HIDE_FIELD]}),i);N["select-field"]=N[m.a.SELECT],N["textarea-field"]=N[m.a.TEXTAREA];var H={componentMapper:M({},I.builderMapper,{"select-field":I.builderMapper[m.a.SELECT],"textarea-field":I.builderMapper[m.a.TEXTAREA]}),pickerMapper:M({},I.pickerMapper,{"select-field":I.pickerMapper[m.a.SELECT],"textarea-field":I.pickerMapper[m.a.TEXTAREA]}),propertiesMapper:I.propertiesMapper,componentProperties:N},C=function(e){var t=M({},e);return t.fields=t.fields.map((function(e){var t=e.validate,r=l()(e,["validate"]);return t?M({},r,{validate:t.map((function(e){var t=e.type;return M({},l()(e,["type"]),{type:y.a[t]||t})}))}):r})),t},F=function(e){return f.a.createElement(_.a,e)},w=function(e){var t=e.closeUrl,r=e.search,i=e.portfolioItem,a=e.uploadIcon,o=Object(u.useState)(),s=c()(o,2),p=s[0],d=s[1],E=Object(u.useState)(!1),P=c()(E,2),b=P[0],m=P[1],O=Object(u.useState)(),_=c()(O,2),y=_[0],R=_[1],g=Object(u.useState)(),N=c()(g,2),w=N[0],U=N[1],X=Object(T.useDispatch)(),k=Object(L.g)().push,q=function(){return Object(h.a)().get("".concat(D.c,"/portfolio_items/").concat(i.id,"/service_plans")).then((function(e){var t=c()(e,1)[0].create_json_schema.schema;return U(e[0]),e[0].imported?Object(h.a)().get("".concat(D.c,"/service_plans/").concat(e[0].id,"/base")).then((function(e){return R(C(e.create_json_schema.schema)),C(t)})):C(t)})).then((function(e){d(e),m(!1)}))};Object(u.useEffect)((function(){q()}),[]);var Y=function(e){return Object(h.h)().patchServicePlanModified("".concat(w.id),{modified:{schema:e}})},V=function(e){return Object(h.h)().createServicePlan({portfolio_item_id:i.id}).then((function(e){return c()(e,1)[0].id})).then((function(t){return Object(h.h)().patchServicePlanModified("".concat(t),{modified:{schema:e}})}))},x=function(e){return m(!0),(w.imported?Y:V)(function(e){var t=M({},e);return t.fields=t.fields.map((function(e){var t=e.validate,r=l()(e,["validate"]);return t?M({},r,{validate:t.map((function(e){var t=e.type;return M({},l()(e,["type"]),{type:t!==B.a.MAX_NUMBER_VALUE&&t!==B.a.MIN_NUMBER_VALUE?"".concat(t,"-validator"):t})}))}):r})),t}(e)).then((function(){return m(!1),X(Object(j.addNotification)({variant:"success",title:"Survey of ".concat(i.name," has been modified."),dismissable:!0})),k({pathname:t,search:r})})).catch((function(e){m(!1),X({type:"EDIT_SURVEY_REJECTED",payload:e})}))};return f.a.createElement(u.Fragment,null,p?f.a.createElement(F,n()({},H,{schema:p,disableDrag:!0,disableAdd:!0,schemaTemplate:y,mode:"subset"}),(function(e){var n=e.getSchema,o=e.isValid,c=l()(e,["getSchema","isValid"]);return f.a.createElement(u.Fragment,null,f.a.createElement(A.b,{key:"survey-editor-toolbar",uploadIcon:a,product:i,handleSaveSurvey:function(){return x(n())},isValid:o,closeUrl:t,search:r,isFetching:b||!p,modified:w.modified,handleResetSurvey:function(){return e=w.id,d(void 0),void Object(h.h)().resetServicePlanModified(e).then(q).then((function(){return X(Object(j.addNotification)({variant:"success",title:"Survey of ".concat(i.name," has been restored."),dismissable:!0}))}));var e}}),f.a.createElement(I.BuilderTemplate,c),";")})):f.a.createElement(u.Fragment,null,f.a.createElement(A.b,{uploadIcon:a,product:i,handleSaveSurvey:x,closeUrl:t,search:r,isFetching:!p||b}),f.a.createElement(v.Bullseye,null,f.a.createElement(S.Spinner,null))))};w.propTypes={closeUrl:P.a.string.isRequired,search:P.a.string.isRequired,uploadIcon:P.a.func.isRequired,portfolioItem:P.a.shape({id:P.a.string.isRequired,name:P.a.string.isRequired}).isRequired,portfolio:P.a.object.isRequired},t.default=w}}]);
//# sourceMappingURL=../sourcemaps/survey-editor.js.map