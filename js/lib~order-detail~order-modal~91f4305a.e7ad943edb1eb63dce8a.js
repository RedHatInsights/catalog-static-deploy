(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{598:function(e,t,r){"use strict";var o=r(19),n=Object(o.b)({orderedBy:{id:"orders.common.orderedBy",defaultMessage:"Ordered by {owner}"},orderedByLabel:{id:"orders.approval.orderedBy",defaultMessage:"Ordered by"},lastUpdated:{id:"orders.common.lastUpdated",defaultMessage:"Last updated"},compositeTitle:{id:"orders.common.compositeTitle",defaultMessage:"{name} - Order # {id}"},detailTitle:{id:"orders.detail.title",defaultMessage:"Order ID {id}"},orderSuccess:{id:"orders.notification.success",defaultMessage:"You can track the progress of Order # {id} in your <link>Orders</link> page."},noOrdersTitle:{id:"orders.list.empty.title",defaultMessage:"No orders"},noOrdersDescription:{id:"orders.list.empty.description",defaultMessage:"No orders have been created."},noApprovalRequests:{id:"orders.approval.no-requests",defaultMessage:"We were unable to find any approval requests for this order."},creatingApprovalRequest:{id:"orders.approval.creating",defaultMessage:"Creating approval request"},approvalTitle:{id:"orders.approval.title",defaultMessage:"Summary"},approvalDetail:{id:"orders.approval.view-detail",defaultMessage:"View this order's approval request details"},approvalCreated:{id:"orders.approval.details.created",defaultMessage:"Request created"},approvalReason:{id:"orders.approval.details.reason",defaultMessage:"Approval reason"},approvalCompleted:{id:"orders.approval.details.completed",defaultMessage:"Completed at"},orderDetails:{id:"orders.common.details",defaultMessage:"Order details"},menuApproval:{id:"orders.menu.approval",defaultMessage:"Approval"},menuLifecycle:{id:"orders.menu.lifecycle",defaultMessage:"Lifecycle"},menuSteps:{id:"orders.menu.steps",defaultMessage:"Order steps"},objectsNotFound:{id:"order.detail.not-found",defaultMessage:"The {objects} for this order {count, plural, one {is} other {are}} not available"},orderID:{id:"orders.order.detail.ID",defaultMessage:"Order ID"},orderParameters:{id:"orders.order.detail.parameters",defaultMessage:"Order parameters"},orderProgressMessages:{id:"orders.order.detail.messages",defaultMessage:"Progress messages"},lifecycleLink:{id:"orders.order.lifecicle.link",defaultMessage:"Manage product"},cancelOrder:{id:"orders.actions.cancel",defaultMessage:"Cancel order"},keepOrder:{id:"orders.actions.keep",defaultMessage:"Keep order"},cancelDescription:{id:"orders.cancel.description",defaultMessage:"Are you sure you want to cancel {name}?"},backToOrders:{id:"orders.toolbar.backLink",defaultMessage:"Back to orders"},orderDate:{id:"orders.approval.order-date",defaultMessage:"Order date"},approvalParameters:{id:"orders.approval.parameters",defaultMessage:"Parameters"},activity:{id:"orders.approval.activity",defaultMessage:"Activity"}});t.a=n},653:function(e,t,r){"use strict";r.d(t,"e",(function(){return J})),r.d(t,"f",(function(){return U})),r.d(t,"a",(function(){return V})),r.d(t,"d",(function(){return Y})),r.d(t,"c",(function(){return K})),r.d(t,"b",(function(){return z}));var o=r(29),n=r.n(o),a=r(23),i=r.n(a),s=r(12),c=r.n(s),u=r(0),d=r.n(u),l=r(110),p=r(2),f=r(22),m=r(5),v=r(24),y=r(42),h=function(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))},b=function(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},g=Object(f.a)(),O=function(){return(O=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},w=function(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))},_=function(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},j=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r},I=Object(f.c)(),M=(Object(f.d)(),Object(f.g)()),P=Object(f.a)(),D=Object(f.b)(),E=function(e){return M.listServicePlans(e)},k=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=v.a),P.get(m.e+"/orders?"+e+"&limit="+t.limit+"&offset="+t.offset).then((function(e){return(t=e.data.map((function(e){return e.id})),P.get(m.e+"/order_items?"+t.map((function(e){return"filter[order_id][]="+e})).join("&"))).then((function(t){return(r=t.data.map((function(e){return e.portfolio_item_id})),P.get(m.e+"/portfolio_items?"+r.map((function(e){return"filter[id][]="+e})).join("&"))).then((function(r){return O(O({portfolioItems:r},e),{data:e.data.map((function(e){return O(O({},e),{orderItems:t.data.filter((function(t){return t.order_id===e.id}))})}))})}));var r}));var t}))},q=function(e){if(Object.values(e).some((function(e){return!e})))return t=e.order,h(void 0,void 0,void 0,(function(){var e,r,o,n,a,i;return b(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,g.get(m.e+"/orders/"+t)];case 1:return e=s.sent(),[3,3];case 2:if(r=s.sent(),e={},404!==r.status&&400!==r.status)throw r;return y.a.replace({pathname:"/404",state:{from:y.a.location}}),[3,3];case 3:o={object:"Order item",notFound:!0},s.label=4;case 4:return s.trys.push([4,6,,7]),[4,g.get(m.e+"/order_items?order_id="+e.id)];case 5:return n=s.sent(),o=n.data[0],[3,7];case 6:return s.sent(),[3,7];case 7:a={object:"Product",notFound:!0},s.label=8;case 8:return s.trys.push([8,10,,11]),[4,g.get(m.e+"/portfolio_items/"+o.portfolio_item_id)];case 9:return a=s.sent(),[3,11];case 10:return s.sent(),[3,11];case 11:return i=[g.get(m.k+"/sources/"+a.service_offering_source_ref).catch((function(){return{object:"Platform",notFound:!0}})),g.get(m.e+"/order_items/"+o.id+"/progress_messages").catch((function(){return{object:"Messages",notFound:!0}})),g.get(m.e+"/portfolios/"+a.portfolio_id).catch((function(){return{object:"Portfolio",notFound:!0}}))],[2,Promise.all(i).then((function(t){var r=t[0],n=t[1],i=t[2];return[e,o,a,r,n,i]}))]}}))}));var t,r=[P.get(m.e+"/orders/"+e.order).catch((function(e){if(404===e.status||400===e.status)return y.a.replace({pathname:"/404",state:{from:y.a.location}});throw e})),P.get(m.e+"/order_items/"+e["order-item"]).catch((function(e){if(404===e.status||400===e.status)return{object:"Order item",notFound:!0};throw e})),P.get(m.e+"/portfolio_items/"+e["portfolio-item"]).catch((function(e){if(404===e.status||400===e.status)return{object:"Product",notFound:!0};throw e})),P.get(m.k+"/sources/"+e.platform).catch((function(e){if(404===e.status||400===e.status)return{object:"Platform",notFound:!0};throw e})),P.get(m.e+"/order_items/"+e["order-item"]+"/progress_messages").catch((function(e){if(404===e.status||400===e.status)return{};throw e})),P.get(m.e+"/portfolios/"+e.portfolio).catch((function(e){if(404===e.status||400===e.status)return{object:"Portfolio",notFound:!0};throw e}))];return Promise.all(r)},R=function(e){return P.get(m.e+"/order_items/"+e+"/approval_requests").then((function(e){var t=e.data.map((function(e){var t,r,o=e.approval_request_ref;return t=o,D.post(m.b+"/graphql",{query:(r=t,'query {\n  requests(id: "'+r+'") {\n    group_name\n    state\n    actions {\n      created_at\n    }\n  }\n}')},{"x-rh-persona":"approval/requester"}).then((function(e){return e.data.requests}))}));return Promise.all(t).then((function(e){var t;return{data:(null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.map((function(e){var t,r=e.actions,o=j(e,["actions"]);return O(O({},o),{updated:(null==r?void 0:r.length)>0?null===(t=r.pop())||void 0===t?void 0:t.created_at:void 0})})))||[]}}))}))},F=r(4),L=r.n(F),T=r(68),N=r(9),S=r(598),x=r(17),C=function(e){var t=e.id,r=e.dispatch,o=e.portfolioItemId,n=e.portfolioId,a=e.platformId,i=e.orderItemId;return Object(x.a)()(S.a.orderSuccess,{id:t,link:function(e){return d.a.createElement(T.a,{onClick:function(){return r(Object(l.clearNotifications)())},to:{pathname:N.o,search:"?order=".concat(t,"&order-item=").concat(i,"&portfolio-item=").concat(o,"&platform=").concat(a,"&portfolio=").concat(n)}},e)}})};C.propTypes={id:L.a.string.isRequired,dispatch:L.a.func.isRequired,portfolioItemId:L.a.string.isRequired,portfolioId:L.a.string.isRequired,platformId:L.a.string.isRequired,orderItemId:L.a.string.isRequired};var A=C;function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J=function(e){return{type:p.z,payload:E(e)}},U=function(e,t){return function(r){return r({type:p.cb,payload:(o=e,w(void 0,void 0,void 0,(function(){var e,t,r;return _(this,(function(c){switch(c.label){case 0:return n=o.service_parameters,a=n.providerControlParameters,i=j(n,["providerControlParameters"]),s=j(o,["service_parameters"]),[4,I.createOrder()];case 1:return e=c.sent(),(t={}).count=1,t=O(O(O({},t),s),{service_parameters:i,provider_control_parameters:a||{}}),[4,I.addToOrder(e.id,t)];case 2:return r=c.sent(),[2,I.submitOrder(e.id).then((function(e){return O(O({},e),{orderItem:r})}))]}}))}))).then((function(e){var o=e.id,n=e.orderItem;return r(Object(l.addNotification)({variant:"success",title:"Your order has been accepted successfully",description:d.a.createElement(A,{id:o,dispatch:r,portfolioItemId:t.id,portfolioId:t.portfolio_id,platformId:t.service_offering_source_ref,orderItemId:n.id}),dismissable:!0}))}))});var o,n,a,i,s}},V=function(e){return function(t,r){t({type:"".concat(p.e,"_PENDING")});var o=r().orderReducer.orderDetail;return function(e){return I.cancelOrder(e)}(e).then((function(){return o.order.state="Canceled",o.approvalRequest&&o.approvalRequest.length>0&&(o.approvalRequest[0].state="canceled"),t({type:p.V,payload:G({},o)}),o})).then((function(e){return t(Object(l.addNotification)({variant:"success",title:"Your order has been canceled successfully",description:"Order ".concat("Order #".concat(e.order.id)," was canceled."),dismissable:!0}))})).then((function(){return t({type:"".concat(p.e,"_FULFILLED")})})).catch((function(e){t({type:"".concat(p.e,"_REJECTED"),payload:e})}))}},Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.a;return function(r){var o=Object.entries(e).filter((function(e){var t=i()(e,2)[1];return t&&t.length>0})).map((function(e){var t=i()(e,2),r=t[0],o=t[1];return Array.isArray(o)?o.map((function(e){return"filter[".concat(r,"][]=").concat(e)})).join("&"):"filter[".concat(r,"][contains_i]=").concat(o)})).join("&");return t.sortBy&&(o="".concat(o,"&sort_by=").concat(t.sortBy,":").concat(t.sortDirection||"desc")),r({type:"".concat(p.i,"_PENDING")}),k(o,t).then((function(a){var i=a.portfolioItems,s=n()(a,["portfolioItems"]);return r({type:p.X,payload:i}),r({type:"".concat(p.i,"_FULFILLED"),meta:G(G({},t),{},{filter:o,filters:e,storeState:!0,stateKey:"orders"}),payload:s})})).catch((function(e){return r({type:"".concat(p.i,"_REJECTED"),payload:e})}))}},K=function(e){return function(t){return t({type:"".concat(p.V,"_PENDING")}),q(e).then((function(e){var r=i()(e,7),o=r[0],n=r[1],a=r[2],s=r[3],c=r[4],u=r[5],d=r[6];return t({type:"".concat(p.V,"_FULFILLED"),payload:{order:o,orderItem:n,portfolioItem:a,platform:s,progressMessages:c,portfolio:u,approvalRequest:d}})})).catch((function(e){return t({type:"".concat(p.V,"_REJECTED"),payload:e})}))}},z=function(e){return function(t){return t({type:"".concat(p.g,"_PENDING")}),R(e).then((function(e){return t({type:"".concat(p.g,"_FULFILLED"),payload:e}),e})).catch((function(e){return t({type:"".concat(p.g,"_REJECTED"),payload:e})}))}}}}]);
//# sourceMappingURL=../sourcemaps/lib~order-detail~order-modal~91f4305a.js.map