"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[7742],{25583:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var o=n(30624),r=n.n(o),i=n(14494),a=n(22720),s=n(22437),c=n(35388),l=n(7247),u=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},p=function(e,t){void 0===e&&(e=""),void 0===t&&(t=[]);var n=t.map((function(e){return"filter[id][]="+e})).join("&");return(0,s.Hx)().get(c._R+"/workflows?filter[name][contains]="+e+"&"+(n||"")).then((function(e){return e.data.map((function(e){var t=e.id;return{label:e.name,value:t}}))}))},f=function(e,t,n){var o=e?e.map((function(e){return(0,s.xZ)().unlinkWorkflow(e,n)})):[],r=t?t.map((function(e){return(0,s.xZ)().linkWorkflow(e,n)})):[];return Promise.all(u(u([],o,!0),r,!0))},d=n(83215);const v=function(e){return e().i18nReducer.formatMessage};var h=n(50049);const m=(0,h.vU)({unlinkNotification:{id:"approval.notifications.unlink",defaultMessage:"Approval processes were unlinked successfully."},linkNotification:{id:"approval.notifications.link",defaultMessage:"Approval processes were linked successfully."},setWorkflow:{id:"approval.workflows.set",defaultMessage:"Select approval processes for <strong>{objectName}</strong>"},currentWorkflows:{id:"approval.workflows.current",defaultMessage:"Current approval processes"}});var g=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},k=function(e,t){void 0===e&&(e=""),void 0===t&&(t=[]);var n=t.map((function(e){return"id="+e})).join("&");return(0,s.Hx)().get(c._R+"/workflows?name="+e+"&"+(n||"")).then((function(e){return e.results.map((function(e){var t=e.id;return{label:e.name,value:t}}))}))},b=function(e,t,n){var o=e?e.map((function(e){return function(e,t){return(0,s.Hx)().post(c._R+"/workflows/"+e+"/unlink/",t)}(e,n)})):[],r=t?t.map((function(e){return function(e,t){return(0,s.Hx)().post(c._R+"/workflows/"+e+"/link/",t)}(e,n)})):[];return Promise.all(g(g([],o,!0),r,!0))},w=n(47786),y=n(74798),j=n(23349),_=n(28723),N=n(56915),W=n(63035);const S=function(e){var t=e.objectType,n=e.removeSearch,u=e.keepHash,g=void 0!==u&&u,S=e.querySelector,T=e.pushParam,H=e.objectName,R=void 0===H?function(){return t}:H,x=e.postMethod,C=e.onClose,A=(0,j.Z)(),M=(0,o.useRef)(A((0,h.Em)({id:"workflows.modal.title",defaultMessage:"Set approval process"}))).current,O=(0,i.I0)(),Z=(0,y.Z)({removeSearch:n,keepHash:g}),I=(0,w.Z)([S])[0],P=function(){C&&C(),Z.push(T)};return r().createElement(_.Z,{title:M,onClose:P,onSubmit:function(e,n){var o,r,i;P(),O((0,W.$W)()?(o=e,r=n,i={object_type:t,app_name:c.iC[t],object_id:I[S]},function(e,t){var n=v(t);return e({type:a.k.UPDATE_WORKFLOWS,payload:b(r,o,i).then((function(){return e((0,d.wN)({variant:"success",title:"Success updating approval process",dismissable:!0,description:(r.length>0?n&&n(m.unlinkNotification,{count:r.length}):"")+"\n          "+(o.length>0?n(m.linkNotification,{count:o.length}):"")}))}))})}):function(e,t,n){return function(o,r){var i=v(r);return o({type:a.k.UPDATE_WORKFLOWS,payload:f(t,e,n).then((function(){return o((0,d.wN)({variant:"success",title:"Success updating approval process",dismissable:!0,description:(t.length>0?i&&i(m.unlinkNotification,{count:t.length}):"")+"\n          "+(e.length>0?i(m.linkNotification,{count:e.length}):"")}))}))})}}(e,n,{object_type:t,app_name:c.iC[t],object_id:I[S]})).then((function(){x&&O(x())}))},getInitialTags:function(){return(0,W.$W)()?function(e,t,n){void 0===t&&(t={limit:l.he.limit,offset:l.he.offset}),void 0===n&&(n="");var o="app_name="+e.appName+"&object_type="+e.objectType+"&object_id="+e.objectId,r="&page_size="+t.limit+"&page="+(t.offset||1),i="&filter[name][contains]="+n;return(0,s.Hx)().get(c._R+"/workflows?"+o+i+r)}({objectType:t,appName:c.iC[t],objectId:I[S]}).then((function(e){return e.results})):function(e,t,n){void 0===t&&(t={limit:l.he.limit,offset:l.he.offset}),void 0===n&&(n="");var o="app_name="+e.appName+"&object_type="+e.objectType+"&object_id="+e.objectId,r="&limit="+t.limit+"&offset="+t.offset,i="&filter[name][contains]="+n;return(0,s.Hx)().get(c._R+"/workflows?"+o+i+r)}({objectType:t,appName:c.iC[t],objectId:I[S]}).then((function(e){return e.data}))},loadTags:(0,W.$W)()?k:p,subTitle:A(m.setWorkflow,{strong:N.d,objectName:R(I[S])}),existingTagsMessage:A(m.currentWorkflows)})}},74798:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(334),r=function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};const i=function(e){var t=void 0===e?{}:e,n=t.removeSearch,i=t.keepHash,a=(0,o.useHistory)();return r(r({},a),{push:function(e){var t=e;return i&&a.location.hash.length>0&&(t="object"==typeof t?r(r({},t),{hash:a.location.hash}):""+t+a.location.hash),n?a.push(function(e){return"string"==typeof e?e.split("?")[0]:"object"==typeof e?r(r({},e),{search:void 0}):e}(t)):a.push(t)}})}}}]);
//# sourceMappingURL=../sourcemaps/edit-approval-workflow.cd508bb8ce491bb3b17056f899f160b6.js.map